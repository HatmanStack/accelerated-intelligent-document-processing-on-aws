[
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-001",
    "stack": "AWS-GenAI-IDP-Accelerator",
    "stride_category": "Information Disclosure",
    "severity": "Medium",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "OCRFunction, ClassificationFunction, ExtractionFunction, AssessmentFunction, ProcessResultsFunction, SummarizationFunction",
    "title": "Potential log data exposure through CloudWatch Logs",
    "issue": "Lambda functions are configured to log to CloudWatch Logs, which may include sensitive document content, extraction results, or credentials if not properly filtered. These logs lack specific access restrictions beyond the default KMS encryption.",
    "attack_vector": "An attacker with CloudWatch Logs access permissions could view potentially sensitive document data processed by the Lambda functions.",
    "impact": "Unauthorized access to sensitive document content, extraction results, or possibly credentials that might be logged during processing.",
    "remediation": "Implement log filtering to prevent sensitive data from being logged. Add resource-based policies to the CloudWatch Log groups to restrict access to authorized personnel only. Consider implementing AWS CloudWatch Logs Filter Subscriptions to filter sensitive information.",
    "priority": 2,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-532",
    "compliance_violations": ["GDPR Article 32", "HIPAA Security Rule"],
    "references": ["https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/Working-with-log-groups-and-streams.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-002",
    "stack": "AWS-GenAI-IDP-Accelerator",
    "stride_category": "Elevation of Privilege",
    "severity": "High",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "OCRFunction, ClassificationFunction",
    "title": "Overly permissive IAM policies with wildcard resources",
    "issue": "Several Lambda functions have IAM policies with wildcard resources for Textract and CloudWatch PutMetricData APIs, granting broader access than necessary and violating the principle of least privilege.",
    "attack_vector": "If the Lambda function is compromised, an attacker could exploit these broad permissions to access other resources or services beyond what's required for the function's operation.",
    "impact": "Potential unauthorized access to AWS resources, escalation of privileges, and ability to perform actions outside the intended scope of the function.",
    "remediation": "Restrict IAM policies to only the specific resources needed. Where APIs don't support resource-level permissions, consider using IAM policy conditions to limit scope (e.g., by specifying allowed metric namespaces for CloudWatch).",
    "priority": 1,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-272",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.22"],
    "references": ["https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-003",
    "stack": "AWS-GenAI-IDP-Accelerator",
    "stride_category": "Repudiation",
    "severity": "Medium",
    "resource_type": "AWS::Serverless::StateMachine",
    "resource_name": "DocumentProcessingStateMachine",
    "title": "Potential for insufficient auditing of document processing",
    "issue": "While the state machine has logging enabled, there's no explicit configuration for capturing detailed execution data for specific sensitive operations or for monitoring specific transitions that may indicate security-relevant events.",
    "attack_vector": "An insider or attacker with access to the system could perform unauthorized actions on documents without sufficient audit trail to identify the specific actor or actions taken.",
    "impact": "Difficulty in forensic analysis after a security incident, challenges in compliance auditing, and inability to detect unauthorized document access patterns.",
    "remediation": "Implement additional logging focused on security-relevant events. Configure CloudTrail data events for relevant S3 buckets. Add explicit audit logging within Lambda functions for sensitive operations with details about who performed what action on which document.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-778",
    "compliance_violations": ["GDPR Article 30", "SOC 2 Type II"],
    "references": ["https://docs.aws.amazon.com/step-functions/latest/dg/cloudwatch-logs.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-004",
    "stack": "AWS-GenAI-IDP-Accelerator",
    "stride_category": "Information Disclosure",
    "severity": "Medium",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "OCRFunction, ClassificationFunction, ExtractionFunction, AssessmentFunction, ProcessResultsFunction, SummarizationFunction",
    "title": "Lack of VPC isolation for Lambda functions",
    "issue": "Lambda functions are not configured to run within a VPC, which could expose them to unnecessary network access and reduce isolation. Functions processing potentially sensitive documents would benefit from additional network isolation.",
    "attack_vector": "Without VPC isolation, Lambda functions have direct internet access, increasing attack surface and potentially allowing data exfiltration if compromised.",
    "impact": "Increased risk of data exfiltration, unnecessary network exposure, and potential for compromised functions to communicate with unauthorized external endpoints.",
    "remediation": "Deploy Lambda functions within a VPC with appropriate subnet configuration and security groups. Use VPC endpoints for AWS services to maintain private communications. Implement a NAT gateway only if external connectivity is required.",
    "priority": 2,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-668",
    "compliance_violations": ["CIS AWS Foundations Benchmark"],
    "references": ["https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-005",
    "stack": "AWS-GenAI-IDP-Accelerator",
    "stride_category": "Tampering",
    "severity": "Medium",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "All Lambda functions",
    "title": "No explicit input validation for document processing",
    "issue": "The CloudFormation template doesn't indicate implementation of robust input validation for documents being processed. Without proper validation, malicious documents could potentially trigger vulnerabilities in the processing pipeline.",
    "attack_vector": "An attacker could submit specially crafted documents designed to exploit vulnerabilities in the processing libraries or to trigger unexpected behaviors in the Lambda functions.",
    "impact": "Potential code injection, application crashes, or unexpected behavior that could lead to data leakage or resource consumption attacks.",
    "remediation": "Implement comprehensive input validation for all document inputs. Validate file formats, sizes, and content before processing. Consider adding content scanning for malicious patterns. Use safe parsing libraries that are resistant to common attacks.",
    "priority": 2,
    "estimated_effort": "High",
    "cwe_id": "CWE-20",
    "compliance_violations": ["OWASP Top 10 A3:2021"],
    "references": ["https://cheatsheetseries.owasp.org/cheatsheets/Input_Validation_Cheat_Sheet.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-006",
    "stack": "AWS-GenAI-IDP-Accelerator",
    "stride_category": "Denial of Service",
    "severity": "Medium",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "All Lambda functions",
    "title": "Missing concurrent execution limits on Lambda functions",
    "issue": "Lambda functions don't have concurrent execution limits defined, which could lead to resource exhaustion if many documents are processed simultaneously, either legitimately or as part of a DoS attack.",
    "attack_vector": "An attacker could trigger many simultaneous document processing requests, potentially exhausting available Lambda concurrency or downstream resources like Bedrock or Textract.",
    "impact": "Service disruption, increased costs, and potential impact on other applications sharing the same AWS account resources.",
    "remediation": "Configure appropriate reserved concurrency limits for each Lambda function. Implement request throttling at the API layer. Consider implementing a queue-based architecture to control the processing rate of documents.",
    "priority": 3,
    "estimated_effort": "Low",
    "cwe_id": "CWE-770",
    "compliance_violations": [],
    "references": ["https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-007",
    "stack": "AWS-GenAI-IDP-Accelerator",
    "stride_category": "Information Disclosure",
    "severity": "High",
    "resource_type": "AWS::CloudFormation::CustomResource",
    "resource_name": "UpdateSchemaConfig, UpdateDefaultConfig",
    "title": "Potential sensitive configuration data exposure",
    "issue": "The template uses custom resources to update schema and default configurations, potentially exposing sensitive configuration data if not properly secured. This configuration likely includes document processing rules that could reveal business logic or confidential information processing patterns.",
    "attack_vector": "An attacker with access to the CloudFormation stack or configuration data could gather intelligence about document processing rules, potentially discovering ways to bypass security controls.",
    "impact": "Exposure of sensitive business rules, document classification patterns, or extraction logic that could be used to craft evasive documents or understand the organization's document handling procedures.",
    "remediation": "Ensure all configuration data is encrypted both at rest and in transit. Implement strict IAM permissions for configuration access. Consider storing sensitive configuration elements in AWS Secrets Manager instead of directly in CloudFormation.",
    "priority": 2,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-200",
    "compliance_violations": ["GDPR Article 32"],
    "references": ["https://docs.aws.amazon.com/secretsmanager/latest/userguide/intro.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-008",
    "stack": "AWS-GenAI-IDP-Accelerator",
    "stride_category": "Tampering",
    "severity": "High",
    "resource_type": "AWS::S3::Bucket",
    "resource_name": "InputBucket, OutputBucket, ConfigurationBucket, WorkingBucket",
    "title": "Missing S3 bucket security configurations",
    "issue": "The CloudFormation template references S3 buckets but doesn't define or enforce security configurations such as bucket policies, access logging, versioning, or object-level encryption requirements. This could leave documents vulnerable to unauthorized access or tampering.",
    "attack_vector": "An attacker could potentially access or modify documents if bucket permissions are misconfigured. Without versioning, tampered or deleted documents couldn't be recovered.",
    "impact": "Unauthorized access to sensitive documents, potential data loss or modification, and lack of audit trail for document access or changes.",
    "remediation": "Implement bucket policies restricting access to authorized principals only. Enable S3 access logging and versioning. Configure default encryption for all objects. Consider implementing S3 Object Lock for immutable storage of processed documents.",
    "priority": 1,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-284",
    "compliance_violations": ["CIS AWS Foundations Benchmark 3.1", "GDPR Article 32"],
    "references": ["https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-009",
    "stack": "AWS-GenAI-IDP-Accelerator",
    "stride_category": "Spoofing",
    "severity": "Medium",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "ExtractionFunction, AssessmentFunction, SummarizationFunction",
    "title": "Potential prompt injection vulnerabilities",
    "issue": "Functions that use AI models (Bedrock) are processing user-supplied content that could be vulnerable to prompt injection attacks, where carefully crafted document content could manipulate the AI model's behavior.",
    "attack_vector": "An attacker could submit documents with specially crafted content designed to manipulate the AI model's behavior, potentially extracting unauthorized information or bypassing security controls.",
    "impact": "Data leakage, inaccurate document classification or extraction, and potential exposure of system details or processing logic.",
    "remediation": "Implement robust prompt engineering practices with input sanitization. Use Bedrock guardrails (already partially implemented) more extensively. Add content filtering before sending to AI models. Monitor AI responses for anomalous patterns that might indicate prompt injection.",
    "priority": 2,
    "estimated_effort": "High",
    "cwe_id": "CWE-74",
    "compliance_violations": [],
    "references": ["https://www.amazon.com/Guardrails-User-Guide/dp/B0CYS1JMXS"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-010",
    "stack": "AWS-GenAI-IDP-Accelerator",
    "stride_category": "Repudiation",
    "severity": "Low",
    "resource_type": "AWS::CloudWatch::Dashboard",
    "resource_name": "Dashboard",
    "title": "Insufficient security metrics and alerting",
    "issue": "The CloudWatch dashboard focuses primarily on performance metrics rather than security-related metrics, potentially missing important security events or patterns that could indicate compromise.",
    "attack_vector": "An attacker exploiting the system might not trigger alerts if the monitoring is focused only on performance and not security-relevant events.",
    "impact": "Delayed detection of security incidents, inability to identify unusual patterns of behavior that might indicate compromise, and lack of visibility into security-relevant events.",
    "remediation": "Add security-focused metrics and alarms to the dashboard. Configure CloudWatch Alarms for unusual activity patterns. Consider implementing GuardDuty or Security Hub integration. Add metrics specifically for authentication failures, access denials, and other security events.",
    "priority": 4,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-223",
    "compliance_violations": ["SOC 2 Type II"],
    "references": ["https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch_Dashboards.html"],
    "status": "Open"
  }
]