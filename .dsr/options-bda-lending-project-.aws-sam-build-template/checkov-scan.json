{"check_type": "cloudformation", "results": {"failed_checks": [{"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[81, "  BDAProjectLambda:\n"], [82, "    Type: AWS::Serverless::Function\n"], [83, "    Metadata:\n"], [84, "      SamResourceId: BDAProjectLambda\n"], [85, "      cfn_nag:\n"], [86, "        rules_to_suppress:\n"], [87, "        - id: W89\n"], [88, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [89, "            with AWS services via AWS APIs\n"], [90, "        - id: W92\n"], [91, "          reason: Function does not require concurrent execution limits as it is designed\n"], [92, "            to scale based on demand\n"], [93, "    Properties:\n"], [94, "      CodeUri: BDAProjectLambda\n"], [95, "      Handler: index.handler\n"], [96, "      Role:\n"], [97, "        Fn::GetAtt:\n"], [98, "        - LambdaExecutionRole\n"], [99, "        - Arn\n"], [100, "      Runtime: python3.12\n"], [101, "      Timeout: 300\n"], [102, "      MemorySize: 256\n"], [103, "      Environment:\n"], [104, "        Variables:\n"], [105, "          LOG_LEVEL:\n"], [106, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bda-lending-project/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [81, 106], "resource": "AWS::Serverless::Function.BDAProjectLambda", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bda-lending-project/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bda-lending-project/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[81, "  BDAProjectLambda:\n"], [82, "    Type: AWS::Serverless::Function\n"], [83, "    Metadata:\n"], [84, "      SamResourceId: BDAProjectLambda\n"], [85, "      cfn_nag:\n"], [86, "        rules_to_suppress:\n"], [87, "        - id: W89\n"], [88, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [89, "            with AWS services via AWS APIs\n"], [90, "        - id: W92\n"], [91, "          reason: Function does not require concurrent execution limits as it is designed\n"], [92, "            to scale based on demand\n"], [93, "    Properties:\n"], [94, "      CodeUri: BDAProjectLambda\n"], [95, "      Handler: index.handler\n"], [96, "      Role:\n"], [97, "        Fn::GetAtt:\n"], [98, "        - LambdaExecutionRole\n"], [99, "        - Arn\n"], [100, "      Runtime: python3.12\n"], [101, "      Timeout: 300\n"], [102, "      MemorySize: 256\n"], [103, "      Environment:\n"], [104, "        Variables:\n"], [105, "          LOG_LEVEL:\n"], [106, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bda-lending-project/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [81, 106], "resource": "AWS::Serverless::Function.BDAProjectLambda", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bda-lending-project/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bda-lending-project/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[81, "  BDAProjectLambda:\n"], [82, "    Type: AWS::Serverless::Function\n"], [83, "    Metadata:\n"], [84, "      SamResourceId: BDAProjectLambda\n"], [85, "      cfn_nag:\n"], [86, "        rules_to_suppress:\n"], [87, "        - id: W89\n"], [88, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [89, "            with AWS services via AWS APIs\n"], [90, "        - id: W92\n"], [91, "          reason: Function does not require concurrent execution limits as it is designed\n"], [92, "            to scale based on demand\n"], [93, "    Properties:\n"], [94, "      CodeUri: BDAProjectLambda\n"], [95, "      Handler: index.handler\n"], [96, "      Role:\n"], [97, "        Fn::GetAtt:\n"], [98, "        - LambdaExecutionRole\n"], [99, "        - Arn\n"], [100, "      Runtime: python3.12\n"], [101, "      Timeout: 300\n"], [102, "      MemorySize: 256\n"], [103, "      Environment:\n"], [104, "        Variables:\n"], [105, "          LOG_LEVEL:\n"], [106, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bda-lending-project/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [81, 106], "resource": "AWS::Serverless::Function.BDAProjectLambda", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bda-lending-project/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bda-lending-project/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[81, "  BDAProjectLambda:\n"], [82, "    Type: AWS::Serverless::Function\n"], [83, "    Metadata:\n"], [84, "      SamResourceId: BDAProjectLambda\n"], [85, "      cfn_nag:\n"], [86, "        rules_to_suppress:\n"], [87, "        - id: W89\n"], [88, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [89, "            with AWS services via AWS APIs\n"], [90, "        - id: W92\n"], [91, "          reason: Function does not require concurrent execution limits as it is designed\n"], [92, "            to scale based on demand\n"], [93, "    Properties:\n"], [94, "      CodeUri: BDAProjectLambda\n"], [95, "      Handler: index.handler\n"], [96, "      Role:\n"], [97, "        Fn::GetAtt:\n"], [98, "        - LambdaExecutionRole\n"], [99, "        - Arn\n"], [100, "      Runtime: python3.12\n"], [101, "      Timeout: 300\n"], [102, "      MemorySize: 256\n"], [103, "      Environment:\n"], [104, "        Variables:\n"], [105, "          LOG_LEVEL:\n"], [106, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bda-lending-project/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [81, 106], "resource": "AWS::Serverless::Function.BDAProjectLambda", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bda-lending-project/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bda-lending-project/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}]}, "summary": {"passed": 11, "failed": 4, "skipped": 0, "parsing_errors": 0, "resource_count": 3, "checkov_version": "3.2.461"}}