[
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-001",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Information Disclosure",
    "severity": "Medium",
    "resource_type": "AWS::Logs::LogGroup",
    "resource_name": "All LogGroups",
    "title": "Log Groups Not Configured with Log Export",
    "issue": "Log groups are properly encrypted but not configured to export logs to a centralized location for long-term retention and security analysis.",
    "attack_vector": "After a security incident, logs may not be available for forensic analysis if they remain only in CloudWatch and not exported to a durable location.",
    "impact": "Limited ability to perform post-incident forensic analysis and potential compliance violations for log retention requirements.",
    "remediation": "Configure log export to S3 or other centralized log storage solution for all log groups. Consider using CloudWatch Logs Subscription Filters to send logs to a central account or SIEM solution.",
    "priority": 2,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-778",
    "compliance_violations": ["PCI DSS 10.7", "NIST 800-53 AU-4", "HIPAA 164.312(b)"],
    "references": ["https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/S3Export.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-002",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Repudiation",
    "severity": "Medium",
    "resource_type": "AWS::StepFunctions::StateMachine",
    "resource_name": "DocumentProcessingStateMachine",
    "title": "Limited State Machine Execution History",
    "issue": "While the state machine has logging configured, there's no configuration for extended retention of execution history beyond the default period.",
    "attack_vector": "Attackers could perform malicious actions and, after the default retention period, evidence of these actions would be purged.",
    "impact": "Limited ability to audit historical state machine executions for security incidents beyond the default retention period.",
    "remediation": "Implement a mechanism to export and archive state machine execution histories to a long-term storage solution like S3 with appropriate lifecycle policies.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-223",
    "compliance_violations": ["PCI DSS 10.7", "SOX 404"],
    "references": ["https://docs.aws.amazon.com/step-functions/latest/dg/cw-logs.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-003",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Elevation of Privilege",
    "severity": "Medium",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "InvokeBDAFunction, ProcessResultsFunction, SummarizationFunction",
    "title": "Lambda Functions with Broad Permissions",
    "issue": "Several Lambda functions have broad permissions for S3 buckets (S3CrudPolicy) and DynamoDB tables, which could allow for privilege escalation if the function is compromised.",
    "attack_vector": "If a function is compromised (e.g., through dependency injection or code execution), an attacker could leverage the broad permissions to access or modify data they shouldn't have access to.",
    "impact": "Potential unauthorized access to data in S3 buckets and DynamoDB tables, allowing data theft or tampering.",
    "remediation": "Implement more restrictive IAM policies following the principle of least privilege. Limit S3 permissions to specific prefixes and operations needed, and restrict DynamoDB actions to only those required for function operation.",
    "priority": 2,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-272",
    "compliance_violations": ["CIS AWS Foundations 1.22"],
    "references": ["https://docs.aws.amazon.com/lambda/latest/dg/lambda-permissions.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-004",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Tampering",
    "severity": "Medium",
    "resource_type": "AWS::Serverless::StateMachine",
    "resource_name": "DocumentProcessingStateMachine",
    "title": "Potential Data Integrity Risk in Document Processing Workflow",
    "issue": "The state machine handles document processing but lacks integrity verification steps to ensure documents haven't been tampered with between processing stages.",
    "attack_vector": "An attacker with access to the S3 bucket could modify documents between processing steps, potentially affecting analysis results.",
    "impact": "Compromised data integrity leading to incorrect document processing results and potentially biased or malicious output.",
    "remediation": "Implement integrity checks like checksums or digital signatures at each processing stage to verify documents haven't been modified. Store these checksums in a secured DynamoDB table.",
    "priority": 2,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-345",
    "compliance_violations": ["NIST 800-53 SI-7"],
    "references": ["https://docs.aws.amazon.com/AmazonS3/latest/userguide/checking-object-integrity.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-005",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Denial of Service",
    "severity": "Medium",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "All Lambda Functions",
    "title": "No Reserved Concurrency for Lambda Functions",
    "issue": "Lambda functions don't have reserved concurrency configured, which could lead to resource exhaustion during high demand or potential DoS scenarios.",
    "attack_vector": "An attacker could trigger numerous simultaneous requests, potentially exhausting the account's Lambda concurrency limit and affecting other systems.",
    "impact": "Service disruption affecting document processing capabilities and potentially other Lambda functions in the same AWS account.",
    "remediation": "Configure reserved concurrency limits for critical Lambda functions to ensure they have dedicated resources. Implement throttling or rate limiting at the API level.",
    "priority": 3,
    "estimated_effort": "Low",
    "cwe_id": "CWE-400",
    "compliance_violations": ["NIST 800-53 SC-5"],
    "references": ["https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-006",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Information Disclosure",
    "severity": "High",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "SummarizationFunction",
    "title": "Potential Sensitive Data Exposure via Bedrock Models",
    "issue": "The SummarizationFunction has permissions to invoke any Bedrock foundation model and might send sensitive document contents to external AI models without proper data filtering.",
    "attack_vector": "Sensitive or confidential information in processed documents could be sent to foundation models, potentially leading to data leakage or exposure.",
    "impact": "Exposure of confidential business information, PII, or regulated data to external AI services, potentially violating compliance requirements and data privacy regulations.",
    "remediation": "Implement content filtering to remove sensitive information before sending to Bedrock models. Restrict Bedrock model access to specific approved models only. Consider implementing PII detection and redaction before summarization.",
    "priority": 1,
    "estimated_effort": "High",
    "cwe_id": "CWE-200",
    "compliance_violations": ["GDPR Article 32", "HIPAA 164.312", "PCI DSS 4.0"],
    "references": ["https://docs.aws.amazon.com/bedrock/latest/userguide/security-data.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-007",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Elevation of Privilege",
    "severity": "High",
    "resource_type": "AWS::IAM::Role",
    "resource_name": "HITLProcessLambdaRole",
    "title": "Overly Permissive DynamoDB Access",
    "issue": "The HITLProcessLambdaRole has broad permissions on DynamoDB tables, including Delete operations that may not be necessary for its function.",
    "attack_vector": "If compromised, an attacker could delete records from the DynamoDB tables, causing data loss or disrupting the document processing workflow.",
    "impact": "Potential data loss, workflow disruption, and inability to process documents properly if DynamoDB records are deleted.",
    "remediation": "Apply the principle of least privilege by restricting permissions to only those operations needed (likely Get, Query, Scan, and potentially PutItem). Remove unnecessary DeleteItem, DeleteTable permissions.",
    "priority": 1,
    "estimated_effort": "Low",
    "cwe_id": "CWE-272",
    "compliance_violations": ["CIS AWS Foundations 1.16"],
    "references": ["https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/specifying-conditions.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-008",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Spoofing",
    "severity": "Medium",
    "resource_type": "AWS::Events::Rule",
    "resource_name": "HITLEventRule, BDAEventRule",
    "title": "Missing Source Identity Verification for EventBridge Rules",
    "issue": "EventBridge rules for HITL and BDA events don't verify the source identity beyond the source field, which could allow spoofed events.",
    "attack_vector": "An attacker with appropriate permissions could potentially spoof events that match the pattern to trigger Lambda functions with false information.",
    "impact": "Processing of fraudulent events, potentially leading to incorrect document processing or HITL workflow manipulation.",
    "remediation": "Add additional event pattern matching criteria to verify the source identity, such as account-specific fields or additional detail attributes that would be difficult to spoof.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-290",
    "compliance_violations": ["NIST 800-53 IA-3"],
    "references": ["https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-event-patterns.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-009",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Tampering",
    "severity": "Low",
    "resource_type": "AWS::SQS::Queue",
    "resource_name": "BDACompletionFunctionDLQ",
    "title": "Dead Letter Queue Without Access Policy",
    "issue": "The BDACompletionFunctionDLQ has encryption but no explicit access policy to restrict who can receive or delete messages from the queue.",
    "attack_vector": "An attacker with appropriate IAM permissions could purge or consume messages from the DLQ, potentially hiding failed execution evidence.",
    "impact": "Loss of failed execution data that could be important for troubleshooting or security analysis.",
    "remediation": "Implement an SQS access policy that restricts who can receive, delete, or purge messages from the queue. Consider implementing notification on message arrival to alert operations teams.",
    "priority": 4,
    "estimated_effort": "Low",
    "cwe_id": "CWE-284",
    "compliance_violations": ["CIS AWS Foundations 2.2"],
    "references": ["https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-authentication-and-access-control.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-010",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Repudiation",
    "severity": "Medium",
    "resource_type": "AWS::DynamoDB::Table",
    "resource_name": "BDAMetadataTable",
    "title": "Missing DynamoDB Contributor Insights",
    "issue": "The BDAMetadataTable doesn't have CloudWatch Contributor Insights enabled, making it difficult to track who made what changes to data.",
    "attack_vector": "An attacker could modify data in the table, and it would be difficult to trace back to specific principals or identify unusual access patterns.",
    "impact": "Reduced ability to perform forensic analysis and detect unusual access patterns, potentially allowing malicious activity to go undetected.",
    "remediation": "Enable CloudWatch Contributor Insights for the DynamoDB table to track access patterns. Consider implementing advanced features like DynamoDB streams with Lambda to log changes to a secure audit log.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-778",
    "compliance_violations": ["NIST 800-53 AU-3"],
    "references": ["https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/contributorinsights.html"],
    "status": "Open"
  }
]