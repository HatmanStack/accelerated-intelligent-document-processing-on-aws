{"check_type": "cloudformation", "results": {"failed_checks": [{"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[583, "  InvokeBDAFunction:\n"], [584, "    Type: AWS::Serverless::Function\n"], [585, "    Metadata:\n"], [586, "      SamResourceId: InvokeBDAFunction\n"], [587, "      cfn_nag:\n"], [588, "        rules_to_suppress:\n"], [589, "        - id: W11\n"], [590, "          reason: Cloudwatch does not support resource-level permissions\n"], [591, "        - id: W89\n"], [592, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [593, "            with AWS services via AWS APIs\n"], [594, "        - id: W92\n"], [595, "          reason: Function does not require concurrent execution limits as it is designed\n"], [596, "            to scale based on demand\n"], [597, "    Properties:\n"], [598, "      PermissionsBoundary:\n"], [599, "        Fn::If:\n"], [600, "        - HasPermissionsBoundary\n"], [601, "        - Ref: PermissionsBoundaryArn\n"], [602, "        - Ref: AWS::NoValue\n"], [603, "      CodeUri: InvokeBDAFunction\n"], [604, "      Handler: index.handler\n"], [605, "      Runtime: python3.12\n"], [606, "      Timeout: 900\n"], [607, "      MemorySize: 4096\n"], [608, "      Environment:\n"], [609, "        Variables:\n"], [610, "          TRACKING_TABLE:\n"], [611, "            Ref: TrackingTable\n"], [612, "          METRIC_NAMESPACE:\n"], [613, "            Ref: StackName\n"], [614, "          MAX_WORKERS: 20\n"], [615, "          LOG_LEVEL:\n"], [616, "            Ref: LogLevel\n"], [617, "      LoggingConfig:\n"], [618, "        LogGroup:\n"], [619, "          Ref: InvokeBDAFunctionLogGroup\n"], [620, "      Policies:\n"], [621, "      - AWSLambdaBasicExecutionRole\n"], [622, "      - S3ReadPolicy:\n"], [623, "          BucketName:\n"], [624, "            Ref: InputBucket\n"], [625, "      - S3CrudPolicy:\n"], [626, "          BucketName:\n"], [627, "            Ref: WorkingBucket\n"], [628, "      - S3CrudPolicy:\n"], [629, "          BucketName:\n"], [630, "            Ref: OutputBucket\n"], [631, "      - DynamoDBCrudPolicy:\n"], [632, "          TableName:\n"], [633, "            Ref: TrackingTable\n"], [634, "      - Statement:\n"], [635, "        - Effect: Allow\n"], [636, "          Action: cloudwatch:PutMetricData\n"], [637, "          Resource: '*'\n"], [638, "        - Effect: Allow\n"], [639, "          Action:\n"], [640, "          - kms:Encrypt\n"], [641, "          - kms:Decrypt\n"], [642, "          - kms:ReEncrypt*\n"], [643, "          - kms:GenerateDataKey*\n"], [644, "          - kms:DescribeKey\n"], [645, "          Resource:\n"], [646, "            Ref: CustomerManagedEncryptionKeyArn\n"], [647, "        - Effect: Allow\n"], [648, "          Action: bedrock:InvokeDataAutomationAsync\n"], [649, "          Resource:\n"], [650, "          - Ref: BDAProjectArn\n"], [651, "          - Fn::Sub: arn:aws:bedrock:us-east-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [652, "          - Fn::Sub: arn:aws:bedrock:us-east-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [653, "          - Fn::Sub: arn:aws:bedrock:us-west-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [654, "          - Fn::Sub: arn:aws:bedrock:us-west-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [583, 654], "resource": "AWS::Serverless::Function.InvokeBDAFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[583, "  InvokeBDAFunction:\n"], [584, "    Type: AWS::Serverless::Function\n"], [585, "    Metadata:\n"], [586, "      SamResourceId: InvokeBDAFunction\n"], [587, "      cfn_nag:\n"], [588, "        rules_to_suppress:\n"], [589, "        - id: W11\n"], [590, "          reason: Cloudwatch does not support resource-level permissions\n"], [591, "        - id: W89\n"], [592, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [593, "            with AWS services via AWS APIs\n"], [594, "        - id: W92\n"], [595, "          reason: Function does not require concurrent execution limits as it is designed\n"], [596, "            to scale based on demand\n"], [597, "    Properties:\n"], [598, "      PermissionsBoundary:\n"], [599, "        Fn::If:\n"], [600, "        - HasPermissionsBoundary\n"], [601, "        - Ref: PermissionsBoundaryArn\n"], [602, "        - Ref: AWS::NoValue\n"], [603, "      CodeUri: InvokeBDAFunction\n"], [604, "      Handler: index.handler\n"], [605, "      Runtime: python3.12\n"], [606, "      Timeout: 900\n"], [607, "      MemorySize: 4096\n"], [608, "      Environment:\n"], [609, "        Variables:\n"], [610, "          TRACKING_TABLE:\n"], [611, "            Ref: TrackingTable\n"], [612, "          METRIC_NAMESPACE:\n"], [613, "            Ref: StackName\n"], [614, "          MAX_WORKERS: 20\n"], [615, "          LOG_LEVEL:\n"], [616, "            Ref: LogLevel\n"], [617, "      LoggingConfig:\n"], [618, "        LogGroup:\n"], [619, "          Ref: InvokeBDAFunctionLogGroup\n"], [620, "      Policies:\n"], [621, "      - AWSLambdaBasicExecutionRole\n"], [622, "      - S3ReadPolicy:\n"], [623, "          BucketName:\n"], [624, "            Ref: InputBucket\n"], [625, "      - S3CrudPolicy:\n"], [626, "          BucketName:\n"], [627, "            Ref: WorkingBucket\n"], [628, "      - S3CrudPolicy:\n"], [629, "          BucketName:\n"], [630, "            Ref: OutputBucket\n"], [631, "      - DynamoDBCrudPolicy:\n"], [632, "          TableName:\n"], [633, "            Ref: TrackingTable\n"], [634, "      - Statement:\n"], [635, "        - Effect: Allow\n"], [636, "          Action: cloudwatch:PutMetricData\n"], [637, "          Resource: '*'\n"], [638, "        - Effect: Allow\n"], [639, "          Action:\n"], [640, "          - kms:Encrypt\n"], [641, "          - kms:Decrypt\n"], [642, "          - kms:ReEncrypt*\n"], [643, "          - kms:GenerateDataKey*\n"], [644, "          - kms:DescribeKey\n"], [645, "          Resource:\n"], [646, "            Ref: CustomerManagedEncryptionKeyArn\n"], [647, "        - Effect: Allow\n"], [648, "          Action: bedrock:InvokeDataAutomationAsync\n"], [649, "          Resource:\n"], [650, "          - Ref: BDAProjectArn\n"], [651, "          - Fn::Sub: arn:aws:bedrock:us-east-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [652, "          - Fn::Sub: arn:aws:bedrock:us-east-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [653, "          - Fn::Sub: arn:aws:bedrock:us-west-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [654, "          - Fn::Sub: arn:aws:bedrock:us-west-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [583, 654], "resource": "AWS::Serverless::Function.InvokeBDAFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[583, "  InvokeBDAFunction:\n"], [584, "    Type: AWS::Serverless::Function\n"], [585, "    Metadata:\n"], [586, "      SamResourceId: InvokeBDAFunction\n"], [587, "      cfn_nag:\n"], [588, "        rules_to_suppress:\n"], [589, "        - id: W11\n"], [590, "          reason: Cloudwatch does not support resource-level permissions\n"], [591, "        - id: W89\n"], [592, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [593, "            with AWS services via AWS APIs\n"], [594, "        - id: W92\n"], [595, "          reason: Function does not require concurrent execution limits as it is designed\n"], [596, "            to scale based on demand\n"], [597, "    Properties:\n"], [598, "      PermissionsBoundary:\n"], [599, "        Fn::If:\n"], [600, "        - HasPermissionsBoundary\n"], [601, "        - Ref: PermissionsBoundaryArn\n"], [602, "        - Ref: AWS::NoValue\n"], [603, "      CodeUri: InvokeBDAFunction\n"], [604, "      Handler: index.handler\n"], [605, "      Runtime: python3.12\n"], [606, "      Timeout: 900\n"], [607, "      MemorySize: 4096\n"], [608, "      Environment:\n"], [609, "        Variables:\n"], [610, "          TRACKING_TABLE:\n"], [611, "            Ref: TrackingTable\n"], [612, "          METRIC_NAMESPACE:\n"], [613, "            Ref: StackName\n"], [614, "          MAX_WORKERS: 20\n"], [615, "          LOG_LEVEL:\n"], [616, "            Ref: LogLevel\n"], [617, "      LoggingConfig:\n"], [618, "        LogGroup:\n"], [619, "          Ref: InvokeBDAFunctionLogGroup\n"], [620, "      Policies:\n"], [621, "      - AWSLambdaBasicExecutionRole\n"], [622, "      - S3ReadPolicy:\n"], [623, "          BucketName:\n"], [624, "            Ref: InputBucket\n"], [625, "      - S3CrudPolicy:\n"], [626, "          BucketName:\n"], [627, "            Ref: WorkingBucket\n"], [628, "      - S3CrudPolicy:\n"], [629, "          BucketName:\n"], [630, "            Ref: OutputBucket\n"], [631, "      - DynamoDBCrudPolicy:\n"], [632, "          TableName:\n"], [633, "            Ref: TrackingTable\n"], [634, "      - Statement:\n"], [635, "        - Effect: Allow\n"], [636, "          Action: cloudwatch:PutMetricData\n"], [637, "          Resource: '*'\n"], [638, "        - Effect: Allow\n"], [639, "          Action:\n"], [640, "          - kms:Encrypt\n"], [641, "          - kms:Decrypt\n"], [642, "          - kms:ReEncrypt*\n"], [643, "          - kms:GenerateDataKey*\n"], [644, "          - kms:DescribeKey\n"], [645, "          Resource:\n"], [646, "            Ref: CustomerManagedEncryptionKeyArn\n"], [647, "        - Effect: Allow\n"], [648, "          Action: bedrock:InvokeDataAutomationAsync\n"], [649, "          Resource:\n"], [650, "          - Ref: BDAProjectArn\n"], [651, "          - Fn::Sub: arn:aws:bedrock:us-east-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [652, "          - Fn::Sub: arn:aws:bedrock:us-east-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [653, "          - Fn::Sub: arn:aws:bedrock:us-west-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [654, "          - Fn::Sub: arn:aws:bedrock:us-west-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [583, 654], "resource": "AWS::Serverless::Function.InvokeBDAFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[583, "  InvokeBDAFunction:\n"], [584, "    Type: AWS::Serverless::Function\n"], [585, "    Metadata:\n"], [586, "      SamResourceId: InvokeBDAFunction\n"], [587, "      cfn_nag:\n"], [588, "        rules_to_suppress:\n"], [589, "        - id: W11\n"], [590, "          reason: Cloudwatch does not support resource-level permissions\n"], [591, "        - id: W89\n"], [592, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [593, "            with AWS services via AWS APIs\n"], [594, "        - id: W92\n"], [595, "          reason: Function does not require concurrent execution limits as it is designed\n"], [596, "            to scale based on demand\n"], [597, "    Properties:\n"], [598, "      PermissionsBoundary:\n"], [599, "        Fn::If:\n"], [600, "        - HasPermissionsBoundary\n"], [601, "        - Ref: PermissionsBoundaryArn\n"], [602, "        - Ref: AWS::NoValue\n"], [603, "      CodeUri: InvokeBDAFunction\n"], [604, "      Handler: index.handler\n"], [605, "      Runtime: python3.12\n"], [606, "      Timeout: 900\n"], [607, "      MemorySize: 4096\n"], [608, "      Environment:\n"], [609, "        Variables:\n"], [610, "          TRACKING_TABLE:\n"], [611, "            Ref: TrackingTable\n"], [612, "          METRIC_NAMESPACE:\n"], [613, "            Ref: StackName\n"], [614, "          MAX_WORKERS: 20\n"], [615, "          LOG_LEVEL:\n"], [616, "            Ref: LogLevel\n"], [617, "      LoggingConfig:\n"], [618, "        LogGroup:\n"], [619, "          Ref: InvokeBDAFunctionLogGroup\n"], [620, "      Policies:\n"], [621, "      - AWSLambdaBasicExecutionRole\n"], [622, "      - S3ReadPolicy:\n"], [623, "          BucketName:\n"], [624, "            Ref: InputBucket\n"], [625, "      - S3CrudPolicy:\n"], [626, "          BucketName:\n"], [627, "            Ref: WorkingBucket\n"], [628, "      - S3CrudPolicy:\n"], [629, "          BucketName:\n"], [630, "            Ref: OutputBucket\n"], [631, "      - DynamoDBCrudPolicy:\n"], [632, "          TableName:\n"], [633, "            Ref: TrackingTable\n"], [634, "      - Statement:\n"], [635, "        - Effect: Allow\n"], [636, "          Action: cloudwatch:PutMetricData\n"], [637, "          Resource: '*'\n"], [638, "        - Effect: Allow\n"], [639, "          Action:\n"], [640, "          - kms:Encrypt\n"], [641, "          - kms:Decrypt\n"], [642, "          - kms:ReEncrypt*\n"], [643, "          - kms:GenerateDataKey*\n"], [644, "          - kms:DescribeKey\n"], [645, "          Resource:\n"], [646, "            Ref: CustomerManagedEncryptionKeyArn\n"], [647, "        - Effect: Allow\n"], [648, "          Action: bedrock:InvokeDataAutomationAsync\n"], [649, "          Resource:\n"], [650, "          - Ref: BDAProjectArn\n"], [651, "          - Fn::Sub: arn:aws:bedrock:us-east-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [652, "          - Fn::Sub: arn:aws:bedrock:us-east-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [653, "          - Fn::Sub: arn:aws:bedrock:us-west-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [654, "          - Fn::Sub: arn:aws:bedrock:us-west-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [583, 654], "resource": "AWS::Serverless::Function.InvokeBDAFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[664, "  ProcessResultsFunction:\n"], [665, "    Type: AWS::Serverless::Function\n"], [666, "    Metadata:\n"], [667, "      SamResourceId: ProcessResultsFunction\n"], [668, "      cfn_nag:\n"], [669, "        rules_to_suppress:\n"], [670, "        - id: W11\n"], [671, "          reason: Cloudwatch does not support resource-level permissions\n"], [672, "        - id: W89\n"], [673, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [674, "            with AWS services via AWS APIs\n"], [675, "        - id: W92\n"], [676, "          reason: Function does not require concurrent execution limits as it is designed\n"], [677, "            to scale based on demand\n"], [678, "    Properties:\n"], [679, "      PermissionsBoundary:\n"], [680, "        Fn::If:\n"], [681, "        - HasPermissionsBoundary\n"], [682, "        - Ref: PermissionsBoundaryArn\n"], [683, "        - Ref: AWS::NoValue\n"], [684, "      CodeUri: ProcessResultsFunction\n"], [685, "      Handler: index.handler\n"], [686, "      Runtime: python3.12\n"], [687, "      Timeout: 900\n"], [688, "      MemorySize: 4096\n"], [689, "      Environment:\n"], [690, "        Variables:\n"], [691, "          METRIC_NAMESPACE:\n"], [692, "            Ref: StackName\n"], [693, "          LOG_LEVEL:\n"], [694, "            Ref: LogLevel\n"], [695, "          APPSYNC_API_URL:\n"], [696, "            Ref: AppSyncApiUrl\n"], [697, "          ENABLE_HITL:\n"], [698, "            Ref: EnableHITL\n"], [699, "          DB_NAME:\n"], [700, "            Ref: BDAMetadataTable\n"], [701, "          BDA_PROJECT_ARN:\n"], [702, "            Ref: BDAProjectArn\n"], [703, "          WORKING_BUCKET:\n"], [704, "            Ref: WorkingBucket\n"], [705, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [706, "            Ref: SageMakerA2IReviewPortalURL\n"], [707, "          CONFIGURATION_TABLE_NAME:\n"], [708, "            Ref: ConfigurationTable\n"], [709, "      LoggingConfig:\n"], [710, "        LogGroup:\n"], [711, "          Ref: ProcessResultsFunctionLogGroup\n"], [712, "      Policies:\n"], [713, "      - AWSLambdaBasicExecutionRole\n"], [714, "      - S3ReadPolicy:\n"], [715, "          BucketName:\n"], [716, "            Ref: InputBucket\n"], [717, "      - S3CrudPolicy:\n"], [718, "          BucketName:\n"], [719, "            Ref: WorkingBucket\n"], [720, "      - S3CrudPolicy:\n"], [721, "          BucketName:\n"], [722, "            Ref: OutputBucket\n"], [723, "      - DynamoDBCrudPolicy:\n"], [724, "          TableName:\n"], [725, "            Ref: BDAMetadataTable\n"], [726, "      - DynamoDBCrudPolicy:\n"], [727, "          TableName:\n"], [728, "            Ref: ConfigurationTable\n"], [729, "      - Statement:\n"], [730, "        - Effect: Allow\n"], [731, "          Action: cloudwatch:PutMetricData\n"], [732, "          Resource: '*'\n"], [733, "        - Effect: Allow\n"], [734, "          Action:\n"], [735, "          - kms:Encrypt\n"], [736, "          - kms:Decrypt\n"], [737, "          - kms:ReEncrypt*\n"], [738, "          - kms:GenerateDataKey*\n"], [739, "          - kms:DescribeKey\n"], [740, "          Resource:\n"], [741, "            Ref: CustomerManagedEncryptionKeyArn\n"], [742, "        - Effect: Allow\n"], [743, "          Action:\n"], [744, "          - appsync:GraphQL\n"], [745, "          Resource:\n"], [746, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [747, "        - Effect: Allow\n"], [748, "          Action:\n"], [749, "          - sagemaker:StartHumanLoop\n"], [750, "          Resource: arn:aws:sagemaker:*:*:flow-definition/*\n"], [751, "        - Effect: Allow\n"], [752, "          Action:\n"], [753, "          - ssm:GetParameter\n"], [754, "          - ssm:PutParameter\n"], [755, "          - ssm:GetParametersByPath\n"], [756, "          Resource: '*'\n"], [757, "        - Effect: Allow\n"], [758, "          Action:\n"], [759, "          - bedrock:GetDataAutomationProject\n"], [760, "          - bedrock:ListDataAutomationProjects\n"], [761, "          - bedrock:GetBlueprint\n"], [762, "          - bedrock:GetBlueprintRecommendation\n"], [763, "          Resource: '*'\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [664, 763], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables.ENABLE_HITL": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[664, "  ProcessResultsFunction:\n"], [665, "    Type: AWS::Serverless::Function\n"], [666, "    Metadata:\n"], [667, "      SamResourceId: ProcessResultsFunction\n"], [668, "      cfn_nag:\n"], [669, "        rules_to_suppress:\n"], [670, "        - id: W11\n"], [671, "          reason: Cloudwatch does not support resource-level permissions\n"], [672, "        - id: W89\n"], [673, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [674, "            with AWS services via AWS APIs\n"], [675, "        - id: W92\n"], [676, "          reason: Function does not require concurrent execution limits as it is designed\n"], [677, "            to scale based on demand\n"], [678, "    Properties:\n"], [679, "      PermissionsBoundary:\n"], [680, "        Fn::If:\n"], [681, "        - HasPermissionsBoundary\n"], [682, "        - Ref: PermissionsBoundaryArn\n"], [683, "        - Ref: AWS::NoValue\n"], [684, "      CodeUri: ProcessResultsFunction\n"], [685, "      Handler: index.handler\n"], [686, "      Runtime: python3.12\n"], [687, "      Timeout: 900\n"], [688, "      MemorySize: 4096\n"], [689, "      Environment:\n"], [690, "        Variables:\n"], [691, "          METRIC_NAMESPACE:\n"], [692, "            Ref: StackName\n"], [693, "          LOG_LEVEL:\n"], [694, "            Ref: LogLevel\n"], [695, "          APPSYNC_API_URL:\n"], [696, "            Ref: AppSyncApiUrl\n"], [697, "          ENABLE_HITL:\n"], [698, "            Ref: EnableHITL\n"], [699, "          DB_NAME:\n"], [700, "            Ref: BDAMetadataTable\n"], [701, "          BDA_PROJECT_ARN:\n"], [702, "            Ref: BDAProjectArn\n"], [703, "          WORKING_BUCKET:\n"], [704, "            Ref: WorkingBucket\n"], [705, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [706, "            Ref: SageMakerA2IReviewPortalURL\n"], [707, "          CONFIGURATION_TABLE_NAME:\n"], [708, "            Ref: ConfigurationTable\n"], [709, "      LoggingConfig:\n"], [710, "        LogGroup:\n"], [711, "          Ref: ProcessResultsFunctionLogGroup\n"], [712, "      Policies:\n"], [713, "      - AWSLambdaBasicExecutionRole\n"], [714, "      - S3ReadPolicy:\n"], [715, "          BucketName:\n"], [716, "            Ref: InputBucket\n"], [717, "      - S3CrudPolicy:\n"], [718, "          BucketName:\n"], [719, "            Ref: WorkingBucket\n"], [720, "      - S3CrudPolicy:\n"], [721, "          BucketName:\n"], [722, "            Ref: OutputBucket\n"], [723, "      - DynamoDBCrudPolicy:\n"], [724, "          TableName:\n"], [725, "            Ref: BDAMetadataTable\n"], [726, "      - DynamoDBCrudPolicy:\n"], [727, "          TableName:\n"], [728, "            Ref: ConfigurationTable\n"], [729, "      - Statement:\n"], [730, "        - Effect: Allow\n"], [731, "          Action: cloudwatch:PutMetricData\n"], [732, "          Resource: '*'\n"], [733, "        - Effect: Allow\n"], [734, "          Action:\n"], [735, "          - kms:Encrypt\n"], [736, "          - kms:Decrypt\n"], [737, "          - kms:ReEncrypt*\n"], [738, "          - kms:GenerateDataKey*\n"], [739, "          - kms:DescribeKey\n"], [740, "          Resource:\n"], [741, "            Ref: CustomerManagedEncryptionKeyArn\n"], [742, "        - Effect: Allow\n"], [743, "          Action:\n"], [744, "          - appsync:GraphQL\n"], [745, "          Resource:\n"], [746, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [747, "        - Effect: Allow\n"], [748, "          Action:\n"], [749, "          - sagemaker:StartHumanLoop\n"], [750, "          Resource: arn:aws:sagemaker:*:*:flow-definition/*\n"], [751, "        - Effect: Allow\n"], [752, "          Action:\n"], [753, "          - ssm:GetParameter\n"], [754, "          - ssm:PutParameter\n"], [755, "          - ssm:GetParametersByPath\n"], [756, "          Resource: '*'\n"], [757, "        - Effect: Allow\n"], [758, "          Action:\n"], [759, "          - bedrock:GetDataAutomationProject\n"], [760, "          - bedrock:ListDataAutomationProjects\n"], [761, "          - bedrock:GetBlueprint\n"], [762, "          - bedrock:GetBlueprintRecommendation\n"], [763, "          Resource: '*'\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [664, 763], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables.ENABLE_HITL": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[664, "  ProcessResultsFunction:\n"], [665, "    Type: AWS::Serverless::Function\n"], [666, "    Metadata:\n"], [667, "      SamResourceId: ProcessResultsFunction\n"], [668, "      cfn_nag:\n"], [669, "        rules_to_suppress:\n"], [670, "        - id: W11\n"], [671, "          reason: Cloudwatch does not support resource-level permissions\n"], [672, "        - id: W89\n"], [673, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [674, "            with AWS services via AWS APIs\n"], [675, "        - id: W92\n"], [676, "          reason: Function does not require concurrent execution limits as it is designed\n"], [677, "            to scale based on demand\n"], [678, "    Properties:\n"], [679, "      PermissionsBoundary:\n"], [680, "        Fn::If:\n"], [681, "        - HasPermissionsBoundary\n"], [682, "        - Ref: PermissionsBoundaryArn\n"], [683, "        - Ref: AWS::NoValue\n"], [684, "      CodeUri: ProcessResultsFunction\n"], [685, "      Handler: index.handler\n"], [686, "      Runtime: python3.12\n"], [687, "      Timeout: 900\n"], [688, "      MemorySize: 4096\n"], [689, "      Environment:\n"], [690, "        Variables:\n"], [691, "          METRIC_NAMESPACE:\n"], [692, "            Ref: StackName\n"], [693, "          LOG_LEVEL:\n"], [694, "            Ref: LogLevel\n"], [695, "          APPSYNC_API_URL:\n"], [696, "            Ref: AppSyncApiUrl\n"], [697, "          ENABLE_HITL:\n"], [698, "            Ref: EnableHITL\n"], [699, "          DB_NAME:\n"], [700, "            Ref: BDAMetadataTable\n"], [701, "          BDA_PROJECT_ARN:\n"], [702, "            Ref: BDAProjectArn\n"], [703, "          WORKING_BUCKET:\n"], [704, "            Ref: WorkingBucket\n"], [705, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [706, "            Ref: SageMakerA2IReviewPortalURL\n"], [707, "          CONFIGURATION_TABLE_NAME:\n"], [708, "            Ref: ConfigurationTable\n"], [709, "      LoggingConfig:\n"], [710, "        LogGroup:\n"], [711, "          Ref: ProcessResultsFunctionLogGroup\n"], [712, "      Policies:\n"], [713, "      - AWSLambdaBasicExecutionRole\n"], [714, "      - S3ReadPolicy:\n"], [715, "          BucketName:\n"], [716, "            Ref: InputBucket\n"], [717, "      - S3CrudPolicy:\n"], [718, "          BucketName:\n"], [719, "            Ref: WorkingBucket\n"], [720, "      - S3CrudPolicy:\n"], [721, "          BucketName:\n"], [722, "            Ref: OutputBucket\n"], [723, "      - DynamoDBCrudPolicy:\n"], [724, "          TableName:\n"], [725, "            Ref: BDAMetadataTable\n"], [726, "      - DynamoDBCrudPolicy:\n"], [727, "          TableName:\n"], [728, "            Ref: ConfigurationTable\n"], [729, "      - Statement:\n"], [730, "        - Effect: Allow\n"], [731, "          Action: cloudwatch:PutMetricData\n"], [732, "          Resource: '*'\n"], [733, "        - Effect: Allow\n"], [734, "          Action:\n"], [735, "          - kms:Encrypt\n"], [736, "          - kms:Decrypt\n"], [737, "          - kms:ReEncrypt*\n"], [738, "          - kms:GenerateDataKey*\n"], [739, "          - kms:DescribeKey\n"], [740, "          Resource:\n"], [741, "            Ref: CustomerManagedEncryptionKeyArn\n"], [742, "        - Effect: Allow\n"], [743, "          Action:\n"], [744, "          - appsync:GraphQL\n"], [745, "          Resource:\n"], [746, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [747, "        - Effect: Allow\n"], [748, "          Action:\n"], [749, "          - sagemaker:StartHumanLoop\n"], [750, "          Resource: arn:aws:sagemaker:*:*:flow-definition/*\n"], [751, "        - Effect: Allow\n"], [752, "          Action:\n"], [753, "          - ssm:GetParameter\n"], [754, "          - ssm:PutParameter\n"], [755, "          - ssm:GetParametersByPath\n"], [756, "          Resource: '*'\n"], [757, "        - Effect: Allow\n"], [758, "          Action:\n"], [759, "          - bedrock:GetDataAutomationProject\n"], [760, "          - bedrock:ListDataAutomationProjects\n"], [761, "          - bedrock:GetBlueprint\n"], [762, "          - bedrock:GetBlueprintRecommendation\n"], [763, "          Resource: '*'\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [664, 763], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables.ENABLE_HITL": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[664, "  ProcessResultsFunction:\n"], [665, "    Type: AWS::Serverless::Function\n"], [666, "    Metadata:\n"], [667, "      SamResourceId: ProcessResultsFunction\n"], [668, "      cfn_nag:\n"], [669, "        rules_to_suppress:\n"], [670, "        - id: W11\n"], [671, "          reason: Cloudwatch does not support resource-level permissions\n"], [672, "        - id: W89\n"], [673, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [674, "            with AWS services via AWS APIs\n"], [675, "        - id: W92\n"], [676, "          reason: Function does not require concurrent execution limits as it is designed\n"], [677, "            to scale based on demand\n"], [678, "    Properties:\n"], [679, "      PermissionsBoundary:\n"], [680, "        Fn::If:\n"], [681, "        - HasPermissionsBoundary\n"], [682, "        - Ref: PermissionsBoundaryArn\n"], [683, "        - Ref: AWS::NoValue\n"], [684, "      CodeUri: ProcessResultsFunction\n"], [685, "      Handler: index.handler\n"], [686, "      Runtime: python3.12\n"], [687, "      Timeout: 900\n"], [688, "      MemorySize: 4096\n"], [689, "      Environment:\n"], [690, "        Variables:\n"], [691, "          METRIC_NAMESPACE:\n"], [692, "            Ref: StackName\n"], [693, "          LOG_LEVEL:\n"], [694, "            Ref: LogLevel\n"], [695, "          APPSYNC_API_URL:\n"], [696, "            Ref: AppSyncApiUrl\n"], [697, "          ENABLE_HITL:\n"], [698, "            Ref: EnableHITL\n"], [699, "          DB_NAME:\n"], [700, "            Ref: BDAMetadataTable\n"], [701, "          BDA_PROJECT_ARN:\n"], [702, "            Ref: BDAProjectArn\n"], [703, "          WORKING_BUCKET:\n"], [704, "            Ref: WorkingBucket\n"], [705, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [706, "            Ref: SageMakerA2IReviewPortalURL\n"], [707, "          CONFIGURATION_TABLE_NAME:\n"], [708, "            Ref: ConfigurationTable\n"], [709, "      LoggingConfig:\n"], [710, "        LogGroup:\n"], [711, "          Ref: ProcessResultsFunctionLogGroup\n"], [712, "      Policies:\n"], [713, "      - AWSLambdaBasicExecutionRole\n"], [714, "      - S3ReadPolicy:\n"], [715, "          BucketName:\n"], [716, "            Ref: InputBucket\n"], [717, "      - S3CrudPolicy:\n"], [718, "          BucketName:\n"], [719, "            Ref: WorkingBucket\n"], [720, "      - S3CrudPolicy:\n"], [721, "          BucketName:\n"], [722, "            Ref: OutputBucket\n"], [723, "      - DynamoDBCrudPolicy:\n"], [724, "          TableName:\n"], [725, "            Ref: BDAMetadataTable\n"], [726, "      - DynamoDBCrudPolicy:\n"], [727, "          TableName:\n"], [728, "            Ref: ConfigurationTable\n"], [729, "      - Statement:\n"], [730, "        - Effect: Allow\n"], [731, "          Action: cloudwatch:PutMetricData\n"], [732, "          Resource: '*'\n"], [733, "        - Effect: Allow\n"], [734, "          Action:\n"], [735, "          - kms:Encrypt\n"], [736, "          - kms:Decrypt\n"], [737, "          - kms:ReEncrypt*\n"], [738, "          - kms:GenerateDataKey*\n"], [739, "          - kms:DescribeKey\n"], [740, "          Resource:\n"], [741, "            Ref: CustomerManagedEncryptionKeyArn\n"], [742, "        - Effect: Allow\n"], [743, "          Action:\n"], [744, "          - appsync:GraphQL\n"], [745, "          Resource:\n"], [746, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [747, "        - Effect: Allow\n"], [748, "          Action:\n"], [749, "          - sagemaker:StartHumanLoop\n"], [750, "          Resource: arn:aws:sagemaker:*:*:flow-definition/*\n"], [751, "        - Effect: Allow\n"], [752, "          Action:\n"], [753, "          - ssm:GetParameter\n"], [754, "          - ssm:PutParameter\n"], [755, "          - ssm:GetParametersByPath\n"], [756, "          Resource: '*'\n"], [757, "        - Effect: Allow\n"], [758, "          Action:\n"], [759, "          - bedrock:GetDataAutomationProject\n"], [760, "          - bedrock:ListDataAutomationProjects\n"], [761, "          - bedrock:GetBlueprint\n"], [762, "          - bedrock:GetBlueprintRecommendation\n"], [763, "          Resource: '*'\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [664, 763], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables.ENABLE_HITL": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[773, "  SummarizationFunction:\n"], [774, "    Type: AWS::Serverless::Function\n"], [775, "    Metadata:\n"], [776, "      SamResourceId: SummarizationFunction\n"], [777, "      cfn_nag:\n"], [778, "        rules_to_suppress:\n"], [779, "        - id: W11\n"], [780, "          reason: Cloudwatch does not support resource-level permissions\n"], [781, "        - id: W89\n"], [782, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [783, "            with AWS services via AWS APIs\n"], [784, "        - id: W92\n"], [785, "          reason: Function does not require concurrent execution limits as it is designed\n"], [786, "            to scale based on demand\n"], [787, "    Properties:\n"], [788, "      PermissionsBoundary:\n"], [789, "        Fn::If:\n"], [790, "        - HasPermissionsBoundary\n"], [791, "        - Ref: PermissionsBoundaryArn\n"], [792, "        - Ref: AWS::NoValue\n"], [793, "      CodeUri: SummarizationFunction\n"], [794, "      Handler: index.handler\n"], [795, "      Runtime: python3.12\n"], [796, "      Timeout: 900\n"], [797, "      MemorySize: 4096\n"], [798, "      Environment:\n"], [799, "        Variables:\n"], [800, "          METRIC_NAMESPACE:\n"], [801, "            Ref: StackName\n"], [802, "          CONFIGURATION_TABLE_NAME:\n"], [803, "            Ref: ConfigurationTable\n"], [804, "          GUARDRAIL_ID_AND_VERSION:\n"], [805, "            Fn::If:\n"], [806, "            - HasGuardrailConfig\n"], [807, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [808, "            - ''\n"], [809, "          LOG_LEVEL:\n"], [810, "            Ref: LogLevel\n"], [811, "          APPSYNC_API_URL:\n"], [812, "            Ref: AppSyncApiUrl\n"], [813, "          WORKING_BUCKET:\n"], [814, "            Ref: WorkingBucket\n"], [815, "      LoggingConfig:\n"], [816, "        LogGroup:\n"], [817, "          Ref: SummarizationFunctionLogGroup\n"], [818, "      Policies:\n"], [819, "      - AWSLambdaBasicExecutionRole\n"], [820, "      - S3ReadPolicy:\n"], [821, "          BucketName:\n"], [822, "            Ref: InputBucket\n"], [823, "      - S3CrudPolicy:\n"], [824, "          BucketName:\n"], [825, "            Ref: OutputBucket\n"], [826, "      - S3CrudPolicy:\n"], [827, "          BucketName:\n"], [828, "            Ref: WorkingBucket\n"], [829, "      - DynamoDBCrudPolicy:\n"], [830, "          TableName:\n"], [831, "            Ref: ConfigurationTable\n"], [832, "      - Statement:\n"], [833, "        - Effect: Allow\n"], [834, "          Action: cloudwatch:PutMetricData\n"], [835, "          Resource: '*'\n"], [836, "        - Effect: Allow\n"], [837, "          Action:\n"], [838, "          - kms:Encrypt\n"], [839, "          - kms:Decrypt\n"], [840, "          - kms:ReEncrypt*\n"], [841, "          - kms:GenerateDataKey*\n"], [842, "          - kms:DescribeKey\n"], [843, "          Resource:\n"], [844, "            Ref: CustomerManagedEncryptionKeyArn\n"], [845, "        - Effect: Allow\n"], [846, "          Action:\n"], [847, "          - appsync:GraphQL\n"], [848, "          Resource:\n"], [849, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [850, "        - Effect: Allow\n"], [851, "          Action: bedrock:InvokeModel\n"], [852, "          Resource:\n"], [853, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [854, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [855, "        - Fn::If:\n"], [856, "          - HasGuardrailConfig\n"], [857, "          - Effect: Allow\n"], [858, "            Action: bedrock:ApplyGuardrail\n"], [859, "            Resource:\n"], [860, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [861, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [773, 861], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[773, "  SummarizationFunction:\n"], [774, "    Type: AWS::Serverless::Function\n"], [775, "    Metadata:\n"], [776, "      SamResourceId: SummarizationFunction\n"], [777, "      cfn_nag:\n"], [778, "        rules_to_suppress:\n"], [779, "        - id: W11\n"], [780, "          reason: Cloudwatch does not support resource-level permissions\n"], [781, "        - id: W89\n"], [782, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [783, "            with AWS services via AWS APIs\n"], [784, "        - id: W92\n"], [785, "          reason: Function does not require concurrent execution limits as it is designed\n"], [786, "            to scale based on demand\n"], [787, "    Properties:\n"], [788, "      PermissionsBoundary:\n"], [789, "        Fn::If:\n"], [790, "        - HasPermissionsBoundary\n"], [791, "        - Ref: PermissionsBoundaryArn\n"], [792, "        - Ref: AWS::NoValue\n"], [793, "      CodeUri: SummarizationFunction\n"], [794, "      Handler: index.handler\n"], [795, "      Runtime: python3.12\n"], [796, "      Timeout: 900\n"], [797, "      MemorySize: 4096\n"], [798, "      Environment:\n"], [799, "        Variables:\n"], [800, "          METRIC_NAMESPACE:\n"], [801, "            Ref: StackName\n"], [802, "          CONFIGURATION_TABLE_NAME:\n"], [803, "            Ref: ConfigurationTable\n"], [804, "          GUARDRAIL_ID_AND_VERSION:\n"], [805, "            Fn::If:\n"], [806, "            - HasGuardrailConfig\n"], [807, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [808, "            - ''\n"], [809, "          LOG_LEVEL:\n"], [810, "            Ref: LogLevel\n"], [811, "          APPSYNC_API_URL:\n"], [812, "            Ref: AppSyncApiUrl\n"], [813, "          WORKING_BUCKET:\n"], [814, "            Ref: WorkingBucket\n"], [815, "      LoggingConfig:\n"], [816, "        LogGroup:\n"], [817, "          Ref: SummarizationFunctionLogGroup\n"], [818, "      Policies:\n"], [819, "      - AWSLambdaBasicExecutionRole\n"], [820, "      - S3ReadPolicy:\n"], [821, "          BucketName:\n"], [822, "            Ref: InputBucket\n"], [823, "      - S3CrudPolicy:\n"], [824, "          BucketName:\n"], [825, "            Ref: OutputBucket\n"], [826, "      - S3CrudPolicy:\n"], [827, "          BucketName:\n"], [828, "            Ref: WorkingBucket\n"], [829, "      - DynamoDBCrudPolicy:\n"], [830, "          TableName:\n"], [831, "            Ref: ConfigurationTable\n"], [832, "      - Statement:\n"], [833, "        - Effect: Allow\n"], [834, "          Action: cloudwatch:PutMetricData\n"], [835, "          Resource: '*'\n"], [836, "        - Effect: Allow\n"], [837, "          Action:\n"], [838, "          - kms:Encrypt\n"], [839, "          - kms:Decrypt\n"], [840, "          - kms:ReEncrypt*\n"], [841, "          - kms:GenerateDataKey*\n"], [842, "          - kms:DescribeKey\n"], [843, "          Resource:\n"], [844, "            Ref: CustomerManagedEncryptionKeyArn\n"], [845, "        - Effect: Allow\n"], [846, "          Action:\n"], [847, "          - appsync:GraphQL\n"], [848, "          Resource:\n"], [849, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [850, "        - Effect: Allow\n"], [851, "          Action: bedrock:InvokeModel\n"], [852, "          Resource:\n"], [853, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [854, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [855, "        - Fn::If:\n"], [856, "          - HasGuardrailConfig\n"], [857, "          - Effect: Allow\n"], [858, "            Action: bedrock:ApplyGuardrail\n"], [859, "            Resource:\n"], [860, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [861, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [773, 861], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[773, "  SummarizationFunction:\n"], [774, "    Type: AWS::Serverless::Function\n"], [775, "    Metadata:\n"], [776, "      SamResourceId: SummarizationFunction\n"], [777, "      cfn_nag:\n"], [778, "        rules_to_suppress:\n"], [779, "        - id: W11\n"], [780, "          reason: Cloudwatch does not support resource-level permissions\n"], [781, "        - id: W89\n"], [782, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [783, "            with AWS services via AWS APIs\n"], [784, "        - id: W92\n"], [785, "          reason: Function does not require concurrent execution limits as it is designed\n"], [786, "            to scale based on demand\n"], [787, "    Properties:\n"], [788, "      PermissionsBoundary:\n"], [789, "        Fn::If:\n"], [790, "        - HasPermissionsBoundary\n"], [791, "        - Ref: PermissionsBoundaryArn\n"], [792, "        - Ref: AWS::NoValue\n"], [793, "      CodeUri: SummarizationFunction\n"], [794, "      Handler: index.handler\n"], [795, "      Runtime: python3.12\n"], [796, "      Timeout: 900\n"], [797, "      MemorySize: 4096\n"], [798, "      Environment:\n"], [799, "        Variables:\n"], [800, "          METRIC_NAMESPACE:\n"], [801, "            Ref: StackName\n"], [802, "          CONFIGURATION_TABLE_NAME:\n"], [803, "            Ref: ConfigurationTable\n"], [804, "          GUARDRAIL_ID_AND_VERSION:\n"], [805, "            Fn::If:\n"], [806, "            - HasGuardrailConfig\n"], [807, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [808, "            - ''\n"], [809, "          LOG_LEVEL:\n"], [810, "            Ref: LogLevel\n"], [811, "          APPSYNC_API_URL:\n"], [812, "            Ref: AppSyncApiUrl\n"], [813, "          WORKING_BUCKET:\n"], [814, "            Ref: WorkingBucket\n"], [815, "      LoggingConfig:\n"], [816, "        LogGroup:\n"], [817, "          Ref: SummarizationFunctionLogGroup\n"], [818, "      Policies:\n"], [819, "      - AWSLambdaBasicExecutionRole\n"], [820, "      - S3ReadPolicy:\n"], [821, "          BucketName:\n"], [822, "            Ref: InputBucket\n"], [823, "      - S3CrudPolicy:\n"], [824, "          BucketName:\n"], [825, "            Ref: OutputBucket\n"], [826, "      - S3CrudPolicy:\n"], [827, "          BucketName:\n"], [828, "            Ref: WorkingBucket\n"], [829, "      - DynamoDBCrudPolicy:\n"], [830, "          TableName:\n"], [831, "            Ref: ConfigurationTable\n"], [832, "      - Statement:\n"], [833, "        - Effect: Allow\n"], [834, "          Action: cloudwatch:PutMetricData\n"], [835, "          Resource: '*'\n"], [836, "        - Effect: Allow\n"], [837, "          Action:\n"], [838, "          - kms:Encrypt\n"], [839, "          - kms:Decrypt\n"], [840, "          - kms:ReEncrypt*\n"], [841, "          - kms:GenerateDataKey*\n"], [842, "          - kms:DescribeKey\n"], [843, "          Resource:\n"], [844, "            Ref: CustomerManagedEncryptionKeyArn\n"], [845, "        - Effect: Allow\n"], [846, "          Action:\n"], [847, "          - appsync:GraphQL\n"], [848, "          Resource:\n"], [849, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [850, "        - Effect: Allow\n"], [851, "          Action: bedrock:InvokeModel\n"], [852, "          Resource:\n"], [853, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [854, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [855, "        - Fn::If:\n"], [856, "          - HasGuardrailConfig\n"], [857, "          - Effect: Allow\n"], [858, "            Action: bedrock:ApplyGuardrail\n"], [859, "            Resource:\n"], [860, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [861, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [773, 861], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[773, "  SummarizationFunction:\n"], [774, "    Type: AWS::Serverless::Function\n"], [775, "    Metadata:\n"], [776, "      SamResourceId: SummarizationFunction\n"], [777, "      cfn_nag:\n"], [778, "        rules_to_suppress:\n"], [779, "        - id: W11\n"], [780, "          reason: Cloudwatch does not support resource-level permissions\n"], [781, "        - id: W89\n"], [782, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [783, "            with AWS services via AWS APIs\n"], [784, "        - id: W92\n"], [785, "          reason: Function does not require concurrent execution limits as it is designed\n"], [786, "            to scale based on demand\n"], [787, "    Properties:\n"], [788, "      PermissionsBoundary:\n"], [789, "        Fn::If:\n"], [790, "        - HasPermissionsBoundary\n"], [791, "        - Ref: PermissionsBoundaryArn\n"], [792, "        - Ref: AWS::NoValue\n"], [793, "      CodeUri: SummarizationFunction\n"], [794, "      Handler: index.handler\n"], [795, "      Runtime: python3.12\n"], [796, "      Timeout: 900\n"], [797, "      MemorySize: 4096\n"], [798, "      Environment:\n"], [799, "        Variables:\n"], [800, "          METRIC_NAMESPACE:\n"], [801, "            Ref: StackName\n"], [802, "          CONFIGURATION_TABLE_NAME:\n"], [803, "            Ref: ConfigurationTable\n"], [804, "          GUARDRAIL_ID_AND_VERSION:\n"], [805, "            Fn::If:\n"], [806, "            - HasGuardrailConfig\n"], [807, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [808, "            - ''\n"], [809, "          LOG_LEVEL:\n"], [810, "            Ref: LogLevel\n"], [811, "          APPSYNC_API_URL:\n"], [812, "            Ref: AppSyncApiUrl\n"], [813, "          WORKING_BUCKET:\n"], [814, "            Ref: WorkingBucket\n"], [815, "      LoggingConfig:\n"], [816, "        LogGroup:\n"], [817, "          Ref: SummarizationFunctionLogGroup\n"], [818, "      Policies:\n"], [819, "      - AWSLambdaBasicExecutionRole\n"], [820, "      - S3ReadPolicy:\n"], [821, "          BucketName:\n"], [822, "            Ref: InputBucket\n"], [823, "      - S3CrudPolicy:\n"], [824, "          BucketName:\n"], [825, "            Ref: OutputBucket\n"], [826, "      - S3CrudPolicy:\n"], [827, "          BucketName:\n"], [828, "            Ref: WorkingBucket\n"], [829, "      - DynamoDBCrudPolicy:\n"], [830, "          TableName:\n"], [831, "            Ref: ConfigurationTable\n"], [832, "      - Statement:\n"], [833, "        - Effect: Allow\n"], [834, "          Action: cloudwatch:PutMetricData\n"], [835, "          Resource: '*'\n"], [836, "        - Effect: Allow\n"], [837, "          Action:\n"], [838, "          - kms:Encrypt\n"], [839, "          - kms:Decrypt\n"], [840, "          - kms:ReEncrypt*\n"], [841, "          - kms:GenerateDataKey*\n"], [842, "          - kms:DescribeKey\n"], [843, "          Resource:\n"], [844, "            Ref: CustomerManagedEncryptionKeyArn\n"], [845, "        - Effect: Allow\n"], [846, "          Action:\n"], [847, "          - appsync:GraphQL\n"], [848, "          Resource:\n"], [849, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [850, "        - Effect: Allow\n"], [851, "          Action: bedrock:InvokeModel\n"], [852, "          Resource:\n"], [853, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [854, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [855, "        - Fn::If:\n"], [856, "          - HasGuardrailConfig\n"], [857, "          - Effect: Allow\n"], [858, "            Action: bedrock:ApplyGuardrail\n"], [859, "            Resource:\n"], [860, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [861, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [773, 861], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[878, "  BDACompletionFunction:\n"], [879, "    Type: AWS::Serverless::Function\n"], [880, "    Metadata:\n"], [881, "      SamResourceId: BDACompletionFunction\n"], [882, "      cfn_nag:\n"], [883, "        rules_to_suppress:\n"], [884, "        - id: W11\n"], [885, "          reason: Cloudwatch does not support resource-level permissions\n"], [886, "        - id: W89\n"], [887, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [888, "            with AWS services via AWS APIs\n"], [889, "        - id: W92\n"], [890, "          reason: Function does not require concurrent execution limits as it is designed\n"], [891, "            to scale based on demand\n"], [892, "    Properties:\n"], [893, "      PermissionsBoundary:\n"], [894, "        Fn::If:\n"], [895, "        - HasPermissionsBoundary\n"], [896, "        - Ref: PermissionsBoundaryArn\n"], [897, "        - Ref: AWS::NoValue\n"], [898, "      CodeUri: BDACompletionFunction\n"], [899, "      Handler: index.handler\n"], [900, "      Runtime: python3.12\n"], [901, "      Timeout: 900\n"], [902, "      MemorySize: 4096\n"], [903, "      Environment:\n"], [904, "        Variables:\n"], [905, "          TRACKING_TABLE:\n"], [906, "            Ref: TrackingTable\n"], [907, "          METRIC_NAMESPACE:\n"], [908, "            Ref: StackName\n"], [909, "          LOG_LEVEL:\n"], [910, "            Ref: LogLevel\n"], [911, "      DeadLetterQueue:\n"], [912, "        Type: SQS\n"], [913, "        TargetArn:\n"], [914, "          Fn::GetAtt:\n"], [915, "          - BDACompletionFunctionDLQ\n"], [916, "          - Arn\n"], [917, "      LoggingConfig:\n"], [918, "        LogGroup:\n"], [919, "          Ref: BDACompletionFunctionLogGroup\n"], [920, "      Policies:\n"], [921, "      - AWSLambdaBasicExecutionRole\n"], [922, "      - DynamoDBReadPolicy:\n"], [923, "          TableName:\n"], [924, "            Ref: TrackingTable\n"], [925, "      - Statement:\n"], [926, "        - Effect: Allow\n"], [927, "          Action: cloudwatch:PutMetricData\n"], [928, "          Resource: '*'\n"], [929, "        - Effect: Allow\n"], [930, "          Action:\n"], [931, "          - states:SendTaskSuccess\n"], [932, "          - states:SendTaskFailure\n"], [933, "          Resource:\n"], [934, "            Fn::GetAtt:\n"], [935, "            - DocumentProcessingStateMachine\n"], [936, "            - Arn\n"], [937, "        - Effect: Allow\n"], [938, "          Action:\n"], [939, "          - kms:Encrypt\n"], [940, "          - kms:Decrypt\n"], [941, "          - kms:ReEncrypt*\n"], [942, "          - kms:GenerateDataKey*\n"], [943, "          - kms:DescribeKey\n"], [944, "          Resource:\n"], [945, "            Ref: CustomerManagedEncryptionKeyArn\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [878, 945], "resource": "AWS::Serverless::Function.BDACompletionFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[878, "  BDACompletionFunction:\n"], [879, "    Type: AWS::Serverless::Function\n"], [880, "    Metadata:\n"], [881, "      SamResourceId: BDACompletionFunction\n"], [882, "      cfn_nag:\n"], [883, "        rules_to_suppress:\n"], [884, "        - id: W11\n"], [885, "          reason: Cloudwatch does not support resource-level permissions\n"], [886, "        - id: W89\n"], [887, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [888, "            with AWS services via AWS APIs\n"], [889, "        - id: W92\n"], [890, "          reason: Function does not require concurrent execution limits as it is designed\n"], [891, "            to scale based on demand\n"], [892, "    Properties:\n"], [893, "      PermissionsBoundary:\n"], [894, "        Fn::If:\n"], [895, "        - HasPermissionsBoundary\n"], [896, "        - Ref: PermissionsBoundaryArn\n"], [897, "        - Ref: AWS::NoValue\n"], [898, "      CodeUri: BDACompletionFunction\n"], [899, "      Handler: index.handler\n"], [900, "      Runtime: python3.12\n"], [901, "      Timeout: 900\n"], [902, "      MemorySize: 4096\n"], [903, "      Environment:\n"], [904, "        Variables:\n"], [905, "          TRACKING_TABLE:\n"], [906, "            Ref: TrackingTable\n"], [907, "          METRIC_NAMESPACE:\n"], [908, "            Ref: StackName\n"], [909, "          LOG_LEVEL:\n"], [910, "            Ref: LogLevel\n"], [911, "      DeadLetterQueue:\n"], [912, "        Type: SQS\n"], [913, "        TargetArn:\n"], [914, "          Fn::GetAtt:\n"], [915, "          - BDACompletionFunctionDLQ\n"], [916, "          - Arn\n"], [917, "      LoggingConfig:\n"], [918, "        LogGroup:\n"], [919, "          Ref: BDACompletionFunctionLogGroup\n"], [920, "      Policies:\n"], [921, "      - AWSLambdaBasicExecutionRole\n"], [922, "      - DynamoDBReadPolicy:\n"], [923, "          TableName:\n"], [924, "            Ref: TrackingTable\n"], [925, "      - Statement:\n"], [926, "        - Effect: Allow\n"], [927, "          Action: cloudwatch:PutMetricData\n"], [928, "          Resource: '*'\n"], [929, "        - Effect: Allow\n"], [930, "          Action:\n"], [931, "          - states:SendTaskSuccess\n"], [932, "          - states:SendTaskFailure\n"], [933, "          Resource:\n"], [934, "            Fn::GetAtt:\n"], [935, "            - DocumentProcessingStateMachine\n"], [936, "            - Arn\n"], [937, "        - Effect: Allow\n"], [938, "          Action:\n"], [939, "          - kms:Encrypt\n"], [940, "          - kms:Decrypt\n"], [941, "          - kms:ReEncrypt*\n"], [942, "          - kms:GenerateDataKey*\n"], [943, "          - kms:DescribeKey\n"], [944, "          Resource:\n"], [945, "            Ref: CustomerManagedEncryptionKeyArn\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [878, 945], "resource": "AWS::Serverless::Function.BDACompletionFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[878, "  BDACompletionFunction:\n"], [879, "    Type: AWS::Serverless::Function\n"], [880, "    Metadata:\n"], [881, "      SamResourceId: BDACompletionFunction\n"], [882, "      cfn_nag:\n"], [883, "        rules_to_suppress:\n"], [884, "        - id: W11\n"], [885, "          reason: Cloudwatch does not support resource-level permissions\n"], [886, "        - id: W89\n"], [887, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [888, "            with AWS services via AWS APIs\n"], [889, "        - id: W92\n"], [890, "          reason: Function does not require concurrent execution limits as it is designed\n"], [891, "            to scale based on demand\n"], [892, "    Properties:\n"], [893, "      PermissionsBoundary:\n"], [894, "        Fn::If:\n"], [895, "        - HasPermissionsBoundary\n"], [896, "        - Ref: PermissionsBoundaryArn\n"], [897, "        - Ref: AWS::NoValue\n"], [898, "      CodeUri: BDACompletionFunction\n"], [899, "      Handler: index.handler\n"], [900, "      Runtime: python3.12\n"], [901, "      Timeout: 900\n"], [902, "      MemorySize: 4096\n"], [903, "      Environment:\n"], [904, "        Variables:\n"], [905, "          TRACKING_TABLE:\n"], [906, "            Ref: TrackingTable\n"], [907, "          METRIC_NAMESPACE:\n"], [908, "            Ref: StackName\n"], [909, "          LOG_LEVEL:\n"], [910, "            Ref: LogLevel\n"], [911, "      DeadLetterQueue:\n"], [912, "        Type: SQS\n"], [913, "        TargetArn:\n"], [914, "          Fn::GetAtt:\n"], [915, "          - BDACompletionFunctionDLQ\n"], [916, "          - Arn\n"], [917, "      LoggingConfig:\n"], [918, "        LogGroup:\n"], [919, "          Ref: BDACompletionFunctionLogGroup\n"], [920, "      Policies:\n"], [921, "      - AWSLambdaBasicExecutionRole\n"], [922, "      - DynamoDBReadPolicy:\n"], [923, "          TableName:\n"], [924, "            Ref: TrackingTable\n"], [925, "      - Statement:\n"], [926, "        - Effect: Allow\n"], [927, "          Action: cloudwatch:PutMetricData\n"], [928, "          Resource: '*'\n"], [929, "        - Effect: Allow\n"], [930, "          Action:\n"], [931, "          - states:SendTaskSuccess\n"], [932, "          - states:SendTaskFailure\n"], [933, "          Resource:\n"], [934, "            Fn::GetAtt:\n"], [935, "            - DocumentProcessingStateMachine\n"], [936, "            - Arn\n"], [937, "        - Effect: Allow\n"], [938, "          Action:\n"], [939, "          - kms:Encrypt\n"], [940, "          - kms:Decrypt\n"], [941, "          - kms:ReEncrypt*\n"], [942, "          - kms:GenerateDataKey*\n"], [943, "          - kms:DescribeKey\n"], [944, "          Resource:\n"], [945, "            Ref: CustomerManagedEncryptionKeyArn\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [878, 945], "resource": "AWS::Serverless::Function.BDACompletionFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[1037, "  HITLProcessLambdaFunction:\n"], [1038, "    Type: AWS::Serverless::Function\n"], [1039, "    Metadata:\n"], [1040, "      SamResourceId: HITLProcessLambdaFunction\n"], [1041, "      cfn_nag:\n"], [1042, "        rules_to_suppress:\n"], [1043, "        - id: W89\n"], [1044, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [1045, "            services via APIs\n"], [1046, "        - id: W92\n"], [1047, "          reason: Function does not require reserved concurrency as it scales based\n"], [1048, "            on demand\n"], [1049, "    Properties:\n"], [1050, "      PermissionsBoundary:\n"], [1051, "        Fn::If:\n"], [1052, "        - HasPermissionsBoundary\n"], [1053, "        - Ref: PermissionsBoundaryArn\n"], [1054, "        - Ref: AWS::NoValue\n"], [1055, "      Handler: index.lambda_handler\n"], [1056, "      LoggingConfig:\n"], [1057, "        LogGroup:\n"], [1058, "          Ref: HITLProcessLambdaLogGroup\n"], [1059, "      Runtime: python3.12\n"], [1060, "      Timeout: 300\n"], [1061, "      CodeUri: HITLProcessLambdaFunction\n"], [1062, "      Role:\n"], [1063, "        Fn::GetAtt:\n"], [1064, "        - HITLProcessLambdaRole\n"], [1065, "        - Arn\n"], [1066, "      Environment:\n"], [1067, "        Variables:\n"], [1068, "          DYNAMODB_TABLE:\n"], [1069, "            Ref: BDAMetadataTable\n"], [1070, "          TRACKING_TABLE:\n"], [1071, "            Ref: TrackingTable\n"], [1072, "          LOG_LEVEL:\n"], [1073, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1037, 1073], "resource": "AWS::Serverless::Function.HITLProcessLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[1037, "  HITLProcessLambdaFunction:\n"], [1038, "    Type: AWS::Serverless::Function\n"], [1039, "    Metadata:\n"], [1040, "      SamResourceId: HITLProcessLambdaFunction\n"], [1041, "      cfn_nag:\n"], [1042, "        rules_to_suppress:\n"], [1043, "        - id: W89\n"], [1044, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [1045, "            services via APIs\n"], [1046, "        - id: W92\n"], [1047, "          reason: Function does not require reserved concurrency as it scales based\n"], [1048, "            on demand\n"], [1049, "    Properties:\n"], [1050, "      PermissionsBoundary:\n"], [1051, "        Fn::If:\n"], [1052, "        - HasPermissionsBoundary\n"], [1053, "        - Ref: PermissionsBoundaryArn\n"], [1054, "        - Ref: AWS::NoValue\n"], [1055, "      Handler: index.lambda_handler\n"], [1056, "      LoggingConfig:\n"], [1057, "        LogGroup:\n"], [1058, "          Ref: HITLProcessLambdaLogGroup\n"], [1059, "      Runtime: python3.12\n"], [1060, "      Timeout: 300\n"], [1061, "      CodeUri: HITLProcessLambdaFunction\n"], [1062, "      Role:\n"], [1063, "        Fn::GetAtt:\n"], [1064, "        - HITLProcessLambdaRole\n"], [1065, "        - Arn\n"], [1066, "      Environment:\n"], [1067, "        Variables:\n"], [1068, "          DYNAMODB_TABLE:\n"], [1069, "            Ref: BDAMetadataTable\n"], [1070, "          TRACKING_TABLE:\n"], [1071, "            Ref: TrackingTable\n"], [1072, "          LOG_LEVEL:\n"], [1073, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1037, 1073], "resource": "AWS::Serverless::Function.HITLProcessLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[1037, "  HITLProcessLambdaFunction:\n"], [1038, "    Type: AWS::Serverless::Function\n"], [1039, "    Metadata:\n"], [1040, "      SamResourceId: HITLProcessLambdaFunction\n"], [1041, "      cfn_nag:\n"], [1042, "        rules_to_suppress:\n"], [1043, "        - id: W89\n"], [1044, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [1045, "            services via APIs\n"], [1046, "        - id: W92\n"], [1047, "          reason: Function does not require reserved concurrency as it scales based\n"], [1048, "            on demand\n"], [1049, "    Properties:\n"], [1050, "      PermissionsBoundary:\n"], [1051, "        Fn::If:\n"], [1052, "        - HasPermissionsBoundary\n"], [1053, "        - Ref: PermissionsBoundaryArn\n"], [1054, "        - Ref: AWS::NoValue\n"], [1055, "      Handler: index.lambda_handler\n"], [1056, "      LoggingConfig:\n"], [1057, "        LogGroup:\n"], [1058, "          Ref: HITLProcessLambdaLogGroup\n"], [1059, "      Runtime: python3.12\n"], [1060, "      Timeout: 300\n"], [1061, "      CodeUri: HITLProcessLambdaFunction\n"], [1062, "      Role:\n"], [1063, "        Fn::GetAtt:\n"], [1064, "        - HITLProcessLambdaRole\n"], [1065, "        - Arn\n"], [1066, "      Environment:\n"], [1067, "        Variables:\n"], [1068, "          DYNAMODB_TABLE:\n"], [1069, "            Ref: BDAMetadataTable\n"], [1070, "          TRACKING_TABLE:\n"], [1071, "            Ref: TrackingTable\n"], [1072, "          LOG_LEVEL:\n"], [1073, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1037, 1073], "resource": "AWS::Serverless::Function.HITLProcessLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[1037, "  HITLProcessLambdaFunction:\n"], [1038, "    Type: AWS::Serverless::Function\n"], [1039, "    Metadata:\n"], [1040, "      SamResourceId: HITLProcessLambdaFunction\n"], [1041, "      cfn_nag:\n"], [1042, "        rules_to_suppress:\n"], [1043, "        - id: W89\n"], [1044, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [1045, "            services via APIs\n"], [1046, "        - id: W92\n"], [1047, "          reason: Function does not require reserved concurrency as it scales based\n"], [1048, "            on demand\n"], [1049, "    Properties:\n"], [1050, "      PermissionsBoundary:\n"], [1051, "        Fn::If:\n"], [1052, "        - HasPermissionsBoundary\n"], [1053, "        - Ref: PermissionsBoundaryArn\n"], [1054, "        - Ref: AWS::NoValue\n"], [1055, "      Handler: index.lambda_handler\n"], [1056, "      LoggingConfig:\n"], [1057, "        LogGroup:\n"], [1058, "          Ref: HITLProcessLambdaLogGroup\n"], [1059, "      Runtime: python3.12\n"], [1060, "      Timeout: 300\n"], [1061, "      CodeUri: HITLProcessLambdaFunction\n"], [1062, "      Role:\n"], [1063, "        Fn::GetAtt:\n"], [1064, "        - HITLProcessLambdaRole\n"], [1065, "        - Arn\n"], [1066, "      Environment:\n"], [1067, "        Variables:\n"], [1068, "          DYNAMODB_TABLE:\n"], [1069, "            Ref: BDAMetadataTable\n"], [1070, "          TRACKING_TABLE:\n"], [1071, "            Ref: TrackingTable\n"], [1072, "          LOG_LEVEL:\n"], [1073, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1037, 1073], "resource": "AWS::Serverless::Function.HITLProcessLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[1153, "  HITLWaitFunction:\n"], [1154, "    Type: AWS::Serverless::Function\n"], [1155, "    Metadata:\n"], [1156, "      SamResourceId: HITLWaitFunction\n"], [1157, "      cfn_nag:\n"], [1158, "        rules_to_suppress:\n"], [1159, "        - id: W11\n"], [1160, "          reason: Cloudwatch does not support resource-level permissions\n"], [1161, "        - id: W89\n"], [1162, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1163, "            with AWS services via AWS APIs\n"], [1164, "        - id: W92\n"], [1165, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1166, "            to scale based on demand\n"], [1167, "    Properties:\n"], [1168, "      PermissionsBoundary:\n"], [1169, "        Fn::If:\n"], [1170, "        - HasPermissionsBoundary\n"], [1171, "        - Ref: PermissionsBoundaryArn\n"], [1172, "        - Ref: AWS::NoValue\n"], [1173, "      CodeUri: HITLWaitFunction\n"], [1174, "      Handler: index.lambda_handler\n"], [1175, "      Runtime: python3.12\n"], [1176, "      Timeout: 60\n"], [1177, "      MemorySize: 256\n"], [1178, "      Environment:\n"], [1179, "        Variables:\n"], [1180, "          TRACKING_TABLE:\n"], [1181, "            Ref: TrackingTable\n"], [1182, "          DYNAMODB_TABLE:\n"], [1183, "            Ref: BDAMetadataTable\n"], [1184, "          LOG_LEVEL:\n"], [1185, "            Ref: LogLevel\n"], [1186, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [1187, "            Ref: SageMakerA2IReviewPortalURL\n"], [1188, "          WORKING_BUCKET:\n"], [1189, "            Ref: WorkingBucket\n"], [1190, "      LoggingConfig:\n"], [1191, "        LogGroup:\n"], [1192, "          Ref: HITLWaitFunctionLogGroup\n"], [1193, "      Policies:\n"], [1194, "      - AWSLambdaBasicExecutionRole\n"], [1195, "      - DynamoDBCrudPolicy:\n"], [1196, "          TableName:\n"], [1197, "            Ref: TrackingTable\n"], [1198, "      - DynamoDBCrudPolicy:\n"], [1199, "          TableName:\n"], [1200, "            Ref: BDAMetadataTable\n"], [1201, "      - S3ReadPolicy:\n"], [1202, "          BucketName:\n"], [1203, "            Ref: WorkingBucket\n"], [1204, "      - Statement:\n"], [1205, "        - Effect: Allow\n"], [1206, "          Action:\n"], [1207, "          - kms:Decrypt\n"], [1208, "          Resource:\n"], [1209, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1210, "        - Effect: Allow\n"], [1211, "          Action: cloudwatch:PutMetricData\n"], [1212, "          Resource: '*'\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1153, 1212], "resource": "AWS::Serverless::Function.HITLWaitFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[1153, "  HITLWaitFunction:\n"], [1154, "    Type: AWS::Serverless::Function\n"], [1155, "    Metadata:\n"], [1156, "      SamResourceId: HITLWaitFunction\n"], [1157, "      cfn_nag:\n"], [1158, "        rules_to_suppress:\n"], [1159, "        - id: W11\n"], [1160, "          reason: Cloudwatch does not support resource-level permissions\n"], [1161, "        - id: W89\n"], [1162, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1163, "            with AWS services via AWS APIs\n"], [1164, "        - id: W92\n"], [1165, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1166, "            to scale based on demand\n"], [1167, "    Properties:\n"], [1168, "      PermissionsBoundary:\n"], [1169, "        Fn::If:\n"], [1170, "        - HasPermissionsBoundary\n"], [1171, "        - Ref: PermissionsBoundaryArn\n"], [1172, "        - Ref: AWS::NoValue\n"], [1173, "      CodeUri: HITLWaitFunction\n"], [1174, "      Handler: index.lambda_handler\n"], [1175, "      Runtime: python3.12\n"], [1176, "      Timeout: 60\n"], [1177, "      MemorySize: 256\n"], [1178, "      Environment:\n"], [1179, "        Variables:\n"], [1180, "          TRACKING_TABLE:\n"], [1181, "            Ref: TrackingTable\n"], [1182, "          DYNAMODB_TABLE:\n"], [1183, "            Ref: BDAMetadataTable\n"], [1184, "          LOG_LEVEL:\n"], [1185, "            Ref: LogLevel\n"], [1186, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [1187, "            Ref: SageMakerA2IReviewPortalURL\n"], [1188, "          WORKING_BUCKET:\n"], [1189, "            Ref: WorkingBucket\n"], [1190, "      LoggingConfig:\n"], [1191, "        LogGroup:\n"], [1192, "          Ref: HITLWaitFunctionLogGroup\n"], [1193, "      Policies:\n"], [1194, "      - AWSLambdaBasicExecutionRole\n"], [1195, "      - DynamoDBCrudPolicy:\n"], [1196, "          TableName:\n"], [1197, "            Ref: TrackingTable\n"], [1198, "      - DynamoDBCrudPolicy:\n"], [1199, "          TableName:\n"], [1200, "            Ref: BDAMetadataTable\n"], [1201, "      - S3ReadPolicy:\n"], [1202, "          BucketName:\n"], [1203, "            Ref: WorkingBucket\n"], [1204, "      - Statement:\n"], [1205, "        - Effect: Allow\n"], [1206, "          Action:\n"], [1207, "          - kms:Decrypt\n"], [1208, "          Resource:\n"], [1209, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1210, "        - Effect: Allow\n"], [1211, "          Action: cloudwatch:PutMetricData\n"], [1212, "          Resource: '*'\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1153, 1212], "resource": "AWS::Serverless::Function.HITLWaitFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[1153, "  HITLWaitFunction:\n"], [1154, "    Type: AWS::Serverless::Function\n"], [1155, "    Metadata:\n"], [1156, "      SamResourceId: HITLWaitFunction\n"], [1157, "      cfn_nag:\n"], [1158, "        rules_to_suppress:\n"], [1159, "        - id: W11\n"], [1160, "          reason: Cloudwatch does not support resource-level permissions\n"], [1161, "        - id: W89\n"], [1162, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1163, "            with AWS services via AWS APIs\n"], [1164, "        - id: W92\n"], [1165, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1166, "            to scale based on demand\n"], [1167, "    Properties:\n"], [1168, "      PermissionsBoundary:\n"], [1169, "        Fn::If:\n"], [1170, "        - HasPermissionsBoundary\n"], [1171, "        - Ref: PermissionsBoundaryArn\n"], [1172, "        - Ref: AWS::NoValue\n"], [1173, "      CodeUri: HITLWaitFunction\n"], [1174, "      Handler: index.lambda_handler\n"], [1175, "      Runtime: python3.12\n"], [1176, "      Timeout: 60\n"], [1177, "      MemorySize: 256\n"], [1178, "      Environment:\n"], [1179, "        Variables:\n"], [1180, "          TRACKING_TABLE:\n"], [1181, "            Ref: TrackingTable\n"], [1182, "          DYNAMODB_TABLE:\n"], [1183, "            Ref: BDAMetadataTable\n"], [1184, "          LOG_LEVEL:\n"], [1185, "            Ref: LogLevel\n"], [1186, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [1187, "            Ref: SageMakerA2IReviewPortalURL\n"], [1188, "          WORKING_BUCKET:\n"], [1189, "            Ref: WorkingBucket\n"], [1190, "      LoggingConfig:\n"], [1191, "        LogGroup:\n"], [1192, "          Ref: HITLWaitFunctionLogGroup\n"], [1193, "      Policies:\n"], [1194, "      - AWSLambdaBasicExecutionRole\n"], [1195, "      - DynamoDBCrudPolicy:\n"], [1196, "          TableName:\n"], [1197, "            Ref: TrackingTable\n"], [1198, "      - DynamoDBCrudPolicy:\n"], [1199, "          TableName:\n"], [1200, "            Ref: BDAMetadataTable\n"], [1201, "      - S3ReadPolicy:\n"], [1202, "          BucketName:\n"], [1203, "            Ref: WorkingBucket\n"], [1204, "      - Statement:\n"], [1205, "        - Effect: Allow\n"], [1206, "          Action:\n"], [1207, "          - kms:Decrypt\n"], [1208, "          Resource:\n"], [1209, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1210, "        - Effect: Allow\n"], [1211, "          Action: cloudwatch:PutMetricData\n"], [1212, "          Resource: '*'\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1153, 1212], "resource": "AWS::Serverless::Function.HITLWaitFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[1153, "  HITLWaitFunction:\n"], [1154, "    Type: AWS::Serverless::Function\n"], [1155, "    Metadata:\n"], [1156, "      SamResourceId: HITLWaitFunction\n"], [1157, "      cfn_nag:\n"], [1158, "        rules_to_suppress:\n"], [1159, "        - id: W11\n"], [1160, "          reason: Cloudwatch does not support resource-level permissions\n"], [1161, "        - id: W89\n"], [1162, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1163, "            with AWS services via AWS APIs\n"], [1164, "        - id: W92\n"], [1165, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1166, "            to scale based on demand\n"], [1167, "    Properties:\n"], [1168, "      PermissionsBoundary:\n"], [1169, "        Fn::If:\n"], [1170, "        - HasPermissionsBoundary\n"], [1171, "        - Ref: PermissionsBoundaryArn\n"], [1172, "        - Ref: AWS::NoValue\n"], [1173, "      CodeUri: HITLWaitFunction\n"], [1174, "      Handler: index.lambda_handler\n"], [1175, "      Runtime: python3.12\n"], [1176, "      Timeout: 60\n"], [1177, "      MemorySize: 256\n"], [1178, "      Environment:\n"], [1179, "        Variables:\n"], [1180, "          TRACKING_TABLE:\n"], [1181, "            Ref: TrackingTable\n"], [1182, "          DYNAMODB_TABLE:\n"], [1183, "            Ref: BDAMetadataTable\n"], [1184, "          LOG_LEVEL:\n"], [1185, "            Ref: LogLevel\n"], [1186, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [1187, "            Ref: SageMakerA2IReviewPortalURL\n"], [1188, "          WORKING_BUCKET:\n"], [1189, "            Ref: WorkingBucket\n"], [1190, "      LoggingConfig:\n"], [1191, "        LogGroup:\n"], [1192, "          Ref: HITLWaitFunctionLogGroup\n"], [1193, "      Policies:\n"], [1194, "      - AWSLambdaBasicExecutionRole\n"], [1195, "      - DynamoDBCrudPolicy:\n"], [1196, "          TableName:\n"], [1197, "            Ref: TrackingTable\n"], [1198, "      - DynamoDBCrudPolicy:\n"], [1199, "          TableName:\n"], [1200, "            Ref: BDAMetadataTable\n"], [1201, "      - S3ReadPolicy:\n"], [1202, "          BucketName:\n"], [1203, "            Ref: WorkingBucket\n"], [1204, "      - Statement:\n"], [1205, "        - Effect: Allow\n"], [1206, "          Action:\n"], [1207, "          - kms:Decrypt\n"], [1208, "          Resource:\n"], [1209, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1210, "        - Effect: Allow\n"], [1211, "          Action: cloudwatch:PutMetricData\n"], [1212, "          Resource: '*'\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1153, 1212], "resource": "AWS::Serverless::Function.HITLWaitFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[1222, "  HITLStatusUpdateFunction:\n"], [1223, "    Type: AWS::Serverless::Function\n"], [1224, "    Metadata:\n"], [1225, "      SamResourceId: HITLStatusUpdateFunction\n"], [1226, "      cfn_nag:\n"], [1227, "        rules_to_suppress:\n"], [1228, "        - id: W11\n"], [1229, "          reason: Cloudwatch does not support resource-level permissions\n"], [1230, "        - id: W89\n"], [1231, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1232, "            with AWS services via AWS APIs\n"], [1233, "        - id: W92\n"], [1234, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1235, "            to scale based on demand\n"], [1236, "        - id: W58\n"], [1237, "          reason: DLQ not required for EventBridge triggered function as it handles\n"], [1238, "            A2I status updates\n"], [1239, "    Properties:\n"], [1240, "      PermissionsBoundary:\n"], [1241, "        Fn::If:\n"], [1242, "        - HasPermissionsBoundary\n"], [1243, "        - Ref: PermissionsBoundaryArn\n"], [1244, "        - Ref: AWS::NoValue\n"], [1245, "      CodeUri: HITLStatusUpdateFunction\n"], [1246, "      Handler: index.handler\n"], [1247, "      Runtime: python3.12\n"], [1248, "      Timeout: 300\n"], [1249, "      MemorySize: 512\n"], [1250, "      Environment:\n"], [1251, "        Variables:\n"], [1252, "          LOG_LEVEL:\n"], [1253, "            Ref: LogLevel\n"], [1254, "          WORKING_BUCKET:\n"], [1255, "            Ref: WorkingBucket\n"], [1256, "      LoggingConfig:\n"], [1257, "        LogGroup:\n"], [1258, "          Ref: HITLStatusUpdateFunctionLogGroup\n"], [1259, "      Policies:\n"], [1260, "      - AWSLambdaBasicExecutionRole\n"], [1261, "      - S3CrudPolicy:\n"], [1262, "          BucketName:\n"], [1263, "            Ref: WorkingBucket\n"], [1264, "      - Statement:\n"], [1265, "        - Effect: Allow\n"], [1266, "          Action:\n"], [1267, "          - kms:Encrypt\n"], [1268, "          - kms:Decrypt\n"], [1269, "          - kms:ReEncrypt*\n"], [1270, "          - kms:GenerateDataKey*\n"], [1271, "          - kms:DescribeKey\n"], [1272, "          Resource:\n"], [1273, "            Ref: CustomerManagedEncryptionKeyArn\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1222, 1273], "resource": "AWS::Serverless::Function.HITLStatusUpdateFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[1222, "  HITLStatusUpdateFunction:\n"], [1223, "    Type: AWS::Serverless::Function\n"], [1224, "    Metadata:\n"], [1225, "      SamResourceId: HITLStatusUpdateFunction\n"], [1226, "      cfn_nag:\n"], [1227, "        rules_to_suppress:\n"], [1228, "        - id: W11\n"], [1229, "          reason: Cloudwatch does not support resource-level permissions\n"], [1230, "        - id: W89\n"], [1231, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1232, "            with AWS services via AWS APIs\n"], [1233, "        - id: W92\n"], [1234, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1235, "            to scale based on demand\n"], [1236, "        - id: W58\n"], [1237, "          reason: DLQ not required for EventBridge triggered function as it handles\n"], [1238, "            A2I status updates\n"], [1239, "    Properties:\n"], [1240, "      PermissionsBoundary:\n"], [1241, "        Fn::If:\n"], [1242, "        - HasPermissionsBoundary\n"], [1243, "        - Ref: PermissionsBoundaryArn\n"], [1244, "        - Ref: AWS::NoValue\n"], [1245, "      CodeUri: HITLStatusUpdateFunction\n"], [1246, "      Handler: index.handler\n"], [1247, "      Runtime: python3.12\n"], [1248, "      Timeout: 300\n"], [1249, "      MemorySize: 512\n"], [1250, "      Environment:\n"], [1251, "        Variables:\n"], [1252, "          LOG_LEVEL:\n"], [1253, "            Ref: LogLevel\n"], [1254, "          WORKING_BUCKET:\n"], [1255, "            Ref: WorkingBucket\n"], [1256, "      LoggingConfig:\n"], [1257, "        LogGroup:\n"], [1258, "          Ref: HITLStatusUpdateFunctionLogGroup\n"], [1259, "      Policies:\n"], [1260, "      - AWSLambdaBasicExecutionRole\n"], [1261, "      - S3CrudPolicy:\n"], [1262, "          BucketName:\n"], [1263, "            Ref: WorkingBucket\n"], [1264, "      - Statement:\n"], [1265, "        - Effect: Allow\n"], [1266, "          Action:\n"], [1267, "          - kms:Encrypt\n"], [1268, "          - kms:Decrypt\n"], [1269, "          - kms:ReEncrypt*\n"], [1270, "          - kms:GenerateDataKey*\n"], [1271, "          - kms:DescribeKey\n"], [1272, "          Resource:\n"], [1273, "            Ref: CustomerManagedEncryptionKeyArn\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1222, 1273], "resource": "AWS::Serverless::Function.HITLStatusUpdateFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[1222, "  HITLStatusUpdateFunction:\n"], [1223, "    Type: AWS::Serverless::Function\n"], [1224, "    Metadata:\n"], [1225, "      SamResourceId: HITLStatusUpdateFunction\n"], [1226, "      cfn_nag:\n"], [1227, "        rules_to_suppress:\n"], [1228, "        - id: W11\n"], [1229, "          reason: Cloudwatch does not support resource-level permissions\n"], [1230, "        - id: W89\n"], [1231, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1232, "            with AWS services via AWS APIs\n"], [1233, "        - id: W92\n"], [1234, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1235, "            to scale based on demand\n"], [1236, "        - id: W58\n"], [1237, "          reason: DLQ not required for EventBridge triggered function as it handles\n"], [1238, "            A2I status updates\n"], [1239, "    Properties:\n"], [1240, "      PermissionsBoundary:\n"], [1241, "        Fn::If:\n"], [1242, "        - HasPermissionsBoundary\n"], [1243, "        - Ref: PermissionsBoundaryArn\n"], [1244, "        - Ref: AWS::NoValue\n"], [1245, "      CodeUri: HITLStatusUpdateFunction\n"], [1246, "      Handler: index.handler\n"], [1247, "      Runtime: python3.12\n"], [1248, "      Timeout: 300\n"], [1249, "      MemorySize: 512\n"], [1250, "      Environment:\n"], [1251, "        Variables:\n"], [1252, "          LOG_LEVEL:\n"], [1253, "            Ref: LogLevel\n"], [1254, "          WORKING_BUCKET:\n"], [1255, "            Ref: WorkingBucket\n"], [1256, "      LoggingConfig:\n"], [1257, "        LogGroup:\n"], [1258, "          Ref: HITLStatusUpdateFunctionLogGroup\n"], [1259, "      Policies:\n"], [1260, "      - AWSLambdaBasicExecutionRole\n"], [1261, "      - S3CrudPolicy:\n"], [1262, "          BucketName:\n"], [1263, "            Ref: WorkingBucket\n"], [1264, "      - Statement:\n"], [1265, "        - Effect: Allow\n"], [1266, "          Action:\n"], [1267, "          - kms:Encrypt\n"], [1268, "          - kms:Decrypt\n"], [1269, "          - kms:ReEncrypt*\n"], [1270, "          - kms:GenerateDataKey*\n"], [1271, "          - kms:DescribeKey\n"], [1272, "          Resource:\n"], [1273, "            Ref: CustomerManagedEncryptionKeyArn\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1222, 1273], "resource": "AWS::Serverless::Function.HITLStatusUpdateFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[1222, "  HITLStatusUpdateFunction:\n"], [1223, "    Type: AWS::Serverless::Function\n"], [1224, "    Metadata:\n"], [1225, "      SamResourceId: HITLStatusUpdateFunction\n"], [1226, "      cfn_nag:\n"], [1227, "        rules_to_suppress:\n"], [1228, "        - id: W11\n"], [1229, "          reason: Cloudwatch does not support resource-level permissions\n"], [1230, "        - id: W89\n"], [1231, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1232, "            with AWS services via AWS APIs\n"], [1233, "        - id: W92\n"], [1234, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1235, "            to scale based on demand\n"], [1236, "        - id: W58\n"], [1237, "          reason: DLQ not required for EventBridge triggered function as it handles\n"], [1238, "            A2I status updates\n"], [1239, "    Properties:\n"], [1240, "      PermissionsBoundary:\n"], [1241, "        Fn::If:\n"], [1242, "        - HasPermissionsBoundary\n"], [1243, "        - Ref: PermissionsBoundaryArn\n"], [1244, "        - Ref: AWS::NoValue\n"], [1245, "      CodeUri: HITLStatusUpdateFunction\n"], [1246, "      Handler: index.handler\n"], [1247, "      Runtime: python3.12\n"], [1248, "      Timeout: 300\n"], [1249, "      MemorySize: 512\n"], [1250, "      Environment:\n"], [1251, "        Variables:\n"], [1252, "          LOG_LEVEL:\n"], [1253, "            Ref: LogLevel\n"], [1254, "          WORKING_BUCKET:\n"], [1255, "            Ref: WorkingBucket\n"], [1256, "      LoggingConfig:\n"], [1257, "        LogGroup:\n"], [1258, "          Ref: HITLStatusUpdateFunctionLogGroup\n"], [1259, "      Policies:\n"], [1260, "      - AWSLambdaBasicExecutionRole\n"], [1261, "      - S3CrudPolicy:\n"], [1262, "          BucketName:\n"], [1263, "            Ref: WorkingBucket\n"], [1264, "      - Statement:\n"], [1265, "        - Effect: Allow\n"], [1266, "          Action:\n"], [1267, "          - kms:Encrypt\n"], [1268, "          - kms:Decrypt\n"], [1269, "          - kms:ReEncrypt*\n"], [1270, "          - kms:GenerateDataKey*\n"], [1271, "          - kms:DescribeKey\n"], [1272, "          Resource:\n"], [1273, "            Ref: CustomerManagedEncryptionKeyArn\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1222, 1273], "resource": "AWS::Serverless::Function.HITLStatusUpdateFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}]}, "summary": {"passed": 45, "failed": 27, "skipped": 0, "parsing_errors": 0, "resource_count": 26, "checkov_version": "3.2.461"}}