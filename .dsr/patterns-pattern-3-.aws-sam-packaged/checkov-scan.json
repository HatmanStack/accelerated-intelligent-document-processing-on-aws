{"check_type": "cloudformation", "results": {"failed_checks": [{"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[858, "  OCRFunction:\n"], [859, "    Type: AWS::Serverless::Function\n"], [860, "    Metadata:\n"], [861, "      SamResourceId: OCRFunction\n"], [862, "      cfn_nag:\n"], [863, "        rules_to_suppress:\n"], [864, "        - id: W11\n"], [865, "          reason: Textract DetectDocumentText API and CloudWatch APIs do not support\n"], [866, "            resource-level permissions\n"], [867, "        - id: W89\n"], [868, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [869, "            with AWS services via AWS APIs\n"], [870, "        - id: W92\n"], [871, "          reason: Function does not require concurrent execution limits as it is designed\n"], [872, "            to scale based on demand\n"], [873, "    Properties:\n"], [874, "      PermissionsBoundary:\n"], [875, "        Fn::If:\n"], [876, "        - HasPermissionsBoundary\n"], [877, "        - Ref: PermissionsBoundaryArn\n"], [878, "        - Ref: AWS::NoValue\n"], [879, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/efce21da1a36a0910f962e5d62217520\n"], [880, "      Handler: index.handler\n"], [881, "      Runtime: python3.12\n"], [882, "      Timeout: 900\n"], [883, "      MemorySize: 4096\n"], [884, "      Environment:\n"], [885, "        Variables:\n"], [886, "          METRIC_NAMESPACE:\n"], [887, "            Ref: StackName\n"], [888, "          MAX_WORKERS: 20\n"], [889, "          CONFIGURATION_TABLE_NAME:\n"], [890, "            Ref: ConfigurationTable\n"], [891, "          LOG_LEVEL:\n"], [892, "            Ref: LogLevel\n"], [893, "          APPSYNC_API_URL:\n"], [894, "            Ref: AppSyncApiUrl\n"], [895, "          WORKING_BUCKET:\n"], [896, "            Ref: WorkingBucket\n"], [897, "      LoggingConfig:\n"], [898, "        LogGroup:\n"], [899, "          Ref: OCRFunctionLogGroup\n"], [900, "      Policies:\n"], [901, "      - AWSLambdaBasicExecutionRole\n"], [902, "      - S3CrudPolicy:\n"], [903, "          BucketName:\n"], [904, "            Ref: OutputBucket\n"], [905, "      - S3CrudPolicy:\n"], [906, "          BucketName:\n"], [907, "            Ref: WorkingBucket\n"], [908, "      - S3ReadPolicy:\n"], [909, "          BucketName:\n"], [910, "            Ref: InputBucket\n"], [911, "      - DynamoDBCrudPolicy:\n"], [912, "          TableName:\n"], [913, "            Ref: ConfigurationTable\n"], [914, "      - Statement:\n"], [915, "        - Effect: Allow\n"], [916, "          Action: cloudwatch:PutMetricData\n"], [917, "          Resource: '*'\n"], [918, "        - Effect: Allow\n"], [919, "          Action:\n"], [920, "          - kms:Encrypt\n"], [921, "          - kms:Decrypt\n"], [922, "          - kms:ReEncrypt*\n"], [923, "          - kms:GenerateDataKey*\n"], [924, "          - kms:DescribeKey\n"], [925, "          Resource:\n"], [926, "            Ref: CustomerManagedEncryptionKeyArn\n"], [927, "        - Effect: Allow\n"], [928, "          Action:\n"], [929, "          - textract:DetectDocumentText\n"], [930, "          - textract:AnalyzeDocument\n"], [931, "          Resource: '*'\n"], [932, "        - Effect: Allow\n"], [933, "          Action:\n"], [934, "          - appsync:GraphQL\n"], [935, "          Resource:\n"], [936, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [858, 936], "resource": "AWS::Serverless::Function.OCRFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[858, "  OCRFunction:\n"], [859, "    Type: AWS::Serverless::Function\n"], [860, "    Metadata:\n"], [861, "      SamResourceId: OCRFunction\n"], [862, "      cfn_nag:\n"], [863, "        rules_to_suppress:\n"], [864, "        - id: W11\n"], [865, "          reason: Textract DetectDocumentText API and CloudWatch APIs do not support\n"], [866, "            resource-level permissions\n"], [867, "        - id: W89\n"], [868, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [869, "            with AWS services via AWS APIs\n"], [870, "        - id: W92\n"], [871, "          reason: Function does not require concurrent execution limits as it is designed\n"], [872, "            to scale based on demand\n"], [873, "    Properties:\n"], [874, "      PermissionsBoundary:\n"], [875, "        Fn::If:\n"], [876, "        - HasPermissionsBoundary\n"], [877, "        - Ref: PermissionsBoundaryArn\n"], [878, "        - Ref: AWS::NoValue\n"], [879, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/efce21da1a36a0910f962e5d62217520\n"], [880, "      Handler: index.handler\n"], [881, "      Runtime: python3.12\n"], [882, "      Timeout: 900\n"], [883, "      MemorySize: 4096\n"], [884, "      Environment:\n"], [885, "        Variables:\n"], [886, "          METRIC_NAMESPACE:\n"], [887, "            Ref: StackName\n"], [888, "          MAX_WORKERS: 20\n"], [889, "          CONFIGURATION_TABLE_NAME:\n"], [890, "            Ref: ConfigurationTable\n"], [891, "          LOG_LEVEL:\n"], [892, "            Ref: LogLevel\n"], [893, "          APPSYNC_API_URL:\n"], [894, "            Ref: AppSyncApiUrl\n"], [895, "          WORKING_BUCKET:\n"], [896, "            Ref: WorkingBucket\n"], [897, "      LoggingConfig:\n"], [898, "        LogGroup:\n"], [899, "          Ref: OCRFunctionLogGroup\n"], [900, "      Policies:\n"], [901, "      - AWSLambdaBasicExecutionRole\n"], [902, "      - S3CrudPolicy:\n"], [903, "          BucketName:\n"], [904, "            Ref: OutputBucket\n"], [905, "      - S3CrudPolicy:\n"], [906, "          BucketName:\n"], [907, "            Ref: WorkingBucket\n"], [908, "      - S3ReadPolicy:\n"], [909, "          BucketName:\n"], [910, "            Ref: InputBucket\n"], [911, "      - DynamoDBCrudPolicy:\n"], [912, "          TableName:\n"], [913, "            Ref: ConfigurationTable\n"], [914, "      - Statement:\n"], [915, "        - Effect: Allow\n"], [916, "          Action: cloudwatch:PutMetricData\n"], [917, "          Resource: '*'\n"], [918, "        - Effect: Allow\n"], [919, "          Action:\n"], [920, "          - kms:Encrypt\n"], [921, "          - kms:Decrypt\n"], [922, "          - kms:ReEncrypt*\n"], [923, "          - kms:GenerateDataKey*\n"], [924, "          - kms:DescribeKey\n"], [925, "          Resource:\n"], [926, "            Ref: CustomerManagedEncryptionKeyArn\n"], [927, "        - Effect: Allow\n"], [928, "          Action:\n"], [929, "          - textract:DetectDocumentText\n"], [930, "          - textract:AnalyzeDocument\n"], [931, "          Resource: '*'\n"], [932, "        - Effect: Allow\n"], [933, "          Action:\n"], [934, "          - appsync:GraphQL\n"], [935, "          Resource:\n"], [936, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [858, 936], "resource": "AWS::Serverless::Function.OCRFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[858, "  OCRFunction:\n"], [859, "    Type: AWS::Serverless::Function\n"], [860, "    Metadata:\n"], [861, "      SamResourceId: OCRFunction\n"], [862, "      cfn_nag:\n"], [863, "        rules_to_suppress:\n"], [864, "        - id: W11\n"], [865, "          reason: Textract DetectDocumentText API and CloudWatch APIs do not support\n"], [866, "            resource-level permissions\n"], [867, "        - id: W89\n"], [868, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [869, "            with AWS services via AWS APIs\n"], [870, "        - id: W92\n"], [871, "          reason: Function does not require concurrent execution limits as it is designed\n"], [872, "            to scale based on demand\n"], [873, "    Properties:\n"], [874, "      PermissionsBoundary:\n"], [875, "        Fn::If:\n"], [876, "        - HasPermissionsBoundary\n"], [877, "        - Ref: PermissionsBoundaryArn\n"], [878, "        - Ref: AWS::NoValue\n"], [879, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/efce21da1a36a0910f962e5d62217520\n"], [880, "      Handler: index.handler\n"], [881, "      Runtime: python3.12\n"], [882, "      Timeout: 900\n"], [883, "      MemorySize: 4096\n"], [884, "      Environment:\n"], [885, "        Variables:\n"], [886, "          METRIC_NAMESPACE:\n"], [887, "            Ref: StackName\n"], [888, "          MAX_WORKERS: 20\n"], [889, "          CONFIGURATION_TABLE_NAME:\n"], [890, "            Ref: ConfigurationTable\n"], [891, "          LOG_LEVEL:\n"], [892, "            Ref: LogLevel\n"], [893, "          APPSYNC_API_URL:\n"], [894, "            Ref: AppSyncApiUrl\n"], [895, "          WORKING_BUCKET:\n"], [896, "            Ref: WorkingBucket\n"], [897, "      LoggingConfig:\n"], [898, "        LogGroup:\n"], [899, "          Ref: OCRFunctionLogGroup\n"], [900, "      Policies:\n"], [901, "      - AWSLambdaBasicExecutionRole\n"], [902, "      - S3CrudPolicy:\n"], [903, "          BucketName:\n"], [904, "            Ref: OutputBucket\n"], [905, "      - S3CrudPolicy:\n"], [906, "          BucketName:\n"], [907, "            Ref: WorkingBucket\n"], [908, "      - S3ReadPolicy:\n"], [909, "          BucketName:\n"], [910, "            Ref: InputBucket\n"], [911, "      - DynamoDBCrudPolicy:\n"], [912, "          TableName:\n"], [913, "            Ref: ConfigurationTable\n"], [914, "      - Statement:\n"], [915, "        - Effect: Allow\n"], [916, "          Action: cloudwatch:PutMetricData\n"], [917, "          Resource: '*'\n"], [918, "        - Effect: Allow\n"], [919, "          Action:\n"], [920, "          - kms:Encrypt\n"], [921, "          - kms:Decrypt\n"], [922, "          - kms:ReEncrypt*\n"], [923, "          - kms:GenerateDataKey*\n"], [924, "          - kms:DescribeKey\n"], [925, "          Resource:\n"], [926, "            Ref: CustomerManagedEncryptionKeyArn\n"], [927, "        - Effect: Allow\n"], [928, "          Action:\n"], [929, "          - textract:DetectDocumentText\n"], [930, "          - textract:AnalyzeDocument\n"], [931, "          Resource: '*'\n"], [932, "        - Effect: Allow\n"], [933, "          Action:\n"], [934, "          - appsync:GraphQL\n"], [935, "          Resource:\n"], [936, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [858, 936], "resource": "AWS::Serverless::Function.OCRFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[858, "  OCRFunction:\n"], [859, "    Type: AWS::Serverless::Function\n"], [860, "    Metadata:\n"], [861, "      SamResourceId: OCRFunction\n"], [862, "      cfn_nag:\n"], [863, "        rules_to_suppress:\n"], [864, "        - id: W11\n"], [865, "          reason: Textract DetectDocumentText API and CloudWatch APIs do not support\n"], [866, "            resource-level permissions\n"], [867, "        - id: W89\n"], [868, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [869, "            with AWS services via AWS APIs\n"], [870, "        - id: W92\n"], [871, "          reason: Function does not require concurrent execution limits as it is designed\n"], [872, "            to scale based on demand\n"], [873, "    Properties:\n"], [874, "      PermissionsBoundary:\n"], [875, "        Fn::If:\n"], [876, "        - HasPermissionsBoundary\n"], [877, "        - Ref: PermissionsBoundaryArn\n"], [878, "        - Ref: AWS::NoValue\n"], [879, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/efce21da1a36a0910f962e5d62217520\n"], [880, "      Handler: index.handler\n"], [881, "      Runtime: python3.12\n"], [882, "      Timeout: 900\n"], [883, "      MemorySize: 4096\n"], [884, "      Environment:\n"], [885, "        Variables:\n"], [886, "          METRIC_NAMESPACE:\n"], [887, "            Ref: StackName\n"], [888, "          MAX_WORKERS: 20\n"], [889, "          CONFIGURATION_TABLE_NAME:\n"], [890, "            Ref: ConfigurationTable\n"], [891, "          LOG_LEVEL:\n"], [892, "            Ref: LogLevel\n"], [893, "          APPSYNC_API_URL:\n"], [894, "            Ref: AppSyncApiUrl\n"], [895, "          WORKING_BUCKET:\n"], [896, "            Ref: WorkingBucket\n"], [897, "      LoggingConfig:\n"], [898, "        LogGroup:\n"], [899, "          Ref: OCRFunctionLogGroup\n"], [900, "      Policies:\n"], [901, "      - AWSLambdaBasicExecutionRole\n"], [902, "      - S3CrudPolicy:\n"], [903, "          BucketName:\n"], [904, "            Ref: OutputBucket\n"], [905, "      - S3CrudPolicy:\n"], [906, "          BucketName:\n"], [907, "            Ref: WorkingBucket\n"], [908, "      - S3ReadPolicy:\n"], [909, "          BucketName:\n"], [910, "            Ref: InputBucket\n"], [911, "      - DynamoDBCrudPolicy:\n"], [912, "          TableName:\n"], [913, "            Ref: ConfigurationTable\n"], [914, "      - Statement:\n"], [915, "        - Effect: Allow\n"], [916, "          Action: cloudwatch:PutMetricData\n"], [917, "          Resource: '*'\n"], [918, "        - Effect: Allow\n"], [919, "          Action:\n"], [920, "          - kms:Encrypt\n"], [921, "          - kms:Decrypt\n"], [922, "          - kms:ReEncrypt*\n"], [923, "          - kms:GenerateDataKey*\n"], [924, "          - kms:DescribeKey\n"], [925, "          Resource:\n"], [926, "            Ref: CustomerManagedEncryptionKeyArn\n"], [927, "        - Effect: Allow\n"], [928, "          Action:\n"], [929, "          - textract:DetectDocumentText\n"], [930, "          - textract:AnalyzeDocument\n"], [931, "          Resource: '*'\n"], [932, "        - Effect: Allow\n"], [933, "          Action:\n"], [934, "          - appsync:GraphQL\n"], [935, "          Resource:\n"], [936, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [858, 936], "resource": "AWS::Serverless::Function.OCRFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[948, "  ClassificationFunction:\n"], [949, "    Type: AWS::Serverless::Function\n"], [950, "    Metadata:\n"], [951, "      SamResourceId: ClassificationFunction\n"], [952, "      cfn_nag:\n"], [953, "        rules_to_suppress:\n"], [954, "        - id: W11\n"], [955, "          reason: Textract DetectDocumentText API and CloudWatch APIs do not support\n"], [956, "            resource-level permissions\n"], [957, "        - id: W89\n"], [958, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [959, "            with AWS services via AWS APIs\n"], [960, "        - id: W92\n"], [961, "          reason: Function does not require concurrent execution limits as it is designed\n"], [962, "            to scale based on demand\n"], [963, "    Properties:\n"], [964, "      PermissionsBoundary:\n"], [965, "        Fn::If:\n"], [966, "        - HasPermissionsBoundary\n"], [967, "        - Ref: PermissionsBoundaryArn\n"], [968, "        - Ref: AWS::NoValue\n"], [969, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/93805d9cdc180a1e6c4e4c992807bc5b\n"], [970, "      Handler: index.handler\n"], [971, "      Runtime: python3.12\n"], [972, "      Timeout: 900\n"], [973, "      MemorySize: 4096\n"], [974, "      Environment:\n"], [975, "        Variables:\n"], [976, "          METRIC_NAMESPACE:\n"], [977, "            Ref: StackName\n"], [978, "          MAX_WORKERS: 20\n"], [979, "          TRACKING_TABLE:\n"], [980, "            Ref: TrackingTable\n"], [981, "          SAGEMAKER_ENDPOINT_NAME:\n"], [982, "            Fn::GetAtt:\n"], [983, "            - SAGEMAKERCLASSIFIERSTACK\n"], [984, "            - Outputs.EndpointName\n"], [985, "          CONFIGURATION_TABLE_NAME:\n"], [986, "            Ref: ConfigurationTable\n"], [987, "          APPSYNC_API_URL:\n"], [988, "            Ref: AppSyncApiUrl\n"], [989, "          GUARDRAIL_ID_AND_VERSION:\n"], [990, "            Fn::If:\n"], [991, "            - HasGuardrailConfig\n"], [992, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [993, "            - ''\n"], [994, "          LOG_LEVEL:\n"], [995, "            Ref: LogLevel\n"], [996, "          WORKING_BUCKET:\n"], [997, "            Ref: WorkingBucket\n"], [998, "      LoggingConfig:\n"], [999, "        LogGroup:\n"], [1000, "          Ref: ClassificationFunctionLogGroup\n"], [1001, "      Policies:\n"], [1002, "      - AWSLambdaBasicExecutionRole\n"], [1003, "      - S3CrudPolicy:\n"], [1004, "          BucketName:\n"], [1005, "            Ref: OutputBucket\n"], [1006, "      - S3CrudPolicy:\n"], [1007, "          BucketName:\n"], [1008, "            Ref: WorkingBucket\n"], [1009, "      - S3ReadPolicy:\n"], [1010, "          BucketName:\n"], [1011, "            Ref: InputBucket\n"], [1012, "      - DynamoDBCrudPolicy:\n"], [1013, "          TableName:\n"], [1014, "            Ref: TrackingTable\n"], [1015, "      - S3ReadPolicy:\n"], [1016, "          BucketName:\n"], [1017, "            Ref: ConfigurationBucket\n"], [1018, "      - DynamoDBCrudPolicy:\n"], [1019, "          TableName:\n"], [1020, "            Ref: ConfigurationTable\n"], [1021, "      - Statement:\n"], [1022, "        - Effect: Allow\n"], [1023, "          Action: cloudwatch:PutMetricData\n"], [1024, "          Resource: '*'\n"], [1025, "        - Effect: Allow\n"], [1026, "          Action:\n"], [1027, "          - kms:Encrypt\n"], [1028, "          - kms:Decrypt\n"], [1029, "          - kms:ReEncrypt*\n"], [1030, "          - kms:GenerateDataKey*\n"], [1031, "          - kms:DescribeKey\n"], [1032, "          Resource:\n"], [1033, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1034, "        - Effect: Allow\n"], [1035, "          Action: sagemaker:InvokeEndpoint\n"], [1036, "          Resource:\n"], [1037, "            Fn::GetAtt:\n"], [1038, "            - SAGEMAKERCLASSIFIERSTACK\n"], [1039, "            - Outputs.EndpointArn\n"], [1040, "        - Effect: Allow\n"], [1041, "          Action:\n"], [1042, "          - appsync:GraphQL\n"], [1043, "          Resource:\n"], [1044, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1045, "        - Fn::If:\n"], [1046, "          - HasGuardrailConfig\n"], [1047, "          - Effect: Allow\n"], [1048, "            Action: bedrock:ApplyGuardrail\n"], [1049, "            Resource:\n"], [1050, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1051, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [948, 1051], "resource": "AWS::Serverless::Function.ClassificationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[948, "  ClassificationFunction:\n"], [949, "    Type: AWS::Serverless::Function\n"], [950, "    Metadata:\n"], [951, "      SamResourceId: ClassificationFunction\n"], [952, "      cfn_nag:\n"], [953, "        rules_to_suppress:\n"], [954, "        - id: W11\n"], [955, "          reason: Textract DetectDocumentText API and CloudWatch APIs do not support\n"], [956, "            resource-level permissions\n"], [957, "        - id: W89\n"], [958, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [959, "            with AWS services via AWS APIs\n"], [960, "        - id: W92\n"], [961, "          reason: Function does not require concurrent execution limits as it is designed\n"], [962, "            to scale based on demand\n"], [963, "    Properties:\n"], [964, "      PermissionsBoundary:\n"], [965, "        Fn::If:\n"], [966, "        - HasPermissionsBoundary\n"], [967, "        - Ref: PermissionsBoundaryArn\n"], [968, "        - Ref: AWS::NoValue\n"], [969, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/93805d9cdc180a1e6c4e4c992807bc5b\n"], [970, "      Handler: index.handler\n"], [971, "      Runtime: python3.12\n"], [972, "      Timeout: 900\n"], [973, "      MemorySize: 4096\n"], [974, "      Environment:\n"], [975, "        Variables:\n"], [976, "          METRIC_NAMESPACE:\n"], [977, "            Ref: StackName\n"], [978, "          MAX_WORKERS: 20\n"], [979, "          TRACKING_TABLE:\n"], [980, "            Ref: TrackingTable\n"], [981, "          SAGEMAKER_ENDPOINT_NAME:\n"], [982, "            Fn::GetAtt:\n"], [983, "            - SAGEMAKERCLASSIFIERSTACK\n"], [984, "            - Outputs.EndpointName\n"], [985, "          CONFIGURATION_TABLE_NAME:\n"], [986, "            Ref: ConfigurationTable\n"], [987, "          APPSYNC_API_URL:\n"], [988, "            Ref: AppSyncApiUrl\n"], [989, "          GUARDRAIL_ID_AND_VERSION:\n"], [990, "            Fn::If:\n"], [991, "            - HasGuardrailConfig\n"], [992, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [993, "            - ''\n"], [994, "          LOG_LEVEL:\n"], [995, "            Ref: LogLevel\n"], [996, "          WORKING_BUCKET:\n"], [997, "            Ref: WorkingBucket\n"], [998, "      LoggingConfig:\n"], [999, "        LogGroup:\n"], [1000, "          Ref: ClassificationFunctionLogGroup\n"], [1001, "      Policies:\n"], [1002, "      - AWSLambdaBasicExecutionRole\n"], [1003, "      - S3CrudPolicy:\n"], [1004, "          BucketName:\n"], [1005, "            Ref: OutputBucket\n"], [1006, "      - S3CrudPolicy:\n"], [1007, "          BucketName:\n"], [1008, "            Ref: WorkingBucket\n"], [1009, "      - S3ReadPolicy:\n"], [1010, "          BucketName:\n"], [1011, "            Ref: InputBucket\n"], [1012, "      - DynamoDBCrudPolicy:\n"], [1013, "          TableName:\n"], [1014, "            Ref: TrackingTable\n"], [1015, "      - S3ReadPolicy:\n"], [1016, "          BucketName:\n"], [1017, "            Ref: ConfigurationBucket\n"], [1018, "      - DynamoDBCrudPolicy:\n"], [1019, "          TableName:\n"], [1020, "            Ref: ConfigurationTable\n"], [1021, "      - Statement:\n"], [1022, "        - Effect: Allow\n"], [1023, "          Action: cloudwatch:PutMetricData\n"], [1024, "          Resource: '*'\n"], [1025, "        - Effect: Allow\n"], [1026, "          Action:\n"], [1027, "          - kms:Encrypt\n"], [1028, "          - kms:Decrypt\n"], [1029, "          - kms:ReEncrypt*\n"], [1030, "          - kms:GenerateDataKey*\n"], [1031, "          - kms:DescribeKey\n"], [1032, "          Resource:\n"], [1033, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1034, "        - Effect: Allow\n"], [1035, "          Action: sagemaker:InvokeEndpoint\n"], [1036, "          Resource:\n"], [1037, "            Fn::GetAtt:\n"], [1038, "            - SAGEMAKERCLASSIFIERSTACK\n"], [1039, "            - Outputs.EndpointArn\n"], [1040, "        - Effect: Allow\n"], [1041, "          Action:\n"], [1042, "          - appsync:GraphQL\n"], [1043, "          Resource:\n"], [1044, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1045, "        - Fn::If:\n"], [1046, "          - HasGuardrailConfig\n"], [1047, "          - Effect: Allow\n"], [1048, "            Action: bedrock:ApplyGuardrail\n"], [1049, "            Resource:\n"], [1050, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1051, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [948, 1051], "resource": "AWS::Serverless::Function.ClassificationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[948, "  ClassificationFunction:\n"], [949, "    Type: AWS::Serverless::Function\n"], [950, "    Metadata:\n"], [951, "      SamResourceId: ClassificationFunction\n"], [952, "      cfn_nag:\n"], [953, "        rules_to_suppress:\n"], [954, "        - id: W11\n"], [955, "          reason: Textract DetectDocumentText API and CloudWatch APIs do not support\n"], [956, "            resource-level permissions\n"], [957, "        - id: W89\n"], [958, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [959, "            with AWS services via AWS APIs\n"], [960, "        - id: W92\n"], [961, "          reason: Function does not require concurrent execution limits as it is designed\n"], [962, "            to scale based on demand\n"], [963, "    Properties:\n"], [964, "      PermissionsBoundary:\n"], [965, "        Fn::If:\n"], [966, "        - HasPermissionsBoundary\n"], [967, "        - Ref: PermissionsBoundaryArn\n"], [968, "        - Ref: AWS::NoValue\n"], [969, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/93805d9cdc180a1e6c4e4c992807bc5b\n"], [970, "      Handler: index.handler\n"], [971, "      Runtime: python3.12\n"], [972, "      Timeout: 900\n"], [973, "      MemorySize: 4096\n"], [974, "      Environment:\n"], [975, "        Variables:\n"], [976, "          METRIC_NAMESPACE:\n"], [977, "            Ref: StackName\n"], [978, "          MAX_WORKERS: 20\n"], [979, "          TRACKING_TABLE:\n"], [980, "            Ref: TrackingTable\n"], [981, "          SAGEMAKER_ENDPOINT_NAME:\n"], [982, "            Fn::GetAtt:\n"], [983, "            - SAGEMAKERCLASSIFIERSTACK\n"], [984, "            - Outputs.EndpointName\n"], [985, "          CONFIGURATION_TABLE_NAME:\n"], [986, "            Ref: ConfigurationTable\n"], [987, "          APPSYNC_API_URL:\n"], [988, "            Ref: AppSyncApiUrl\n"], [989, "          GUARDRAIL_ID_AND_VERSION:\n"], [990, "            Fn::If:\n"], [991, "            - HasGuardrailConfig\n"], [992, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [993, "            - ''\n"], [994, "          LOG_LEVEL:\n"], [995, "            Ref: LogLevel\n"], [996, "          WORKING_BUCKET:\n"], [997, "            Ref: WorkingBucket\n"], [998, "      LoggingConfig:\n"], [999, "        LogGroup:\n"], [1000, "          Ref: ClassificationFunctionLogGroup\n"], [1001, "      Policies:\n"], [1002, "      - AWSLambdaBasicExecutionRole\n"], [1003, "      - S3CrudPolicy:\n"], [1004, "          BucketName:\n"], [1005, "            Ref: OutputBucket\n"], [1006, "      - S3CrudPolicy:\n"], [1007, "          BucketName:\n"], [1008, "            Ref: WorkingBucket\n"], [1009, "      - S3ReadPolicy:\n"], [1010, "          BucketName:\n"], [1011, "            Ref: InputBucket\n"], [1012, "      - DynamoDBCrudPolicy:\n"], [1013, "          TableName:\n"], [1014, "            Ref: TrackingTable\n"], [1015, "      - S3ReadPolicy:\n"], [1016, "          BucketName:\n"], [1017, "            Ref: ConfigurationBucket\n"], [1018, "      - DynamoDBCrudPolicy:\n"], [1019, "          TableName:\n"], [1020, "            Ref: ConfigurationTable\n"], [1021, "      - Statement:\n"], [1022, "        - Effect: Allow\n"], [1023, "          Action: cloudwatch:PutMetricData\n"], [1024, "          Resource: '*'\n"], [1025, "        - Effect: Allow\n"], [1026, "          Action:\n"], [1027, "          - kms:Encrypt\n"], [1028, "          - kms:Decrypt\n"], [1029, "          - kms:ReEncrypt*\n"], [1030, "          - kms:GenerateDataKey*\n"], [1031, "          - kms:DescribeKey\n"], [1032, "          Resource:\n"], [1033, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1034, "        - Effect: Allow\n"], [1035, "          Action: sagemaker:InvokeEndpoint\n"], [1036, "          Resource:\n"], [1037, "            Fn::GetAtt:\n"], [1038, "            - SAGEMAKERCLASSIFIERSTACK\n"], [1039, "            - Outputs.EndpointArn\n"], [1040, "        - Effect: Allow\n"], [1041, "          Action:\n"], [1042, "          - appsync:GraphQL\n"], [1043, "          Resource:\n"], [1044, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1045, "        - Fn::If:\n"], [1046, "          - HasGuardrailConfig\n"], [1047, "          - Effect: Allow\n"], [1048, "            Action: bedrock:ApplyGuardrail\n"], [1049, "            Resource:\n"], [1050, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1051, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [948, 1051], "resource": "AWS::Serverless::Function.ClassificationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[948, "  ClassificationFunction:\n"], [949, "    Type: AWS::Serverless::Function\n"], [950, "    Metadata:\n"], [951, "      SamResourceId: ClassificationFunction\n"], [952, "      cfn_nag:\n"], [953, "        rules_to_suppress:\n"], [954, "        - id: W11\n"], [955, "          reason: Textract DetectDocumentText API and CloudWatch APIs do not support\n"], [956, "            resource-level permissions\n"], [957, "        - id: W89\n"], [958, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [959, "            with AWS services via AWS APIs\n"], [960, "        - id: W92\n"], [961, "          reason: Function does not require concurrent execution limits as it is designed\n"], [962, "            to scale based on demand\n"], [963, "    Properties:\n"], [964, "      PermissionsBoundary:\n"], [965, "        Fn::If:\n"], [966, "        - HasPermissionsBoundary\n"], [967, "        - Ref: PermissionsBoundaryArn\n"], [968, "        - Ref: AWS::NoValue\n"], [969, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/93805d9cdc180a1e6c4e4c992807bc5b\n"], [970, "      Handler: index.handler\n"], [971, "      Runtime: python3.12\n"], [972, "      Timeout: 900\n"], [973, "      MemorySize: 4096\n"], [974, "      Environment:\n"], [975, "        Variables:\n"], [976, "          METRIC_NAMESPACE:\n"], [977, "            Ref: StackName\n"], [978, "          MAX_WORKERS: 20\n"], [979, "          TRACKING_TABLE:\n"], [980, "            Ref: TrackingTable\n"], [981, "          SAGEMAKER_ENDPOINT_NAME:\n"], [982, "            Fn::GetAtt:\n"], [983, "            - SAGEMAKERCLASSIFIERSTACK\n"], [984, "            - Outputs.EndpointName\n"], [985, "          CONFIGURATION_TABLE_NAME:\n"], [986, "            Ref: ConfigurationTable\n"], [987, "          APPSYNC_API_URL:\n"], [988, "            Ref: AppSyncApiUrl\n"], [989, "          GUARDRAIL_ID_AND_VERSION:\n"], [990, "            Fn::If:\n"], [991, "            - HasGuardrailConfig\n"], [992, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [993, "            - ''\n"], [994, "          LOG_LEVEL:\n"], [995, "            Ref: LogLevel\n"], [996, "          WORKING_BUCKET:\n"], [997, "            Ref: WorkingBucket\n"], [998, "      LoggingConfig:\n"], [999, "        LogGroup:\n"], [1000, "          Ref: ClassificationFunctionLogGroup\n"], [1001, "      Policies:\n"], [1002, "      - AWSLambdaBasicExecutionRole\n"], [1003, "      - S3CrudPolicy:\n"], [1004, "          BucketName:\n"], [1005, "            Ref: OutputBucket\n"], [1006, "      - S3CrudPolicy:\n"], [1007, "          BucketName:\n"], [1008, "            Ref: WorkingBucket\n"], [1009, "      - S3ReadPolicy:\n"], [1010, "          BucketName:\n"], [1011, "            Ref: InputBucket\n"], [1012, "      - DynamoDBCrudPolicy:\n"], [1013, "          TableName:\n"], [1014, "            Ref: TrackingTable\n"], [1015, "      - S3ReadPolicy:\n"], [1016, "          BucketName:\n"], [1017, "            Ref: ConfigurationBucket\n"], [1018, "      - DynamoDBCrudPolicy:\n"], [1019, "          TableName:\n"], [1020, "            Ref: ConfigurationTable\n"], [1021, "      - Statement:\n"], [1022, "        - Effect: Allow\n"], [1023, "          Action: cloudwatch:PutMetricData\n"], [1024, "          Resource: '*'\n"], [1025, "        - Effect: Allow\n"], [1026, "          Action:\n"], [1027, "          - kms:Encrypt\n"], [1028, "          - kms:Decrypt\n"], [1029, "          - kms:ReEncrypt*\n"], [1030, "          - kms:GenerateDataKey*\n"], [1031, "          - kms:DescribeKey\n"], [1032, "          Resource:\n"], [1033, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1034, "        - Effect: Allow\n"], [1035, "          Action: sagemaker:InvokeEndpoint\n"], [1036, "          Resource:\n"], [1037, "            Fn::GetAtt:\n"], [1038, "            - SAGEMAKERCLASSIFIERSTACK\n"], [1039, "            - Outputs.EndpointArn\n"], [1040, "        - Effect: Allow\n"], [1041, "          Action:\n"], [1042, "          - appsync:GraphQL\n"], [1043, "          Resource:\n"], [1044, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1045, "        - Fn::If:\n"], [1046, "          - HasGuardrailConfig\n"], [1047, "          - Effect: Allow\n"], [1048, "            Action: bedrock:ApplyGuardrail\n"], [1049, "            Resource:\n"], [1050, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1051, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [948, 1051], "resource": "AWS::Serverless::Function.ClassificationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[1063, "  ExtractionFunction:\n"], [1064, "    Type: AWS::Serverless::Function\n"], [1065, "    Metadata:\n"], [1066, "      SamResourceId: ExtractionFunction\n"], [1067, "      cfn_nag:\n"], [1068, "        rules_to_suppress:\n"], [1069, "        - id: W11\n"], [1070, "          reason: Cloudwatch does not support resource-level permissions\n"], [1071, "        - id: W89\n"], [1072, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1073, "            with AWS services via AWS APIs\n"], [1074, "        - id: W92\n"], [1075, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1076, "            to scale based on demand\n"], [1077, "    Properties:\n"], [1078, "      PermissionsBoundary:\n"], [1079, "        Fn::If:\n"], [1080, "        - HasPermissionsBoundary\n"], [1081, "        - Ref: PermissionsBoundaryArn\n"], [1082, "        - Ref: AWS::NoValue\n"], [1083, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/c4d828e2eaa186015189bb0f0a7b6bc7\n"], [1084, "      Handler: index.handler\n"], [1085, "      Runtime: python3.12\n"], [1086, "      Timeout: 900\n"], [1087, "      MemorySize: 512\n"], [1088, "      Environment:\n"], [1089, "        Variables:\n"], [1090, "          METRIC_NAMESPACE:\n"], [1091, "            Ref: StackName\n"], [1092, "          CONFIGURATION_TABLE_NAME:\n"], [1093, "            Ref: ConfigurationTable\n"], [1094, "          GUARDRAIL_ID_AND_VERSION:\n"], [1095, "            Fn::If:\n"], [1096, "            - HasGuardrailConfig\n"], [1097, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1098, "            - ''\n"], [1099, "          LOG_LEVEL:\n"], [1100, "            Ref: LogLevel\n"], [1101, "          APPSYNC_API_URL:\n"], [1102, "            Ref: AppSyncApiUrl\n"], [1103, "          WORKING_BUCKET:\n"], [1104, "            Ref: WorkingBucket\n"], [1105, "      LoggingConfig:\n"], [1106, "        LogGroup:\n"], [1107, "          Ref: ExtractionFunctionLogGroup\n"], [1108, "      Policies:\n"], [1109, "      - AWSLambdaBasicExecutionRole\n"], [1110, "      - S3CrudPolicy:\n"], [1111, "          BucketName:\n"], [1112, "            Ref: OutputBucket\n"], [1113, "      - S3CrudPolicy:\n"], [1114, "          BucketName:\n"], [1115, "            Ref: WorkingBucket\n"], [1116, "      - S3ReadPolicy:\n"], [1117, "          BucketName:\n"], [1118, "            Ref: InputBucket\n"], [1119, "      - S3ReadPolicy:\n"], [1120, "          BucketName:\n"], [1121, "            Ref: ConfigurationBucket\n"], [1122, "      - DynamoDBCrudPolicy:\n"], [1123, "          TableName:\n"], [1124, "            Ref: ConfigurationTable\n"], [1125, "      - Statement:\n"], [1126, "        - Effect: Allow\n"], [1127, "          Action: cloudwatch:PutMetricData\n"], [1128, "          Resource: '*'\n"], [1129, "        - Effect: Allow\n"], [1130, "          Action:\n"], [1131, "          - kms:Encrypt\n"], [1132, "          - kms:Decrypt\n"], [1133, "          - kms:ReEncrypt*\n"], [1134, "          - kms:GenerateDataKey*\n"], [1135, "          - kms:DescribeKey\n"], [1136, "          Resource:\n"], [1137, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1138, "        - Effect: Allow\n"], [1139, "          Action: bedrock:InvokeModel\n"], [1140, "          Resource:\n"], [1141, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1142, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1143, "        - Effect: Allow\n"], [1144, "          Action:\n"], [1145, "          - appsync:GraphQL\n"], [1146, "          Resource:\n"], [1147, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1148, "        - Fn::If:\n"], [1149, "          - HasGuardrailConfig\n"], [1150, "          - Effect: Allow\n"], [1151, "            Action: bedrock:ApplyGuardrail\n"], [1152, "            Resource:\n"], [1153, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1154, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1063, 1154], "resource": "AWS::Serverless::Function.ExtractionFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[1063, "  ExtractionFunction:\n"], [1064, "    Type: AWS::Serverless::Function\n"], [1065, "    Metadata:\n"], [1066, "      SamResourceId: ExtractionFunction\n"], [1067, "      cfn_nag:\n"], [1068, "        rules_to_suppress:\n"], [1069, "        - id: W11\n"], [1070, "          reason: Cloudwatch does not support resource-level permissions\n"], [1071, "        - id: W89\n"], [1072, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1073, "            with AWS services via AWS APIs\n"], [1074, "        - id: W92\n"], [1075, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1076, "            to scale based on demand\n"], [1077, "    Properties:\n"], [1078, "      PermissionsBoundary:\n"], [1079, "        Fn::If:\n"], [1080, "        - HasPermissionsBoundary\n"], [1081, "        - Ref: PermissionsBoundaryArn\n"], [1082, "        - Ref: AWS::NoValue\n"], [1083, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/c4d828e2eaa186015189bb0f0a7b6bc7\n"], [1084, "      Handler: index.handler\n"], [1085, "      Runtime: python3.12\n"], [1086, "      Timeout: 900\n"], [1087, "      MemorySize: 512\n"], [1088, "      Environment:\n"], [1089, "        Variables:\n"], [1090, "          METRIC_NAMESPACE:\n"], [1091, "            Ref: StackName\n"], [1092, "          CONFIGURATION_TABLE_NAME:\n"], [1093, "            Ref: ConfigurationTable\n"], [1094, "          GUARDRAIL_ID_AND_VERSION:\n"], [1095, "            Fn::If:\n"], [1096, "            - HasGuardrailConfig\n"], [1097, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1098, "            - ''\n"], [1099, "          LOG_LEVEL:\n"], [1100, "            Ref: LogLevel\n"], [1101, "          APPSYNC_API_URL:\n"], [1102, "            Ref: AppSyncApiUrl\n"], [1103, "          WORKING_BUCKET:\n"], [1104, "            Ref: WorkingBucket\n"], [1105, "      LoggingConfig:\n"], [1106, "        LogGroup:\n"], [1107, "          Ref: ExtractionFunctionLogGroup\n"], [1108, "      Policies:\n"], [1109, "      - AWSLambdaBasicExecutionRole\n"], [1110, "      - S3CrudPolicy:\n"], [1111, "          BucketName:\n"], [1112, "            Ref: OutputBucket\n"], [1113, "      - S3CrudPolicy:\n"], [1114, "          BucketName:\n"], [1115, "            Ref: WorkingBucket\n"], [1116, "      - S3ReadPolicy:\n"], [1117, "          BucketName:\n"], [1118, "            Ref: InputBucket\n"], [1119, "      - S3ReadPolicy:\n"], [1120, "          BucketName:\n"], [1121, "            Ref: ConfigurationBucket\n"], [1122, "      - DynamoDBCrudPolicy:\n"], [1123, "          TableName:\n"], [1124, "            Ref: ConfigurationTable\n"], [1125, "      - Statement:\n"], [1126, "        - Effect: Allow\n"], [1127, "          Action: cloudwatch:PutMetricData\n"], [1128, "          Resource: '*'\n"], [1129, "        - Effect: Allow\n"], [1130, "          Action:\n"], [1131, "          - kms:Encrypt\n"], [1132, "          - kms:Decrypt\n"], [1133, "          - kms:ReEncrypt*\n"], [1134, "          - kms:GenerateDataKey*\n"], [1135, "          - kms:DescribeKey\n"], [1136, "          Resource:\n"], [1137, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1138, "        - Effect: Allow\n"], [1139, "          Action: bedrock:InvokeModel\n"], [1140, "          Resource:\n"], [1141, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1142, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1143, "        - Effect: Allow\n"], [1144, "          Action:\n"], [1145, "          - appsync:GraphQL\n"], [1146, "          Resource:\n"], [1147, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1148, "        - Fn::If:\n"], [1149, "          - HasGuardrailConfig\n"], [1150, "          - Effect: Allow\n"], [1151, "            Action: bedrock:ApplyGuardrail\n"], [1152, "            Resource:\n"], [1153, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1154, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1063, 1154], "resource": "AWS::Serverless::Function.ExtractionFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[1063, "  ExtractionFunction:\n"], [1064, "    Type: AWS::Serverless::Function\n"], [1065, "    Metadata:\n"], [1066, "      SamResourceId: ExtractionFunction\n"], [1067, "      cfn_nag:\n"], [1068, "        rules_to_suppress:\n"], [1069, "        - id: W11\n"], [1070, "          reason: Cloudwatch does not support resource-level permissions\n"], [1071, "        - id: W89\n"], [1072, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1073, "            with AWS services via AWS APIs\n"], [1074, "        - id: W92\n"], [1075, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1076, "            to scale based on demand\n"], [1077, "    Properties:\n"], [1078, "      PermissionsBoundary:\n"], [1079, "        Fn::If:\n"], [1080, "        - HasPermissionsBoundary\n"], [1081, "        - Ref: PermissionsBoundaryArn\n"], [1082, "        - Ref: AWS::NoValue\n"], [1083, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/c4d828e2eaa186015189bb0f0a7b6bc7\n"], [1084, "      Handler: index.handler\n"], [1085, "      Runtime: python3.12\n"], [1086, "      Timeout: 900\n"], [1087, "      MemorySize: 512\n"], [1088, "      Environment:\n"], [1089, "        Variables:\n"], [1090, "          METRIC_NAMESPACE:\n"], [1091, "            Ref: StackName\n"], [1092, "          CONFIGURATION_TABLE_NAME:\n"], [1093, "            Ref: ConfigurationTable\n"], [1094, "          GUARDRAIL_ID_AND_VERSION:\n"], [1095, "            Fn::If:\n"], [1096, "            - HasGuardrailConfig\n"], [1097, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1098, "            - ''\n"], [1099, "          LOG_LEVEL:\n"], [1100, "            Ref: LogLevel\n"], [1101, "          APPSYNC_API_URL:\n"], [1102, "            Ref: AppSyncApiUrl\n"], [1103, "          WORKING_BUCKET:\n"], [1104, "            Ref: WorkingBucket\n"], [1105, "      LoggingConfig:\n"], [1106, "        LogGroup:\n"], [1107, "          Ref: ExtractionFunctionLogGroup\n"], [1108, "      Policies:\n"], [1109, "      - AWSLambdaBasicExecutionRole\n"], [1110, "      - S3CrudPolicy:\n"], [1111, "          BucketName:\n"], [1112, "            Ref: OutputBucket\n"], [1113, "      - S3CrudPolicy:\n"], [1114, "          BucketName:\n"], [1115, "            Ref: WorkingBucket\n"], [1116, "      - S3ReadPolicy:\n"], [1117, "          BucketName:\n"], [1118, "            Ref: InputBucket\n"], [1119, "      - S3ReadPolicy:\n"], [1120, "          BucketName:\n"], [1121, "            Ref: ConfigurationBucket\n"], [1122, "      - DynamoDBCrudPolicy:\n"], [1123, "          TableName:\n"], [1124, "            Ref: ConfigurationTable\n"], [1125, "      - Statement:\n"], [1126, "        - Effect: Allow\n"], [1127, "          Action: cloudwatch:PutMetricData\n"], [1128, "          Resource: '*'\n"], [1129, "        - Effect: Allow\n"], [1130, "          Action:\n"], [1131, "          - kms:Encrypt\n"], [1132, "          - kms:Decrypt\n"], [1133, "          - kms:ReEncrypt*\n"], [1134, "          - kms:GenerateDataKey*\n"], [1135, "          - kms:DescribeKey\n"], [1136, "          Resource:\n"], [1137, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1138, "        - Effect: Allow\n"], [1139, "          Action: bedrock:InvokeModel\n"], [1140, "          Resource:\n"], [1141, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1142, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1143, "        - Effect: Allow\n"], [1144, "          Action:\n"], [1145, "          - appsync:GraphQL\n"], [1146, "          Resource:\n"], [1147, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1148, "        - Fn::If:\n"], [1149, "          - HasGuardrailConfig\n"], [1150, "          - Effect: Allow\n"], [1151, "            Action: bedrock:ApplyGuardrail\n"], [1152, "            Resource:\n"], [1153, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1154, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1063, 1154], "resource": "AWS::Serverless::Function.ExtractionFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[1063, "  ExtractionFunction:\n"], [1064, "    Type: AWS::Serverless::Function\n"], [1065, "    Metadata:\n"], [1066, "      SamResourceId: ExtractionFunction\n"], [1067, "      cfn_nag:\n"], [1068, "        rules_to_suppress:\n"], [1069, "        - id: W11\n"], [1070, "          reason: Cloudwatch does not support resource-level permissions\n"], [1071, "        - id: W89\n"], [1072, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1073, "            with AWS services via AWS APIs\n"], [1074, "        - id: W92\n"], [1075, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1076, "            to scale based on demand\n"], [1077, "    Properties:\n"], [1078, "      PermissionsBoundary:\n"], [1079, "        Fn::If:\n"], [1080, "        - HasPermissionsBoundary\n"], [1081, "        - Ref: PermissionsBoundaryArn\n"], [1082, "        - Ref: AWS::NoValue\n"], [1083, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/c4d828e2eaa186015189bb0f0a7b6bc7\n"], [1084, "      Handler: index.handler\n"], [1085, "      Runtime: python3.12\n"], [1086, "      Timeout: 900\n"], [1087, "      MemorySize: 512\n"], [1088, "      Environment:\n"], [1089, "        Variables:\n"], [1090, "          METRIC_NAMESPACE:\n"], [1091, "            Ref: StackName\n"], [1092, "          CONFIGURATION_TABLE_NAME:\n"], [1093, "            Ref: ConfigurationTable\n"], [1094, "          GUARDRAIL_ID_AND_VERSION:\n"], [1095, "            Fn::If:\n"], [1096, "            - HasGuardrailConfig\n"], [1097, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1098, "            - ''\n"], [1099, "          LOG_LEVEL:\n"], [1100, "            Ref: LogLevel\n"], [1101, "          APPSYNC_API_URL:\n"], [1102, "            Ref: AppSyncApiUrl\n"], [1103, "          WORKING_BUCKET:\n"], [1104, "            Ref: WorkingBucket\n"], [1105, "      LoggingConfig:\n"], [1106, "        LogGroup:\n"], [1107, "          Ref: ExtractionFunctionLogGroup\n"], [1108, "      Policies:\n"], [1109, "      - AWSLambdaBasicExecutionRole\n"], [1110, "      - S3CrudPolicy:\n"], [1111, "          BucketName:\n"], [1112, "            Ref: OutputBucket\n"], [1113, "      - S3CrudPolicy:\n"], [1114, "          BucketName:\n"], [1115, "            Ref: WorkingBucket\n"], [1116, "      - S3ReadPolicy:\n"], [1117, "          BucketName:\n"], [1118, "            Ref: InputBucket\n"], [1119, "      - S3ReadPolicy:\n"], [1120, "          BucketName:\n"], [1121, "            Ref: ConfigurationBucket\n"], [1122, "      - DynamoDBCrudPolicy:\n"], [1123, "          TableName:\n"], [1124, "            Ref: ConfigurationTable\n"], [1125, "      - Statement:\n"], [1126, "        - Effect: Allow\n"], [1127, "          Action: cloudwatch:PutMetricData\n"], [1128, "          Resource: '*'\n"], [1129, "        - Effect: Allow\n"], [1130, "          Action:\n"], [1131, "          - kms:Encrypt\n"], [1132, "          - kms:Decrypt\n"], [1133, "          - kms:ReEncrypt*\n"], [1134, "          - kms:GenerateDataKey*\n"], [1135, "          - kms:DescribeKey\n"], [1136, "          Resource:\n"], [1137, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1138, "        - Effect: Allow\n"], [1139, "          Action: bedrock:InvokeModel\n"], [1140, "          Resource:\n"], [1141, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1142, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1143, "        - Effect: Allow\n"], [1144, "          Action:\n"], [1145, "          - appsync:GraphQL\n"], [1146, "          Resource:\n"], [1147, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1148, "        - Fn::If:\n"], [1149, "          - HasGuardrailConfig\n"], [1150, "          - Effect: Allow\n"], [1151, "            Action: bedrock:ApplyGuardrail\n"], [1152, "            Resource:\n"], [1153, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1154, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1063, 1154], "resource": "AWS::Serverless::Function.ExtractionFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[1166, "  AssessmentFunction:\n"], [1167, "    Type: AWS::Serverless::Function\n"], [1168, "    Metadata:\n"], [1169, "      SamResourceId: AssessmentFunction\n"], [1170, "      cfn_nag:\n"], [1171, "        rules_to_suppress:\n"], [1172, "        - id: W89\n"], [1173, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1174, "            with AWS services via AWS APIs\n"], [1175, "        - id: W92\n"], [1176, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1177, "            to scale based on demand\n"], [1178, "        - id: W11\n"], [1179, "          reason: Cloudwatch does not support resource-level permissions, and Bedrock\n"], [1180, "            should support any enabled Bedrock model_id or inference profile\n"], [1181, "    Properties:\n"], [1182, "      PermissionsBoundary:\n"], [1183, "        Fn::If:\n"], [1184, "        - HasPermissionsBoundary\n"], [1185, "        - Ref: PermissionsBoundaryArn\n"], [1186, "        - Ref: AWS::NoValue\n"], [1187, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/6bec578bfb9f0f57df2161465d17fcd3\n"], [1188, "      Handler: index.handler\n"], [1189, "      Runtime: python3.12\n"], [1190, "      Timeout: 900\n"], [1191, "      MemorySize: 512\n"], [1192, "      Environment:\n"], [1193, "        Variables:\n"], [1194, "          METRIC_NAMESPACE:\n"], [1195, "            Ref: StackName\n"], [1196, "          CONFIGURATION_BUCKET:\n"], [1197, "            Ref: ConfigurationBucket\n"], [1198, "          CONFIGURATION_TABLE_NAME:\n"], [1199, "            Ref: ConfigurationTable\n"], [1200, "          LOG_LEVEL:\n"], [1201, "            Ref: LogLevel\n"], [1202, "          APPSYNC_API_URL:\n"], [1203, "            Ref: AppSyncApiUrl\n"], [1204, "          WORKING_BUCKET:\n"], [1205, "            Ref: WorkingBucket\n"], [1206, "      LoggingConfig:\n"], [1207, "        LogGroup:\n"], [1208, "          Ref: AssessmentFunctionLogGroup\n"], [1209, "      Policies:\n"], [1210, "      - AWSLambdaBasicExecutionRole\n"], [1211, "      - S3CrudPolicy:\n"], [1212, "          BucketName:\n"], [1213, "            Ref: OutputBucket\n"], [1214, "      - S3CrudPolicy:\n"], [1215, "          BucketName:\n"], [1216, "            Ref: WorkingBucket\n"], [1217, "      - S3ReadPolicy:\n"], [1218, "          BucketName:\n"], [1219, "            Ref: InputBucket\n"], [1220, "      - S3ReadPolicy:\n"], [1221, "          BucketName:\n"], [1222, "            Ref: ConfigurationBucket\n"], [1223, "      - DynamoDBCrudPolicy:\n"], [1224, "          TableName:\n"], [1225, "            Ref: ConfigurationTable\n"], [1226, "      - Statement:\n"], [1227, "        - Effect: Allow\n"], [1228, "          Action: cloudwatch:PutMetricData\n"], [1229, "          Resource: '*'\n"], [1230, "        - Effect: Allow\n"], [1231, "          Action:\n"], [1232, "          - kms:Encrypt\n"], [1233, "          - kms:Decrypt\n"], [1234, "          - kms:ReEncrypt*\n"], [1235, "          - kms:GenerateDataKey*\n"], [1236, "          - kms:DescribeKey\n"], [1237, "          Resource:\n"], [1238, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1239, "        - Effect: Allow\n"], [1240, "          Action:\n"], [1241, "          - appsync:GraphQL\n"], [1242, "          Resource:\n"], [1243, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1244, "        - Effect: Allow\n"], [1245, "          Action: bedrock:InvokeModel\n"], [1246, "          Resource:\n"], [1247, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1248, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1249, "        - Fn::If:\n"], [1250, "          - HasGuardrailConfig\n"], [1251, "          - Effect: Allow\n"], [1252, "            Action: bedrock:ApplyGuardrail\n"], [1253, "            Resource:\n"], [1254, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1255, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1166, 1255], "resource": "AWS::Serverless::Function.AssessmentFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[1166, "  AssessmentFunction:\n"], [1167, "    Type: AWS::Serverless::Function\n"], [1168, "    Metadata:\n"], [1169, "      SamResourceId: AssessmentFunction\n"], [1170, "      cfn_nag:\n"], [1171, "        rules_to_suppress:\n"], [1172, "        - id: W89\n"], [1173, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1174, "            with AWS services via AWS APIs\n"], [1175, "        - id: W92\n"], [1176, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1177, "            to scale based on demand\n"], [1178, "        - id: W11\n"], [1179, "          reason: Cloudwatch does not support resource-level permissions, and Bedrock\n"], [1180, "            should support any enabled Bedrock model_id or inference profile\n"], [1181, "    Properties:\n"], [1182, "      PermissionsBoundary:\n"], [1183, "        Fn::If:\n"], [1184, "        - HasPermissionsBoundary\n"], [1185, "        - Ref: PermissionsBoundaryArn\n"], [1186, "        - Ref: AWS::NoValue\n"], [1187, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/6bec578bfb9f0f57df2161465d17fcd3\n"], [1188, "      Handler: index.handler\n"], [1189, "      Runtime: python3.12\n"], [1190, "      Timeout: 900\n"], [1191, "      MemorySize: 512\n"], [1192, "      Environment:\n"], [1193, "        Variables:\n"], [1194, "          METRIC_NAMESPACE:\n"], [1195, "            Ref: StackName\n"], [1196, "          CONFIGURATION_BUCKET:\n"], [1197, "            Ref: ConfigurationBucket\n"], [1198, "          CONFIGURATION_TABLE_NAME:\n"], [1199, "            Ref: ConfigurationTable\n"], [1200, "          LOG_LEVEL:\n"], [1201, "            Ref: LogLevel\n"], [1202, "          APPSYNC_API_URL:\n"], [1203, "            Ref: AppSyncApiUrl\n"], [1204, "          WORKING_BUCKET:\n"], [1205, "            Ref: WorkingBucket\n"], [1206, "      LoggingConfig:\n"], [1207, "        LogGroup:\n"], [1208, "          Ref: AssessmentFunctionLogGroup\n"], [1209, "      Policies:\n"], [1210, "      - AWSLambdaBasicExecutionRole\n"], [1211, "      - S3CrudPolicy:\n"], [1212, "          BucketName:\n"], [1213, "            Ref: OutputBucket\n"], [1214, "      - S3CrudPolicy:\n"], [1215, "          BucketName:\n"], [1216, "            Ref: WorkingBucket\n"], [1217, "      - S3ReadPolicy:\n"], [1218, "          BucketName:\n"], [1219, "            Ref: InputBucket\n"], [1220, "      - S3ReadPolicy:\n"], [1221, "          BucketName:\n"], [1222, "            Ref: ConfigurationBucket\n"], [1223, "      - DynamoDBCrudPolicy:\n"], [1224, "          TableName:\n"], [1225, "            Ref: ConfigurationTable\n"], [1226, "      - Statement:\n"], [1227, "        - Effect: Allow\n"], [1228, "          Action: cloudwatch:PutMetricData\n"], [1229, "          Resource: '*'\n"], [1230, "        - Effect: Allow\n"], [1231, "          Action:\n"], [1232, "          - kms:Encrypt\n"], [1233, "          - kms:Decrypt\n"], [1234, "          - kms:ReEncrypt*\n"], [1235, "          - kms:GenerateDataKey*\n"], [1236, "          - kms:DescribeKey\n"], [1237, "          Resource:\n"], [1238, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1239, "        - Effect: Allow\n"], [1240, "          Action:\n"], [1241, "          - appsync:GraphQL\n"], [1242, "          Resource:\n"], [1243, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1244, "        - Effect: Allow\n"], [1245, "          Action: bedrock:InvokeModel\n"], [1246, "          Resource:\n"], [1247, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1248, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1249, "        - Fn::If:\n"], [1250, "          - HasGuardrailConfig\n"], [1251, "          - Effect: Allow\n"], [1252, "            Action: bedrock:ApplyGuardrail\n"], [1253, "            Resource:\n"], [1254, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1255, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1166, 1255], "resource": "AWS::Serverless::Function.AssessmentFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[1166, "  AssessmentFunction:\n"], [1167, "    Type: AWS::Serverless::Function\n"], [1168, "    Metadata:\n"], [1169, "      SamResourceId: AssessmentFunction\n"], [1170, "      cfn_nag:\n"], [1171, "        rules_to_suppress:\n"], [1172, "        - id: W89\n"], [1173, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1174, "            with AWS services via AWS APIs\n"], [1175, "        - id: W92\n"], [1176, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1177, "            to scale based on demand\n"], [1178, "        - id: W11\n"], [1179, "          reason: Cloudwatch does not support resource-level permissions, and Bedrock\n"], [1180, "            should support any enabled Bedrock model_id or inference profile\n"], [1181, "    Properties:\n"], [1182, "      PermissionsBoundary:\n"], [1183, "        Fn::If:\n"], [1184, "        - HasPermissionsBoundary\n"], [1185, "        - Ref: PermissionsBoundaryArn\n"], [1186, "        - Ref: AWS::NoValue\n"], [1187, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/6bec578bfb9f0f57df2161465d17fcd3\n"], [1188, "      Handler: index.handler\n"], [1189, "      Runtime: python3.12\n"], [1190, "      Timeout: 900\n"], [1191, "      MemorySize: 512\n"], [1192, "      Environment:\n"], [1193, "        Variables:\n"], [1194, "          METRIC_NAMESPACE:\n"], [1195, "            Ref: StackName\n"], [1196, "          CONFIGURATION_BUCKET:\n"], [1197, "            Ref: ConfigurationBucket\n"], [1198, "          CONFIGURATION_TABLE_NAME:\n"], [1199, "            Ref: ConfigurationTable\n"], [1200, "          LOG_LEVEL:\n"], [1201, "            Ref: LogLevel\n"], [1202, "          APPSYNC_API_URL:\n"], [1203, "            Ref: AppSyncApiUrl\n"], [1204, "          WORKING_BUCKET:\n"], [1205, "            Ref: WorkingBucket\n"], [1206, "      LoggingConfig:\n"], [1207, "        LogGroup:\n"], [1208, "          Ref: AssessmentFunctionLogGroup\n"], [1209, "      Policies:\n"], [1210, "      - AWSLambdaBasicExecutionRole\n"], [1211, "      - S3CrudPolicy:\n"], [1212, "          BucketName:\n"], [1213, "            Ref: OutputBucket\n"], [1214, "      - S3CrudPolicy:\n"], [1215, "          BucketName:\n"], [1216, "            Ref: WorkingBucket\n"], [1217, "      - S3ReadPolicy:\n"], [1218, "          BucketName:\n"], [1219, "            Ref: InputBucket\n"], [1220, "      - S3ReadPolicy:\n"], [1221, "          BucketName:\n"], [1222, "            Ref: ConfigurationBucket\n"], [1223, "      - DynamoDBCrudPolicy:\n"], [1224, "          TableName:\n"], [1225, "            Ref: ConfigurationTable\n"], [1226, "      - Statement:\n"], [1227, "        - Effect: Allow\n"], [1228, "          Action: cloudwatch:PutMetricData\n"], [1229, "          Resource: '*'\n"], [1230, "        - Effect: Allow\n"], [1231, "          Action:\n"], [1232, "          - kms:Encrypt\n"], [1233, "          - kms:Decrypt\n"], [1234, "          - kms:ReEncrypt*\n"], [1235, "          - kms:GenerateDataKey*\n"], [1236, "          - kms:DescribeKey\n"], [1237, "          Resource:\n"], [1238, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1239, "        - Effect: Allow\n"], [1240, "          Action:\n"], [1241, "          - appsync:GraphQL\n"], [1242, "          Resource:\n"], [1243, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1244, "        - Effect: Allow\n"], [1245, "          Action: bedrock:InvokeModel\n"], [1246, "          Resource:\n"], [1247, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1248, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1249, "        - Fn::If:\n"], [1250, "          - HasGuardrailConfig\n"], [1251, "          - Effect: Allow\n"], [1252, "            Action: bedrock:ApplyGuardrail\n"], [1253, "            Resource:\n"], [1254, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1255, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1166, 1255], "resource": "AWS::Serverless::Function.AssessmentFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[1166, "  AssessmentFunction:\n"], [1167, "    Type: AWS::Serverless::Function\n"], [1168, "    Metadata:\n"], [1169, "      SamResourceId: AssessmentFunction\n"], [1170, "      cfn_nag:\n"], [1171, "        rules_to_suppress:\n"], [1172, "        - id: W89\n"], [1173, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1174, "            with AWS services via AWS APIs\n"], [1175, "        - id: W92\n"], [1176, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1177, "            to scale based on demand\n"], [1178, "        - id: W11\n"], [1179, "          reason: Cloudwatch does not support resource-level permissions, and Bedrock\n"], [1180, "            should support any enabled Bedrock model_id or inference profile\n"], [1181, "    Properties:\n"], [1182, "      PermissionsBoundary:\n"], [1183, "        Fn::If:\n"], [1184, "        - HasPermissionsBoundary\n"], [1185, "        - Ref: PermissionsBoundaryArn\n"], [1186, "        - Ref: AWS::NoValue\n"], [1187, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/6bec578bfb9f0f57df2161465d17fcd3\n"], [1188, "      Handler: index.handler\n"], [1189, "      Runtime: python3.12\n"], [1190, "      Timeout: 900\n"], [1191, "      MemorySize: 512\n"], [1192, "      Environment:\n"], [1193, "        Variables:\n"], [1194, "          METRIC_NAMESPACE:\n"], [1195, "            Ref: StackName\n"], [1196, "          CONFIGURATION_BUCKET:\n"], [1197, "            Ref: ConfigurationBucket\n"], [1198, "          CONFIGURATION_TABLE_NAME:\n"], [1199, "            Ref: ConfigurationTable\n"], [1200, "          LOG_LEVEL:\n"], [1201, "            Ref: LogLevel\n"], [1202, "          APPSYNC_API_URL:\n"], [1203, "            Ref: AppSyncApiUrl\n"], [1204, "          WORKING_BUCKET:\n"], [1205, "            Ref: WorkingBucket\n"], [1206, "      LoggingConfig:\n"], [1207, "        LogGroup:\n"], [1208, "          Ref: AssessmentFunctionLogGroup\n"], [1209, "      Policies:\n"], [1210, "      - AWSLambdaBasicExecutionRole\n"], [1211, "      - S3CrudPolicy:\n"], [1212, "          BucketName:\n"], [1213, "            Ref: OutputBucket\n"], [1214, "      - S3CrudPolicy:\n"], [1215, "          BucketName:\n"], [1216, "            Ref: WorkingBucket\n"], [1217, "      - S3ReadPolicy:\n"], [1218, "          BucketName:\n"], [1219, "            Ref: InputBucket\n"], [1220, "      - S3ReadPolicy:\n"], [1221, "          BucketName:\n"], [1222, "            Ref: ConfigurationBucket\n"], [1223, "      - DynamoDBCrudPolicy:\n"], [1224, "          TableName:\n"], [1225, "            Ref: ConfigurationTable\n"], [1226, "      - Statement:\n"], [1227, "        - Effect: Allow\n"], [1228, "          Action: cloudwatch:PutMetricData\n"], [1229, "          Resource: '*'\n"], [1230, "        - Effect: Allow\n"], [1231, "          Action:\n"], [1232, "          - kms:Encrypt\n"], [1233, "          - kms:Decrypt\n"], [1234, "          - kms:ReEncrypt*\n"], [1235, "          - kms:GenerateDataKey*\n"], [1236, "          - kms:DescribeKey\n"], [1237, "          Resource:\n"], [1238, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1239, "        - Effect: Allow\n"], [1240, "          Action:\n"], [1241, "          - appsync:GraphQL\n"], [1242, "          Resource:\n"], [1243, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1244, "        - Effect: Allow\n"], [1245, "          Action: bedrock:InvokeModel\n"], [1246, "          Resource:\n"], [1247, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1248, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1249, "        - Fn::If:\n"], [1250, "          - HasGuardrailConfig\n"], [1251, "          - Effect: Allow\n"], [1252, "            Action: bedrock:ApplyGuardrail\n"], [1253, "            Resource:\n"], [1254, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1255, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1166, 1255], "resource": "AWS::Serverless::Function.AssessmentFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[1267, "  ProcessResultsFunction:\n"], [1268, "    Type: AWS::Serverless::Function\n"], [1269, "    Metadata:\n"], [1270, "      SamResourceId: ProcessResultsFunction\n"], [1271, "      cfn_nag:\n"], [1272, "        rules_to_suppress:\n"], [1273, "        - id: W11\n"], [1274, "          reason: Cloudwatch does not support resource-level permissions\n"], [1275, "        - id: W89\n"], [1276, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1277, "            with AWS services via AWS APIs\n"], [1278, "        - id: W92\n"], [1279, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1280, "            to scale based on demand\n"], [1281, "    Properties:\n"], [1282, "      PermissionsBoundary:\n"], [1283, "        Fn::If:\n"], [1284, "        - HasPermissionsBoundary\n"], [1285, "        - Ref: PermissionsBoundaryArn\n"], [1286, "        - Ref: AWS::NoValue\n"], [1287, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/e9539c47c95c711353a09b757b9b8dc7\n"], [1288, "      Handler: index.handler\n"], [1289, "      Runtime: python3.12\n"], [1290, "      Timeout: 900\n"], [1291, "      MemorySize: 4096\n"], [1292, "      Environment:\n"], [1293, "        Variables:\n"], [1294, "          METRIC_NAMESPACE:\n"], [1295, "            Ref: StackName\n"], [1296, "          LOG_LEVEL:\n"], [1297, "            Ref: LogLevel\n"], [1298, "          APPSYNC_API_URL:\n"], [1299, "            Ref: AppSyncApiUrl\n"], [1300, "          WORKING_BUCKET:\n"], [1301, "            Ref: WorkingBucket\n"], [1302, "      LoggingConfig:\n"], [1303, "        LogGroup:\n"], [1304, "          Ref: ProcessResultsFunctionLogGroup\n"], [1305, "      Policies:\n"], [1306, "      - AWSLambdaBasicExecutionRole\n"], [1307, "      - S3ReadPolicy:\n"], [1308, "          BucketName:\n"], [1309, "            Ref: InputBucket\n"], [1310, "      - S3CrudPolicy:\n"], [1311, "          BucketName:\n"], [1312, "            Ref: OutputBucket\n"], [1313, "      - S3CrudPolicy:\n"], [1314, "          BucketName:\n"], [1315, "            Ref: WorkingBucket\n"], [1316, "      - Statement:\n"], [1317, "        - Effect: Allow\n"], [1318, "          Action: cloudwatch:PutMetricData\n"], [1319, "          Resource: '*'\n"], [1320, "        - Effect: Allow\n"], [1321, "          Action:\n"], [1322, "          - kms:Encrypt\n"], [1323, "          - kms:Decrypt\n"], [1324, "          - kms:ReEncrypt*\n"], [1325, "          - kms:GenerateDataKey*\n"], [1326, "          - kms:DescribeKey\n"], [1327, "          Resource:\n"], [1328, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1329, "        - Effect: Allow\n"], [1330, "          Action:\n"], [1331, "          - appsync:GraphQL\n"], [1332, "          Resource:\n"], [1333, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1267, 1333], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[1267, "  ProcessResultsFunction:\n"], [1268, "    Type: AWS::Serverless::Function\n"], [1269, "    Metadata:\n"], [1270, "      SamResourceId: ProcessResultsFunction\n"], [1271, "      cfn_nag:\n"], [1272, "        rules_to_suppress:\n"], [1273, "        - id: W11\n"], [1274, "          reason: Cloudwatch does not support resource-level permissions\n"], [1275, "        - id: W89\n"], [1276, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1277, "            with AWS services via AWS APIs\n"], [1278, "        - id: W92\n"], [1279, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1280, "            to scale based on demand\n"], [1281, "    Properties:\n"], [1282, "      PermissionsBoundary:\n"], [1283, "        Fn::If:\n"], [1284, "        - HasPermissionsBoundary\n"], [1285, "        - Ref: PermissionsBoundaryArn\n"], [1286, "        - Ref: AWS::NoValue\n"], [1287, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/e9539c47c95c711353a09b757b9b8dc7\n"], [1288, "      Handler: index.handler\n"], [1289, "      Runtime: python3.12\n"], [1290, "      Timeout: 900\n"], [1291, "      MemorySize: 4096\n"], [1292, "      Environment:\n"], [1293, "        Variables:\n"], [1294, "          METRIC_NAMESPACE:\n"], [1295, "            Ref: StackName\n"], [1296, "          LOG_LEVEL:\n"], [1297, "            Ref: LogLevel\n"], [1298, "          APPSYNC_API_URL:\n"], [1299, "            Ref: AppSyncApiUrl\n"], [1300, "          WORKING_BUCKET:\n"], [1301, "            Ref: WorkingBucket\n"], [1302, "      LoggingConfig:\n"], [1303, "        LogGroup:\n"], [1304, "          Ref: ProcessResultsFunctionLogGroup\n"], [1305, "      Policies:\n"], [1306, "      - AWSLambdaBasicExecutionRole\n"], [1307, "      - S3ReadPolicy:\n"], [1308, "          BucketName:\n"], [1309, "            Ref: InputBucket\n"], [1310, "      - S3CrudPolicy:\n"], [1311, "          BucketName:\n"], [1312, "            Ref: OutputBucket\n"], [1313, "      - S3CrudPolicy:\n"], [1314, "          BucketName:\n"], [1315, "            Ref: WorkingBucket\n"], [1316, "      - Statement:\n"], [1317, "        - Effect: Allow\n"], [1318, "          Action: cloudwatch:PutMetricData\n"], [1319, "          Resource: '*'\n"], [1320, "        - Effect: Allow\n"], [1321, "          Action:\n"], [1322, "          - kms:Encrypt\n"], [1323, "          - kms:Decrypt\n"], [1324, "          - kms:ReEncrypt*\n"], [1325, "          - kms:GenerateDataKey*\n"], [1326, "          - kms:DescribeKey\n"], [1327, "          Resource:\n"], [1328, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1329, "        - Effect: Allow\n"], [1330, "          Action:\n"], [1331, "          - appsync:GraphQL\n"], [1332, "          Resource:\n"], [1333, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1267, 1333], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[1267, "  ProcessResultsFunction:\n"], [1268, "    Type: AWS::Serverless::Function\n"], [1269, "    Metadata:\n"], [1270, "      SamResourceId: ProcessResultsFunction\n"], [1271, "      cfn_nag:\n"], [1272, "        rules_to_suppress:\n"], [1273, "        - id: W11\n"], [1274, "          reason: Cloudwatch does not support resource-level permissions\n"], [1275, "        - id: W89\n"], [1276, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1277, "            with AWS services via AWS APIs\n"], [1278, "        - id: W92\n"], [1279, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1280, "            to scale based on demand\n"], [1281, "    Properties:\n"], [1282, "      PermissionsBoundary:\n"], [1283, "        Fn::If:\n"], [1284, "        - HasPermissionsBoundary\n"], [1285, "        - Ref: PermissionsBoundaryArn\n"], [1286, "        - Ref: AWS::NoValue\n"], [1287, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/e9539c47c95c711353a09b757b9b8dc7\n"], [1288, "      Handler: index.handler\n"], [1289, "      Runtime: python3.12\n"], [1290, "      Timeout: 900\n"], [1291, "      MemorySize: 4096\n"], [1292, "      Environment:\n"], [1293, "        Variables:\n"], [1294, "          METRIC_NAMESPACE:\n"], [1295, "            Ref: StackName\n"], [1296, "          LOG_LEVEL:\n"], [1297, "            Ref: LogLevel\n"], [1298, "          APPSYNC_API_URL:\n"], [1299, "            Ref: AppSyncApiUrl\n"], [1300, "          WORKING_BUCKET:\n"], [1301, "            Ref: WorkingBucket\n"], [1302, "      LoggingConfig:\n"], [1303, "        LogGroup:\n"], [1304, "          Ref: ProcessResultsFunctionLogGroup\n"], [1305, "      Policies:\n"], [1306, "      - AWSLambdaBasicExecutionRole\n"], [1307, "      - S3ReadPolicy:\n"], [1308, "          BucketName:\n"], [1309, "            Ref: InputBucket\n"], [1310, "      - S3CrudPolicy:\n"], [1311, "          BucketName:\n"], [1312, "            Ref: OutputBucket\n"], [1313, "      - S3CrudPolicy:\n"], [1314, "          BucketName:\n"], [1315, "            Ref: WorkingBucket\n"], [1316, "      - Statement:\n"], [1317, "        - Effect: Allow\n"], [1318, "          Action: cloudwatch:PutMetricData\n"], [1319, "          Resource: '*'\n"], [1320, "        - Effect: Allow\n"], [1321, "          Action:\n"], [1322, "          - kms:Encrypt\n"], [1323, "          - kms:Decrypt\n"], [1324, "          - kms:ReEncrypt*\n"], [1325, "          - kms:GenerateDataKey*\n"], [1326, "          - kms:DescribeKey\n"], [1327, "          Resource:\n"], [1328, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1329, "        - Effect: Allow\n"], [1330, "          Action:\n"], [1331, "          - appsync:GraphQL\n"], [1332, "          Resource:\n"], [1333, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1267, 1333], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[1267, "  ProcessResultsFunction:\n"], [1268, "    Type: AWS::Serverless::Function\n"], [1269, "    Metadata:\n"], [1270, "      SamResourceId: ProcessResultsFunction\n"], [1271, "      cfn_nag:\n"], [1272, "        rules_to_suppress:\n"], [1273, "        - id: W11\n"], [1274, "          reason: Cloudwatch does not support resource-level permissions\n"], [1275, "        - id: W89\n"], [1276, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1277, "            with AWS services via AWS APIs\n"], [1278, "        - id: W92\n"], [1279, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1280, "            to scale based on demand\n"], [1281, "    Properties:\n"], [1282, "      PermissionsBoundary:\n"], [1283, "        Fn::If:\n"], [1284, "        - HasPermissionsBoundary\n"], [1285, "        - Ref: PermissionsBoundaryArn\n"], [1286, "        - Ref: AWS::NoValue\n"], [1287, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/e9539c47c95c711353a09b757b9b8dc7\n"], [1288, "      Handler: index.handler\n"], [1289, "      Runtime: python3.12\n"], [1290, "      Timeout: 900\n"], [1291, "      MemorySize: 4096\n"], [1292, "      Environment:\n"], [1293, "        Variables:\n"], [1294, "          METRIC_NAMESPACE:\n"], [1295, "            Ref: StackName\n"], [1296, "          LOG_LEVEL:\n"], [1297, "            Ref: LogLevel\n"], [1298, "          APPSYNC_API_URL:\n"], [1299, "            Ref: AppSyncApiUrl\n"], [1300, "          WORKING_BUCKET:\n"], [1301, "            Ref: WorkingBucket\n"], [1302, "      LoggingConfig:\n"], [1303, "        LogGroup:\n"], [1304, "          Ref: ProcessResultsFunctionLogGroup\n"], [1305, "      Policies:\n"], [1306, "      - AWSLambdaBasicExecutionRole\n"], [1307, "      - S3ReadPolicy:\n"], [1308, "          BucketName:\n"], [1309, "            Ref: InputBucket\n"], [1310, "      - S3CrudPolicy:\n"], [1311, "          BucketName:\n"], [1312, "            Ref: OutputBucket\n"], [1313, "      - S3CrudPolicy:\n"], [1314, "          BucketName:\n"], [1315, "            Ref: WorkingBucket\n"], [1316, "      - Statement:\n"], [1317, "        - Effect: Allow\n"], [1318, "          Action: cloudwatch:PutMetricData\n"], [1319, "          Resource: '*'\n"], [1320, "        - Effect: Allow\n"], [1321, "          Action:\n"], [1322, "          - kms:Encrypt\n"], [1323, "          - kms:Decrypt\n"], [1324, "          - kms:ReEncrypt*\n"], [1325, "          - kms:GenerateDataKey*\n"], [1326, "          - kms:DescribeKey\n"], [1327, "          Resource:\n"], [1328, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1329, "        - Effect: Allow\n"], [1330, "          Action:\n"], [1331, "          - appsync:GraphQL\n"], [1332, "          Resource:\n"], [1333, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1267, 1333], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[1345, "  SummarizationFunction:\n"], [1346, "    Type: AWS::Serverless::Function\n"], [1347, "    Metadata:\n"], [1348, "      SamResourceId: SummarizationFunction\n"], [1349, "      cfn_nag:\n"], [1350, "        rules_to_suppress:\n"], [1351, "        - id: W11\n"], [1352, "          reason: Cloudwatch does not support resource-level permissions\n"], [1353, "        - id: W89\n"], [1354, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1355, "            with AWS services via AWS APIs\n"], [1356, "        - id: W92\n"], [1357, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1358, "            to scale based on demand\n"], [1359, "    Properties:\n"], [1360, "      PermissionsBoundary:\n"], [1361, "        Fn::If:\n"], [1362, "        - HasPermissionsBoundary\n"], [1363, "        - Ref: PermissionsBoundaryArn\n"], [1364, "        - Ref: AWS::NoValue\n"], [1365, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/13ef51396fcb64ff363076ef9bb385ee\n"], [1366, "      Handler: index.handler\n"], [1367, "      Runtime: python3.12\n"], [1368, "      Timeout: 900\n"], [1369, "      MemorySize: 4096\n"], [1370, "      Environment:\n"], [1371, "        Variables:\n"], [1372, "          METRIC_NAMESPACE:\n"], [1373, "            Ref: StackName\n"], [1374, "          CONFIGURATION_TABLE_NAME:\n"], [1375, "            Ref: ConfigurationTable\n"], [1376, "          GUARDRAIL_ID_AND_VERSION:\n"], [1377, "            Fn::If:\n"], [1378, "            - HasGuardrailConfig\n"], [1379, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1380, "            - ''\n"], [1381, "          LOG_LEVEL:\n"], [1382, "            Ref: LogLevel\n"], [1383, "          APPSYNC_API_URL:\n"], [1384, "            Ref: AppSyncApiUrl\n"], [1385, "          WORKING_BUCKET:\n"], [1386, "            Ref: WorkingBucket\n"], [1387, "      LoggingConfig:\n"], [1388, "        LogGroup:\n"], [1389, "          Ref: SummarizationFunctionLogGroup\n"], [1390, "      Policies:\n"], [1391, "      - AWSLambdaBasicExecutionRole\n"], [1392, "      - S3ReadPolicy:\n"], [1393, "          BucketName:\n"], [1394, "            Ref: InputBucket\n"], [1395, "      - S3CrudPolicy:\n"], [1396, "          BucketName:\n"], [1397, "            Ref: OutputBucket\n"], [1398, "      - S3CrudPolicy:\n"], [1399, "          BucketName:\n"], [1400, "            Ref: WorkingBucket\n"], [1401, "      - DynamoDBCrudPolicy:\n"], [1402, "          TableName:\n"], [1403, "            Ref: ConfigurationTable\n"], [1404, "      - Statement:\n"], [1405, "        - Effect: Allow\n"], [1406, "          Action: cloudwatch:PutMetricData\n"], [1407, "          Resource: '*'\n"], [1408, "        - Effect: Allow\n"], [1409, "          Action:\n"], [1410, "          - kms:Encrypt\n"], [1411, "          - kms:Decrypt\n"], [1412, "          - kms:ReEncrypt*\n"], [1413, "          - kms:GenerateDataKey*\n"], [1414, "          - kms:DescribeKey\n"], [1415, "          Resource:\n"], [1416, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1417, "        - Effect: Allow\n"], [1418, "          Action: bedrock:InvokeModel\n"], [1419, "          Resource:\n"], [1420, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1421, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1422, "        - Effect: Allow\n"], [1423, "          Action:\n"], [1424, "          - appsync:GraphQL\n"], [1425, "          Resource:\n"], [1426, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1427, "        - Fn::If:\n"], [1428, "          - HasGuardrailConfig\n"], [1429, "          - Effect: Allow\n"], [1430, "            Action: bedrock:ApplyGuardrail\n"], [1431, "            Resource:\n"], [1432, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1433, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1345, 1433], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[1345, "  SummarizationFunction:\n"], [1346, "    Type: AWS::Serverless::Function\n"], [1347, "    Metadata:\n"], [1348, "      SamResourceId: SummarizationFunction\n"], [1349, "      cfn_nag:\n"], [1350, "        rules_to_suppress:\n"], [1351, "        - id: W11\n"], [1352, "          reason: Cloudwatch does not support resource-level permissions\n"], [1353, "        - id: W89\n"], [1354, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1355, "            with AWS services via AWS APIs\n"], [1356, "        - id: W92\n"], [1357, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1358, "            to scale based on demand\n"], [1359, "    Properties:\n"], [1360, "      PermissionsBoundary:\n"], [1361, "        Fn::If:\n"], [1362, "        - HasPermissionsBoundary\n"], [1363, "        - Ref: PermissionsBoundaryArn\n"], [1364, "        - Ref: AWS::NoValue\n"], [1365, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/13ef51396fcb64ff363076ef9bb385ee\n"], [1366, "      Handler: index.handler\n"], [1367, "      Runtime: python3.12\n"], [1368, "      Timeout: 900\n"], [1369, "      MemorySize: 4096\n"], [1370, "      Environment:\n"], [1371, "        Variables:\n"], [1372, "          METRIC_NAMESPACE:\n"], [1373, "            Ref: StackName\n"], [1374, "          CONFIGURATION_TABLE_NAME:\n"], [1375, "            Ref: ConfigurationTable\n"], [1376, "          GUARDRAIL_ID_AND_VERSION:\n"], [1377, "            Fn::If:\n"], [1378, "            - HasGuardrailConfig\n"], [1379, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1380, "            - ''\n"], [1381, "          LOG_LEVEL:\n"], [1382, "            Ref: LogLevel\n"], [1383, "          APPSYNC_API_URL:\n"], [1384, "            Ref: AppSyncApiUrl\n"], [1385, "          WORKING_BUCKET:\n"], [1386, "            Ref: WorkingBucket\n"], [1387, "      LoggingConfig:\n"], [1388, "        LogGroup:\n"], [1389, "          Ref: SummarizationFunctionLogGroup\n"], [1390, "      Policies:\n"], [1391, "      - AWSLambdaBasicExecutionRole\n"], [1392, "      - S3ReadPolicy:\n"], [1393, "          BucketName:\n"], [1394, "            Ref: InputBucket\n"], [1395, "      - S3CrudPolicy:\n"], [1396, "          BucketName:\n"], [1397, "            Ref: OutputBucket\n"], [1398, "      - S3CrudPolicy:\n"], [1399, "          BucketName:\n"], [1400, "            Ref: WorkingBucket\n"], [1401, "      - DynamoDBCrudPolicy:\n"], [1402, "          TableName:\n"], [1403, "            Ref: ConfigurationTable\n"], [1404, "      - Statement:\n"], [1405, "        - Effect: Allow\n"], [1406, "          Action: cloudwatch:PutMetricData\n"], [1407, "          Resource: '*'\n"], [1408, "        - Effect: Allow\n"], [1409, "          Action:\n"], [1410, "          - kms:Encrypt\n"], [1411, "          - kms:Decrypt\n"], [1412, "          - kms:ReEncrypt*\n"], [1413, "          - kms:GenerateDataKey*\n"], [1414, "          - kms:DescribeKey\n"], [1415, "          Resource:\n"], [1416, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1417, "        - Effect: Allow\n"], [1418, "          Action: bedrock:InvokeModel\n"], [1419, "          Resource:\n"], [1420, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1421, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1422, "        - Effect: Allow\n"], [1423, "          Action:\n"], [1424, "          - appsync:GraphQL\n"], [1425, "          Resource:\n"], [1426, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1427, "        - Fn::If:\n"], [1428, "          - HasGuardrailConfig\n"], [1429, "          - Effect: Allow\n"], [1430, "            Action: bedrock:ApplyGuardrail\n"], [1431, "            Resource:\n"], [1432, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1433, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1345, 1433], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[1345, "  SummarizationFunction:\n"], [1346, "    Type: AWS::Serverless::Function\n"], [1347, "    Metadata:\n"], [1348, "      SamResourceId: SummarizationFunction\n"], [1349, "      cfn_nag:\n"], [1350, "        rules_to_suppress:\n"], [1351, "        - id: W11\n"], [1352, "          reason: Cloudwatch does not support resource-level permissions\n"], [1353, "        - id: W89\n"], [1354, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1355, "            with AWS services via AWS APIs\n"], [1356, "        - id: W92\n"], [1357, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1358, "            to scale based on demand\n"], [1359, "    Properties:\n"], [1360, "      PermissionsBoundary:\n"], [1361, "        Fn::If:\n"], [1362, "        - HasPermissionsBoundary\n"], [1363, "        - Ref: PermissionsBoundaryArn\n"], [1364, "        - Ref: AWS::NoValue\n"], [1365, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/13ef51396fcb64ff363076ef9bb385ee\n"], [1366, "      Handler: index.handler\n"], [1367, "      Runtime: python3.12\n"], [1368, "      Timeout: 900\n"], [1369, "      MemorySize: 4096\n"], [1370, "      Environment:\n"], [1371, "        Variables:\n"], [1372, "          METRIC_NAMESPACE:\n"], [1373, "            Ref: StackName\n"], [1374, "          CONFIGURATION_TABLE_NAME:\n"], [1375, "            Ref: ConfigurationTable\n"], [1376, "          GUARDRAIL_ID_AND_VERSION:\n"], [1377, "            Fn::If:\n"], [1378, "            - HasGuardrailConfig\n"], [1379, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1380, "            - ''\n"], [1381, "          LOG_LEVEL:\n"], [1382, "            Ref: LogLevel\n"], [1383, "          APPSYNC_API_URL:\n"], [1384, "            Ref: AppSyncApiUrl\n"], [1385, "          WORKING_BUCKET:\n"], [1386, "            Ref: WorkingBucket\n"], [1387, "      LoggingConfig:\n"], [1388, "        LogGroup:\n"], [1389, "          Ref: SummarizationFunctionLogGroup\n"], [1390, "      Policies:\n"], [1391, "      - AWSLambdaBasicExecutionRole\n"], [1392, "      - S3ReadPolicy:\n"], [1393, "          BucketName:\n"], [1394, "            Ref: InputBucket\n"], [1395, "      - S3CrudPolicy:\n"], [1396, "          BucketName:\n"], [1397, "            Ref: OutputBucket\n"], [1398, "      - S3CrudPolicy:\n"], [1399, "          BucketName:\n"], [1400, "            Ref: WorkingBucket\n"], [1401, "      - DynamoDBCrudPolicy:\n"], [1402, "          TableName:\n"], [1403, "            Ref: ConfigurationTable\n"], [1404, "      - Statement:\n"], [1405, "        - Effect: Allow\n"], [1406, "          Action: cloudwatch:PutMetricData\n"], [1407, "          Resource: '*'\n"], [1408, "        - Effect: Allow\n"], [1409, "          Action:\n"], [1410, "          - kms:Encrypt\n"], [1411, "          - kms:Decrypt\n"], [1412, "          - kms:ReEncrypt*\n"], [1413, "          - kms:GenerateDataKey*\n"], [1414, "          - kms:DescribeKey\n"], [1415, "          Resource:\n"], [1416, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1417, "        - Effect: Allow\n"], [1418, "          Action: bedrock:InvokeModel\n"], [1419, "          Resource:\n"], [1420, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1421, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1422, "        - Effect: Allow\n"], [1423, "          Action:\n"], [1424, "          - appsync:GraphQL\n"], [1425, "          Resource:\n"], [1426, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1427, "        - Fn::If:\n"], [1428, "          - HasGuardrailConfig\n"], [1429, "          - Effect: Allow\n"], [1430, "            Action: bedrock:ApplyGuardrail\n"], [1431, "            Resource:\n"], [1432, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1433, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1345, 1433], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[1345, "  SummarizationFunction:\n"], [1346, "    Type: AWS::Serverless::Function\n"], [1347, "    Metadata:\n"], [1348, "      SamResourceId: SummarizationFunction\n"], [1349, "      cfn_nag:\n"], [1350, "        rules_to_suppress:\n"], [1351, "        - id: W11\n"], [1352, "          reason: Cloudwatch does not support resource-level permissions\n"], [1353, "        - id: W89\n"], [1354, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1355, "            with AWS services via AWS APIs\n"], [1356, "        - id: W92\n"], [1357, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1358, "            to scale based on demand\n"], [1359, "    Properties:\n"], [1360, "      PermissionsBoundary:\n"], [1361, "        Fn::If:\n"], [1362, "        - HasPermissionsBoundary\n"], [1363, "        - Ref: PermissionsBoundaryArn\n"], [1364, "        - Ref: AWS::NoValue\n"], [1365, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/13ef51396fcb64ff363076ef9bb385ee\n"], [1366, "      Handler: index.handler\n"], [1367, "      Runtime: python3.12\n"], [1368, "      Timeout: 900\n"], [1369, "      MemorySize: 4096\n"], [1370, "      Environment:\n"], [1371, "        Variables:\n"], [1372, "          METRIC_NAMESPACE:\n"], [1373, "            Ref: StackName\n"], [1374, "          CONFIGURATION_TABLE_NAME:\n"], [1375, "            Ref: ConfigurationTable\n"], [1376, "          GUARDRAIL_ID_AND_VERSION:\n"], [1377, "            Fn::If:\n"], [1378, "            - HasGuardrailConfig\n"], [1379, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1380, "            - ''\n"], [1381, "          LOG_LEVEL:\n"], [1382, "            Ref: LogLevel\n"], [1383, "          APPSYNC_API_URL:\n"], [1384, "            Ref: AppSyncApiUrl\n"], [1385, "          WORKING_BUCKET:\n"], [1386, "            Ref: WorkingBucket\n"], [1387, "      LoggingConfig:\n"], [1388, "        LogGroup:\n"], [1389, "          Ref: SummarizationFunctionLogGroup\n"], [1390, "      Policies:\n"], [1391, "      - AWSLambdaBasicExecutionRole\n"], [1392, "      - S3ReadPolicy:\n"], [1393, "          BucketName:\n"], [1394, "            Ref: InputBucket\n"], [1395, "      - S3CrudPolicy:\n"], [1396, "          BucketName:\n"], [1397, "            Ref: OutputBucket\n"], [1398, "      - S3CrudPolicy:\n"], [1399, "          BucketName:\n"], [1400, "            Ref: WorkingBucket\n"], [1401, "      - DynamoDBCrudPolicy:\n"], [1402, "          TableName:\n"], [1403, "            Ref: ConfigurationTable\n"], [1404, "      - Statement:\n"], [1405, "        - Effect: Allow\n"], [1406, "          Action: cloudwatch:PutMetricData\n"], [1407, "          Resource: '*'\n"], [1408, "        - Effect: Allow\n"], [1409, "          Action:\n"], [1410, "          - kms:Encrypt\n"], [1411, "          - kms:Decrypt\n"], [1412, "          - kms:ReEncrypt*\n"], [1413, "          - kms:GenerateDataKey*\n"], [1414, "          - kms:DescribeKey\n"], [1415, "          Resource:\n"], [1416, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1417, "        - Effect: Allow\n"], [1418, "          Action: bedrock:InvokeModel\n"], [1419, "          Resource:\n"], [1420, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1421, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1422, "        - Effect: Allow\n"], [1423, "          Action:\n"], [1424, "          - appsync:GraphQL\n"], [1425, "          Resource:\n"], [1426, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1427, "        - Fn::If:\n"], [1428, "          - HasGuardrailConfig\n"], [1429, "          - Effect: Allow\n"], [1430, "            Action: bedrock:ApplyGuardrail\n"], [1431, "            Resource:\n"], [1432, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1433, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1345, 1433], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-3/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}]}, "summary": {"passed": 26, "failed": 24, "skipped": 0, "parsing_errors": 0, "resource_count": 18, "checkov_version": "3.2.461"}}