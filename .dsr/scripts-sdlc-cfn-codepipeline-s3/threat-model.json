[
  {
    "id": "IDP-SDLC-DEPLOY-PIPELINE-THREAT-001",
    "stack": "idp-sdlc-deploy-pipeline",
    "stride_category": "Elevation of Privilege",
    "severity": "High",
    "resource_type": "AWS::IAM::Role",
    "resource_name": "CodeBuildRole",
    "title": "Overly Permissive IAM Role",
    "issue": "The CodeBuildRole has the AWS ReadOnlyAccess managed policy attached, which provides unnecessary broad read access across all AWS services, violating the principle of least privilege.",
    "attack_vector": "If the CodeBuild execution environment is compromised, an attacker could leverage these excessive permissions to enumerate all resources across the AWS account, facilitating further attack planning.",
    "impact": "Unauthorized access to sensitive information across the entire AWS account, potentially exposing configuration details, secrets, and infrastructure layout.",
    "remediation": "Replace the ReadOnlyAccess managed policy with a custom policy that grants only the specific read permissions required for the deployment process. Remove unnecessary service permissions that aren't needed for the deployment workflow.",
    "priority": 1,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-272",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.16", "AWS Well-Architected Framework - Security Pillar"],
    "references": ["https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege"],
    "status": "Open"
  },
  {
    "id": "IDP-SDLC-DEPLOY-PIPELINE-THREAT-002",
    "stack": "idp-sdlc-deploy-pipeline",
    "stride_category": "Elevation of Privilege",
    "severity": "High",
    "resource_type": "AWS::IAM::Policy",
    "resource_name": "CodeBuildLogsPolicy",
    "title": "Overly Permissive CloudWatch Logs Permissions",
    "issue": "The CodeBuildLogsPolicy grants unlimited permissions to create logs with a wildcard resource ('*'), allowing the role to create and write logs for any service or resource in the account.",
    "attack_vector": "An attacker who compromises the CodeBuild environment could create excessive log groups or streams, potentially causing resource exhaustion or using logs as a persistence mechanism.",
    "impact": "Potential for log pollution, denial of service via resource exhaustion, or hiding malicious activity within legitimate logging infrastructure.",
    "remediation": "Scope down the logs permissions to specific log groups using a more restrictive resource pattern like 'arn:aws:logs:*:*:log-group:/aws/codebuild/*'.",
    "priority": 2,
    "estimated_effort": "Low",
    "cwe_id": "CWE-732",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.16"],
    "references": ["https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/iam-access-control-overview-for-cloudwatch-logs.html"],
    "status": "Open"
  },
  {
    "id": "IDP-SDLC-DEPLOY-PIPELINE-THREAT-003",
    "stack": "idp-sdlc-deploy-pipeline",
    "stride_category": "Tampering",
    "severity": "Medium",
    "resource_type": "AWS::S3::Bucket",
    "resource_name": "ArtifactBucket",
    "title": "Missing Server-Side Encryption Configuration",
    "issue": "The ArtifactBucket does not explicitly configure server-side encryption, relying instead on default S3 encryption as noted in the metadata comments. This may not meet organizational security requirements for sensitive deployment artifacts.",
    "attack_vector": "If S3 default encryption is disabled at the account level or set to an insufficient encryption algorithm, sensitive deployment artifacts could be stored without proper encryption.",
    "impact": "Potential exposure of sensitive code or configuration data if the bucket is compromised or if S3 permissions are accidentally modified.",
    "remediation": "Explicitly configure server-side encryption using SSE-KMS with a customer-managed KMS key and specify a strong encryption algorithm.",
    "priority": 3,
    "estimated_effort": "Low",
    "cwe_id": "CWE-311",
    "compliance_violations": ["CIS AWS Foundations Benchmark 2.1.1", "PCI DSS 3.2.1"],
    "references": ["https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html"],
    "status": "Open"
  },
  {
    "id": "IDP-SDLC-DEPLOY-PIPELINE-THREAT-004",
    "stack": "idp-sdlc-deploy-pipeline",
    "stride_category": "Repudiation",
    "severity": "Medium",
    "resource_type": "AWS::S3::Bucket",
    "resource_name": "ArtifactBucket",
    "title": "Missing S3 Access Logging",
    "issue": "The ArtifactBucket has access logging explicitly disabled via a cfn_nag rule suppression. Even for temporary deployment artifacts, access logging is important for security auditing and forensics.",
    "attack_vector": "Without access logging, unauthorized access to deployment artifacts or modifications to pipeline code cannot be properly tracked and audited.",
    "impact": "Loss of audit trail for security investigations, compliance violations, and inability to detect unauthorized access to deployment assets.",
    "remediation": "Enable access logging for the ArtifactBucket by configuring the LoggingConfiguration property to send logs to a separate, secure logging bucket.",
    "priority": 3,
    "estimated_effort": "Low",
    "cwe_id": "CWE-778",
    "compliance_violations": ["CIS AWS Foundations Benchmark 2.6", "SOC 2 CC5.2"],
    "references": ["https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html"],
    "status": "Open"
  },
  {
    "id": "IDP-SDLC-DEPLOY-PIPELINE-THREAT-005",
    "stack": "idp-sdlc-deploy-pipeline",
    "stride_category": "Elevation of Privilege",
    "severity": "Medium",
    "resource_type": "AWS::IAM::Role",
    "resource_name": "CodeBuildRole",
    "title": "Unrestricted AssumeRole Permission",
    "issue": "The CodeBuildRole policy includes 'sts:AssumeRole' permission with a wildcard resource ('*'), allowing the role to assume any role in the account or potentially in other accounts.",
    "attack_vector": "An attacker who compromises the CodeBuild environment could attempt to assume other roles with higher privileges within the AWS account.",
    "impact": "Potential for privilege escalation and unauthorized access to resources outside the intended scope of the deployment pipeline.",
    "remediation": "Restrict the sts:AssumeRole permission to only specific roles that need to be assumed during the deployment process using explicit ARNs instead of wildcards.",
    "priority": 2,
    "estimated_effort": "Low",
    "cwe_id": "CWE-269",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.16"],
    "references": ["https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_permissions-to-switch.html"],
    "status": "Open"
  },
  {
    "id": "IDP-SDLC-DEPLOY-PIPELINE-THREAT-006",
    "stack": "idp-sdlc-deploy-pipeline",
    "stride_category": "Tampering",
    "severity": "Medium",
    "resource_type": "AWS::CodeBuild::Project",
    "resource_name": "IdkInstallCodeBuild",
    "title": "Insecure Build Environment Configuration",
    "issue": "The CodeBuild project uses a standard build environment without specific security hardening and executes scripts with access to AWS credentials that could potentially contain malicious code.",
    "attack_vector": "If the source code repository is compromised or contains malicious scripts, these could execute with the CodeBuild role permissions during the build process.",
    "impact": "Execution of unauthorized code within the AWS account context, potentially leading to data exfiltration or resource manipulation.",
    "remediation": "Implement stricter code review processes, use VPC isolation for CodeBuild projects, and consider implementing automated security scanning of build scripts before execution.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-94",
    "compliance_violations": ["OWASP Top 10 A1:2017-Injection"],
    "references": ["https://docs.aws.amazon.com/codebuild/latest/userguide/vpc-support.html"],
    "status": "Open"
  },
  {
    "id": "IDP-SDLC-DEPLOY-PIPELINE-THREAT-007",
    "stack": "idp-sdlc-deploy-pipeline",
    "stride_category": "Information Disclosure",
    "severity": "Low",
    "resource_type": "AWS::CodeBuild::Project",
    "resource_name": "IdkInstallCodeBuild",
    "title": "Potential Sensitive Data Exposure in Build Logs",
    "issue": "The buildspec includes commands that may output sensitive information (such as environment variables or configuration data) to build logs which are retained and potentially accessible to users with CloudWatch Logs access.",
    "attack_vector": "An authorized user with CloudWatch Logs access could retrieve sensitive information from build logs that may include credentials, configuration details, or other sensitive data.",
    "impact": "Exposure of sensitive information that could aid in further attacks or lead to unauthorized access to systems.",
    "remediation": "Implement log filtering to mask sensitive values, review build scripts to ensure they don't output sensitive data, and set appropriate CloudWatch Logs retention periods.",
    "priority": 4,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-532",
    "compliance_violations": ["PCI DSS 3.2.1 Requirement 8.2"],
    "references": ["https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/mask-sensitive-log-data.html"],
    "status": "Open"
  },
  {
    "id": "IDP-SDLC-DEPLOY-PIPELINE-THREAT-008",
    "stack": "idp-sdlc-deploy-pipeline",
    "stride_category": "Denial of Service",
    "severity": "Low",
    "resource_type": "AWS::S3::Bucket",
    "resource_name": "ArtifactBucket",
    "title": "Missing Lifecycle Policies for Artifact Management",
    "issue": "The ArtifactBucket does not have lifecycle policies configured to manage the retention and expiration of build artifacts, potentially leading to storage exhaustion over time.",
    "attack_vector": "An attacker could intentionally trigger numerous pipeline executions to fill the artifact bucket, potentially causing service disruption or increased costs.",
    "impact": "Storage resource exhaustion, increased costs, and potential pipeline failures due to storage issues.",
    "remediation": "Configure lifecycle policies on the ArtifactBucket to automatically expire and delete artifacts after an appropriate retention period.",
    "priority": 5,
    "estimated_effort": "Low",
    "cwe_id": "CWE-400",
    "compliance_violations": ["AWS Well-Architected Framework - Cost Optimization Pillar"],
    "references": ["https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lifecycle-mgmt.html"],
    "status": "Open"
  }
]