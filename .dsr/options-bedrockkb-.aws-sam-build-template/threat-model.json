[
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-BEDROCK-KNOWLEDGE-BASE-SETUP-THREAT-001",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "stride_category": "Information Disclosure",
    "severity": "Medium",
    "resource_type": "AWS::OpenSearchServerless::SecurityPolicy",
    "resource_name": "OSSNetworkPolicy",
    "title": "Public Access to OpenSearch Serverless Collection",
    "issue": "The OSSNetworkPolicy security policy allows public access to the OpenSearch Serverless collection dashboard and API endpoints with 'AllowFromPublic' set to true.",
    "attack_vector": "An attacker could attempt to access the OpenSearch dashboard or API endpoints if authentication controls are misconfigured or compromised.",
    "impact": "Potential unauthorized access to the vector database containing knowledge base data, which could lead to data exposure or information leakage.",
    "remediation": "Modify the OSSNetworkPolicy to restrict access using VPC endpoints or IP-based restrictions instead of allowing public access. If public access is required, ensure proper authentication and authorization are strictly enforced.",
    "priority": 2,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-668",
    "compliance_violations": ["CIS AWS Foundations Benchmark 4.1"],
    "references": ["https://docs.aws.amazon.com/opensearch-service/latest/developerguide/serverless-network.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-BEDROCK-KNOWLEDGE-BASE-SETUP-THREAT-002",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "stride_category": "Tampering",
    "severity": "Medium",
    "resource_type": "AWS::OpenSearchServerless::SecurityPolicy",
    "resource_name": "OSSEncryptionPolicy",
    "title": "Default AWS-Owned Key Used for OpenSearch Encryption",
    "issue": "The template uses AWS-owned encryption keys for the OpenSearch Serverless collection rather than customer-managed KMS keys.",
    "attack_vector": "While AWS-owned keys provide encryption, they don't give customers full control over the key lifecycle or access management.",
    "impact": "Reduced control over encryption key management and potential challenges meeting strict compliance requirements that mandate customer control of encryption keys.",
    "remediation": "Modify the OSSEncryptionPolicy to use customer-managed KMS keys instead of AWS-owned keys by setting 'AWSOwnedKey' to false and specifying a KMS key.",
    "priority": 3,
    "estimated_effort": "Low",
    "cwe_id": "CWE-320",
    "compliance_violations": ["PCI DSS 3.2.1 Requirement 3.5", "HIPAA Security Rule"],
    "references": ["https://docs.aws.amazon.com/opensearch-service/latest/developerguide/serverless-encryption.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-BEDROCK-KNOWLEDGE-BASE-SETUP-THREAT-003",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "stride_category": "Elevation of Privilege",
    "severity": "Medium",
    "resource_type": "AWS::IAM::Role",
    "resource_name": "OpenSearchLambdaExecutionRole",
    "title": "Overly Permissive IAM Permissions",
    "issue": "The OpenSearchLambdaExecutionRole includes broad permissions like 's3:*Object*' on all S3 buckets and 'aoss:APIAccessAll' on all resources.",
    "attack_vector": "If the Lambda function is compromised, an attacker could use these broad permissions to access data in any S3 bucket or perform unauthorized actions in OpenSearch Serverless.",
    "impact": "Potential data exfiltration, unauthorized access to S3 objects, or manipulation of OpenSearch collections and indices.",
    "remediation": "Implement least privilege by restricting S3 permissions to specific buckets and actions needed. Scope down the OpenSearch Serverless permissions to specific collections and actions required.",
    "priority": 1,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-272",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.16"],
    "references": ["https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-BEDROCK-KNOWLEDGE-BASE-SETUP-THREAT-004",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "stride_category": "Repudiation",
    "severity": "Low",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "CreateOSSIndexLambdaFunction",
    "title": "Missing CloudWatch Logs Configurations for Lambda Functions",
    "issue": "Lambda functions in the template don't explicitly define log retention periods or log access controls, which could lead to insufficient audit trails.",
    "attack_vector": "In the event of a security incident, logs might be missing, inadequate, or might have been automatically deleted if the default retention period was too short.",
    "impact": "Difficulty investigating security incidents, potential non-compliance with regulatory requirements for log retention, and challenges with non-repudiation.",
    "remediation": "Configure explicit log retention periods for Lambda functions using AWS::Logs::LogGroup resources with appropriate RetentionInDays values. Consider encrypting logs with KMS for sensitive workloads.",
    "priority": 3,
    "estimated_effort": "Low",
    "cwe_id": "CWE-778",
    "compliance_violations": ["CIS AWS Foundations Benchmark 3.9"],
    "references": ["https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/WhatIsCloudWatchLogs.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-BEDROCK-KNOWLEDGE-BASE-SETUP-THREAT-005",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "stride_category": "Elevation of Privilege",
    "severity": "High",
    "resource_type": "AWS::IAM::Role",
    "resource_name": "KnowledgeBaseServiceRole",
    "title": "Broad Bedrock Model Invocation Permissions",
    "issue": "The KnowledgeBaseServiceRole includes permission to invoke any foundation model in Bedrock (bedrock:InvokeModel on resource '*') rather than restricting to specific models needed.",
    "attack_vector": "If the Knowledge Base service is compromised, an attacker could leverage this role to invoke any Bedrock model, potentially bypassing guardrails or restrictions on specific models.",
    "impact": "Potential misuse of AI capabilities, unauthorized model access, and possible generation of harmful content through unrestricted model invocation.",
    "remediation": "Restrict the bedrock:InvokeModel permission to only the specific embedding model ARNs required for the Knowledge Base functionality rather than allowing access to all foundation models.",
    "priority": 1,
    "estimated_effort": "Low",
    "cwe_id": "CWE-272",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.16"],
    "references": ["https://docs.aws.amazon.com/bedrock/latest/userguide/security_iam_service-with-iam.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-BEDROCK-KNOWLEDGE-BASE-SETUP-THREAT-006",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "stride_category": "Information Disclosure",
    "severity": "Medium",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "GetAdjustedStackNameFunction",
    "title": "Lambda Functions Without VPC Configuration",
    "issue": "Lambda functions are deployed without VPC configurations, exposing them to the public internet rather than restricting them within a private network.",
    "attack_vector": "While protected by IAM, Lambda functions could potentially be accessed from the public internet, increasing the attack surface.",
    "impact": "Increased attack surface for sensitive functions that handle data transformations or have permissions to access other AWS resources.",
    "remediation": "Deploy Lambda functions within a VPC with appropriate subnet and security group configurations to restrict network access and enhance security posture.",
    "priority": 2,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-668",
    "compliance_violations": ["CIS AWS Foundations Benchmark 4.3"],
    "references": ["https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-BEDROCK-KNOWLEDGE-BASE-SETUP-THREAT-007",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "stride_category": "Denial of Service",
    "severity": "Low",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "CreateOSSIndexLambdaFunction",
    "title": "Missing Lambda Concurrency Controls",
    "issue": "Lambda functions don't have reserved concurrency configurations, which could lead to resource exhaustion during high traffic periods.",
    "attack_vector": "In a multi-tenant environment, other applications could consume all available Lambda concurrency, causing throttling and denial of service for the Knowledge Base components.",
    "impact": "Potential service disruptions, failures in index creation, or delays in processing Knowledge Base operations during peak usage periods.",
    "remediation": "Configure ReservedConcurrentExecutions for critical Lambda functions to ensure they have guaranteed capacity even during high-load situations.",
    "priority": 4,
    "estimated_effort": "Low",
    "cwe_id": "CWE-400",
    "compliance_violations": [],
    "references": ["https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-BEDROCK-KNOWLEDGE-BASE-SETUP-THREAT-008",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "stride_category": "Tampering",
    "severity": "Low",
    "resource_type": "AWS::S3::Bucket",
    "resource_name": "pKnowledgeBaseBucketName",
    "title": "Missing S3 Bucket Security Configurations",
    "issue": "The template references an existing S3 bucket but doesn't enforce security configurations like versioning, encryption, or access logging on that bucket.",
    "attack_vector": "If the referenced bucket doesn't have proper security controls, documents stored in it could be vulnerable to unauthorized modifications or deletions.",
    "impact": "Potential data integrity issues, inability to recover from accidental or malicious changes, and lack of audit trails for bucket access.",
    "remediation": "Either modify the template to create a new bucket with proper security configurations or validate the security settings of the existing bucket. Consider adding conditional checks to ensure the bucket has appropriate security controls.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-693",
    "compliance_violations": ["CIS AWS Foundations Benchmark 3.6", "CIS AWS Foundations Benchmark 3.7"],
    "references": ["https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-BEDROCK-KNOWLEDGE-BASE-SETUP-THREAT-009",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "stride_category": "Spoofing",
    "severity": "Low",
    "resource_type": "AWS::Scheduler::Schedule",
    "resource_name": "S3DataSourceScheduler",
    "title": "Scheduler Without Request Authentication",
    "issue": "The EventBridge Scheduler configurations don't include authentication settings when invoking the Bedrock API.",
    "attack_vector": "While protected by IAM, the lack of additional authentication mechanisms could potentially be exploited if the scheduler role is compromised.",
    "impact": "If the scheduler role is compromised, an attacker could trigger unauthorized ingestion jobs, potentially causing resource consumption or service disruptions.",
    "remediation": "Consider adding additional authentication mechanisms to the EventBridge Scheduler configuration if available, or implement tighter restrictions on the scheduler role's permissions.",
    "priority": 4,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-306",
    "compliance_violations": [],
    "references": ["https://docs.aws.amazon.com/scheduler/latest/UserGuide/managing-security.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-BEDROCK-KNOWLEDGE-BASE-SETUP-THREAT-010",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "stride_category": "Information Disclosure",
    "severity": "Medium",
    "resource_type": "AWS::Bedrock::DataSource",
    "resource_name": "WebDataSource",
    "title": "Web Crawler Data Source Security Risk",
    "issue": "The web crawler configuration can ingest content from public websites but doesn't include security controls to prevent crawling or ingestion of sensitive information.",
    "attack_vector": "The web crawler could potentially scrape sensitive or restricted information from websites and store it in the Knowledge Base, where it could be exposed through queries.",
    "impact": "Potential leakage of sensitive information, copyright violations, or unauthorized data collection through the web crawler mechanism.",
    "remediation": "Implement additional validation and filtering for web crawler content, such as content classifiers to identify and exclude sensitive information. Consider adding policies to respect robots.txt and implement ethical crawling practices.",
    "priority": 2,
    "estimated_effort": "High",
    "cwe_id": "CWE-212",
    "compliance_violations": ["GDPR Article 5"],
    "references": ["https://docs.aws.amazon.com/bedrock/latest/userguide/knowledge-base-web.html"],
    "status": "Open"
  }
]