{"check_type": "cloudformation", "results": {"failed_checks": [{"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[224, "  GetAdjustedStackNameFunction:\n"], [225, "    Type: AWS::Serverless::Function\n"], [226, "    Metadata:\n"], [227, "      cfn_nag:\n"], [228, "        rules_to_suppress:\n"], [229, "        - id: W89\n"], [230, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [231, "            services via APIs\n"], [232, "        - id: W92\n"], [233, "          reason: Function does not require reserved concurrency as it scales based\n"], [234, "            on demand\n"], [235, "    Properties:\n"], [236, "      PermissionsBoundary:\n"], [237, "        Fn::If:\n"], [238, "        - HasPermissionsBoundary\n"], [239, "        - Ref: PermissionsBoundaryArn\n"], [240, "        - Ref: AWS::NoValue\n"], [241, "      Handler: index.handler\n"], [242, "      Runtime: python3.12\n"], [243, "      Timeout: 30\n"], [244, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [245, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [246, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [247, "        \\ log_level))\\n\\ndef handler(event, context):\\n    logger.info(event)  \\n\\\n"], [248, "        \\    output = event['ResourceProperties'].get('InputString', '').lower()\\n\\\n"], [249, "        \\    output = output[:32]\\n    responseData = {'OutputString': output}   \\\n"], [250, "        \\                                         \\n    cfnresponse.send(event, context,\\\n"], [251, "        \\ cfnresponse.SUCCESS, responseData)\\n\"\n"], [252, "      Environment:\n"], [253, "        Variables:\n"], [254, "          LOG_LEVEL:\n"], [255, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [224, 255], "resource": "AWS::Serverless::Function.GetAdjustedStackNameFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[224, "  GetAdjustedStackNameFunction:\n"], [225, "    Type: AWS::Serverless::Function\n"], [226, "    Metadata:\n"], [227, "      cfn_nag:\n"], [228, "        rules_to_suppress:\n"], [229, "        - id: W89\n"], [230, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [231, "            services via APIs\n"], [232, "        - id: W92\n"], [233, "          reason: Function does not require reserved concurrency as it scales based\n"], [234, "            on demand\n"], [235, "    Properties:\n"], [236, "      PermissionsBoundary:\n"], [237, "        Fn::If:\n"], [238, "        - HasPermissionsBoundary\n"], [239, "        - Ref: PermissionsBoundaryArn\n"], [240, "        - Ref: AWS::NoValue\n"], [241, "      Handler: index.handler\n"], [242, "      Runtime: python3.12\n"], [243, "      Timeout: 30\n"], [244, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [245, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [246, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [247, "        \\ log_level))\\n\\ndef handler(event, context):\\n    logger.info(event)  \\n\\\n"], [248, "        \\    output = event['ResourceProperties'].get('InputString', '').lower()\\n\\\n"], [249, "        \\    output = output[:32]\\n    responseData = {'OutputString': output}   \\\n"], [250, "        \\                                         \\n    cfnresponse.send(event, context,\\\n"], [251, "        \\ cfnresponse.SUCCESS, responseData)\\n\"\n"], [252, "      Environment:\n"], [253, "        Variables:\n"], [254, "          LOG_LEVEL:\n"], [255, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [224, 255], "resource": "AWS::Serverless::Function.GetAdjustedStackNameFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[224, "  GetAdjustedStackNameFunction:\n"], [225, "    Type: AWS::Serverless::Function\n"], [226, "    Metadata:\n"], [227, "      cfn_nag:\n"], [228, "        rules_to_suppress:\n"], [229, "        - id: W89\n"], [230, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [231, "            services via APIs\n"], [232, "        - id: W92\n"], [233, "          reason: Function does not require reserved concurrency as it scales based\n"], [234, "            on demand\n"], [235, "    Properties:\n"], [236, "      PermissionsBoundary:\n"], [237, "        Fn::If:\n"], [238, "        - HasPermissionsBoundary\n"], [239, "        - Ref: PermissionsBoundaryArn\n"], [240, "        - Ref: AWS::NoValue\n"], [241, "      Handler: index.handler\n"], [242, "      Runtime: python3.12\n"], [243, "      Timeout: 30\n"], [244, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [245, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [246, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [247, "        \\ log_level))\\n\\ndef handler(event, context):\\n    logger.info(event)  \\n\\\n"], [248, "        \\    output = event['ResourceProperties'].get('InputString', '').lower()\\n\\\n"], [249, "        \\    output = output[:32]\\n    responseData = {'OutputString': output}   \\\n"], [250, "        \\                                         \\n    cfnresponse.send(event, context,\\\n"], [251, "        \\ cfnresponse.SUCCESS, responseData)\\n\"\n"], [252, "      Environment:\n"], [253, "        Variables:\n"], [254, "          LOG_LEVEL:\n"], [255, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [224, 255], "resource": "AWS::Serverless::Function.GetAdjustedStackNameFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[224, "  GetAdjustedStackNameFunction:\n"], [225, "    Type: AWS::Serverless::Function\n"], [226, "    Metadata:\n"], [227, "      cfn_nag:\n"], [228, "        rules_to_suppress:\n"], [229, "        - id: W89\n"], [230, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [231, "            services via APIs\n"], [232, "        - id: W92\n"], [233, "          reason: Function does not require reserved concurrency as it scales based\n"], [234, "            on demand\n"], [235, "    Properties:\n"], [236, "      PermissionsBoundary:\n"], [237, "        Fn::If:\n"], [238, "        - HasPermissionsBoundary\n"], [239, "        - Ref: PermissionsBoundaryArn\n"], [240, "        - Ref: AWS::NoValue\n"], [241, "      Handler: index.handler\n"], [242, "      Runtime: python3.12\n"], [243, "      Timeout: 30\n"], [244, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [245, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [246, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [247, "        \\ log_level))\\n\\ndef handler(event, context):\\n    logger.info(event)  \\n\\\n"], [248, "        \\    output = event['ResourceProperties'].get('InputString', '').lower()\\n\\\n"], [249, "        \\    output = output[:32]\\n    responseData = {'OutputString': output}   \\\n"], [250, "        \\                                         \\n    cfnresponse.send(event, context,\\\n"], [251, "        \\ cfnresponse.SUCCESS, responseData)\\n\"\n"], [252, "      Environment:\n"], [253, "        Variables:\n"], [254, "          LOG_LEVEL:\n"], [255, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [224, 255], "resource": "AWS::Serverless::Function.GetAdjustedStackNameFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[265, "  GetSeedUrlsFunction:\n"], [266, "    Type: AWS::Serverless::Function\n"], [267, "    Metadata:\n"], [268, "      cfn_nag:\n"], [269, "        rules_to_suppress:\n"], [270, "        - id: W89\n"], [271, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [272, "            services via APIs\n"], [273, "        - id: W92\n"], [274, "          reason: Function does not require reserved concurrency as it scales based\n"], [275, "            on demand\n"], [276, "    Properties:\n"], [277, "      PermissionsBoundary:\n"], [278, "        Fn::If:\n"], [279, "        - HasPermissionsBoundary\n"], [280, "        - Ref: PermissionsBoundaryArn\n"], [281, "        - Ref: AWS::NoValue\n"], [282, "      Handler: index.handler\n"], [283, "      Runtime: python3.12\n"], [284, "      Timeout: 30\n"], [285, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [286, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [287, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [288, "        \\ log_level))\\n\\ndef handler(event, context):\\n  logger.info(event)\\n  urls\\\n"], [289, "        \\ = event['ResourceProperties'].get('WebCrawlerURLs', '').split(',')\\n  seedUrls\\\n"], [290, "        \\ = [{'Url': url.strip()} for url in urls]\\n  responseData = {'SeedUrls':\\\n"], [291, "        \\ seedUrls}\\n  cfnresponse.send(event, context, cfnresponse.SUCCESS, responseData)\\n\"\n"], [292, "      Environment:\n"], [293, "        Variables:\n"], [294, "          LOG_LEVEL:\n"], [295, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [265, 295], "resource": "AWS::Serverless::Function.GetSeedUrlsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[265, "  GetSeedUrlsFunction:\n"], [266, "    Type: AWS::Serverless::Function\n"], [267, "    Metadata:\n"], [268, "      cfn_nag:\n"], [269, "        rules_to_suppress:\n"], [270, "        - id: W89\n"], [271, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [272, "            services via APIs\n"], [273, "        - id: W92\n"], [274, "          reason: Function does not require reserved concurrency as it scales based\n"], [275, "            on demand\n"], [276, "    Properties:\n"], [277, "      PermissionsBoundary:\n"], [278, "        Fn::If:\n"], [279, "        - HasPermissionsBoundary\n"], [280, "        - Ref: PermissionsBoundaryArn\n"], [281, "        - Ref: AWS::NoValue\n"], [282, "      Handler: index.handler\n"], [283, "      Runtime: python3.12\n"], [284, "      Timeout: 30\n"], [285, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [286, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [287, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [288, "        \\ log_level))\\n\\ndef handler(event, context):\\n  logger.info(event)\\n  urls\\\n"], [289, "        \\ = event['ResourceProperties'].get('WebCrawlerURLs', '').split(',')\\n  seedUrls\\\n"], [290, "        \\ = [{'Url': url.strip()} for url in urls]\\n  responseData = {'SeedUrls':\\\n"], [291, "        \\ seedUrls}\\n  cfnresponse.send(event, context, cfnresponse.SUCCESS, responseData)\\n\"\n"], [292, "      Environment:\n"], [293, "        Variables:\n"], [294, "          LOG_LEVEL:\n"], [295, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [265, 295], "resource": "AWS::Serverless::Function.GetSeedUrlsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[265, "  GetSeedUrlsFunction:\n"], [266, "    Type: AWS::Serverless::Function\n"], [267, "    Metadata:\n"], [268, "      cfn_nag:\n"], [269, "        rules_to_suppress:\n"], [270, "        - id: W89\n"], [271, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [272, "            services via APIs\n"], [273, "        - id: W92\n"], [274, "          reason: Function does not require reserved concurrency as it scales based\n"], [275, "            on demand\n"], [276, "    Properties:\n"], [277, "      PermissionsBoundary:\n"], [278, "        Fn::If:\n"], [279, "        - HasPermissionsBoundary\n"], [280, "        - Ref: PermissionsBoundaryArn\n"], [281, "        - Ref: AWS::NoValue\n"], [282, "      Handler: index.handler\n"], [283, "      Runtime: python3.12\n"], [284, "      Timeout: 30\n"], [285, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [286, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [287, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [288, "        \\ log_level))\\n\\ndef handler(event, context):\\n  logger.info(event)\\n  urls\\\n"], [289, "        \\ = event['ResourceProperties'].get('WebCrawlerURLs', '').split(',')\\n  seedUrls\\\n"], [290, "        \\ = [{'Url': url.strip()} for url in urls]\\n  responseData = {'SeedUrls':\\\n"], [291, "        \\ seedUrls}\\n  cfnresponse.send(event, context, cfnresponse.SUCCESS, responseData)\\n\"\n"], [292, "      Environment:\n"], [293, "        Variables:\n"], [294, "          LOG_LEVEL:\n"], [295, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [265, 295], "resource": "AWS::Serverless::Function.GetSeedUrlsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[265, "  GetSeedUrlsFunction:\n"], [266, "    Type: AWS::Serverless::Function\n"], [267, "    Metadata:\n"], [268, "      cfn_nag:\n"], [269, "        rules_to_suppress:\n"], [270, "        - id: W89\n"], [271, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [272, "            services via APIs\n"], [273, "        - id: W92\n"], [274, "          reason: Function does not require reserved concurrency as it scales based\n"], [275, "            on demand\n"], [276, "    Properties:\n"], [277, "      PermissionsBoundary:\n"], [278, "        Fn::If:\n"], [279, "        - HasPermissionsBoundary\n"], [280, "        - Ref: PermissionsBoundaryArn\n"], [281, "        - Ref: AWS::NoValue\n"], [282, "      Handler: index.handler\n"], [283, "      Runtime: python3.12\n"], [284, "      Timeout: 30\n"], [285, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [286, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [287, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [288, "        \\ log_level))\\n\\ndef handler(event, context):\\n  logger.info(event)\\n  urls\\\n"], [289, "        \\ = event['ResourceProperties'].get('WebCrawlerURLs', '').split(',')\\n  seedUrls\\\n"], [290, "        \\ = [{'Url': url.strip()} for url in urls]\\n  responseData = {'SeedUrls':\\\n"], [291, "        \\ seedUrls}\\n  cfnresponse.send(event, context, cfnresponse.SUCCESS, responseData)\\n\"\n"], [292, "      Environment:\n"], [293, "        Variables:\n"], [294, "          LOG_LEVEL:\n"], [295, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [265, 295], "resource": "AWS::Serverless::Function.GetSeedUrlsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[438, "  CreateOSSIndexLambdaFunction:\n"], [439, "    Type: AWS::Serverless::Function\n"], [440, "    Metadata:\n"], [441, "      SamResourceId: CreateOSSIndexLambdaFunction\n"], [442, "      cfn_nag:\n"], [443, "        rules_to_suppress:\n"], [444, "        - id: W89\n"], [445, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [446, "            services via APIs\n"], [447, "        - id: W92\n"], [448, "          reason: Function does not require reserved concurrency as it scales based\n"], [449, "            on demand\n"], [450, "    Properties:\n"], [451, "      PermissionsBoundary:\n"], [452, "        Fn::If:\n"], [453, "        - HasPermissionsBoundary\n"], [454, "        - Ref: PermissionsBoundaryArn\n"], [455, "        - Ref: AWS::NoValue\n"], [456, "      Handler: oss_handler.lambda_handler\n"], [457, "      MemorySize: 1024\n"], [458, "      Role:\n"], [459, "        Fn::GetAtt:\n"], [460, "        - OpenSearchLambdaExecutionRole\n"], [461, "        - Arn\n"], [462, "      Runtime: python3.12\n"], [463, "      Timeout: 840\n"], [464, "      CodeUri: CreateOSSIndexLambdaFunction\n"], [465, "      Environment:\n"], [466, "        Variables:\n"], [467, "          POWERTOOLS_SERVICE_NAME: InfraSetupLambda\n"], [468, "          POWERTOOLS_METRICS_NAMESPACE: InfraSetupLambda-NameSpace\n"], [469, "          POWERTOOLS_LOG_LEVEL:\n"], [470, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [438, 470], "resource": "AWS::Serverless::Function.CreateOSSIndexLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.POWERTOOLS_LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[438, "  CreateOSSIndexLambdaFunction:\n"], [439, "    Type: AWS::Serverless::Function\n"], [440, "    Metadata:\n"], [441, "      SamResourceId: CreateOSSIndexLambdaFunction\n"], [442, "      cfn_nag:\n"], [443, "        rules_to_suppress:\n"], [444, "        - id: W89\n"], [445, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [446, "            services via APIs\n"], [447, "        - id: W92\n"], [448, "          reason: Function does not require reserved concurrency as it scales based\n"], [449, "            on demand\n"], [450, "    Properties:\n"], [451, "      PermissionsBoundary:\n"], [452, "        Fn::If:\n"], [453, "        - HasPermissionsBoundary\n"], [454, "        - Ref: PermissionsBoundaryArn\n"], [455, "        - Ref: AWS::NoValue\n"], [456, "      Handler: oss_handler.lambda_handler\n"], [457, "      MemorySize: 1024\n"], [458, "      Role:\n"], [459, "        Fn::GetAtt:\n"], [460, "        - OpenSearchLambdaExecutionRole\n"], [461, "        - Arn\n"], [462, "      Runtime: python3.12\n"], [463, "      Timeout: 840\n"], [464, "      CodeUri: CreateOSSIndexLambdaFunction\n"], [465, "      Environment:\n"], [466, "        Variables:\n"], [467, "          POWERTOOLS_SERVICE_NAME: InfraSetupLambda\n"], [468, "          POWERTOOLS_METRICS_NAMESPACE: InfraSetupLambda-NameSpace\n"], [469, "          POWERTOOLS_LOG_LEVEL:\n"], [470, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [438, 470], "resource": "AWS::Serverless::Function.CreateOSSIndexLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.POWERTOOLS_LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[438, "  CreateOSSIndexLambdaFunction:\n"], [439, "    Type: AWS::Serverless::Function\n"], [440, "    Metadata:\n"], [441, "      SamResourceId: CreateOSSIndexLambdaFunction\n"], [442, "      cfn_nag:\n"], [443, "        rules_to_suppress:\n"], [444, "        - id: W89\n"], [445, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [446, "            services via APIs\n"], [447, "        - id: W92\n"], [448, "          reason: Function does not require reserved concurrency as it scales based\n"], [449, "            on demand\n"], [450, "    Properties:\n"], [451, "      PermissionsBoundary:\n"], [452, "        Fn::If:\n"], [453, "        - HasPermissionsBoundary\n"], [454, "        - Ref: PermissionsBoundaryArn\n"], [455, "        - Ref: AWS::NoValue\n"], [456, "      Handler: oss_handler.lambda_handler\n"], [457, "      MemorySize: 1024\n"], [458, "      Role:\n"], [459, "        Fn::GetAtt:\n"], [460, "        - OpenSearchLambdaExecutionRole\n"], [461, "        - Arn\n"], [462, "      Runtime: python3.12\n"], [463, "      Timeout: 840\n"], [464, "      CodeUri: CreateOSSIndexLambdaFunction\n"], [465, "      Environment:\n"], [466, "        Variables:\n"], [467, "          POWERTOOLS_SERVICE_NAME: InfraSetupLambda\n"], [468, "          POWERTOOLS_METRICS_NAMESPACE: InfraSetupLambda-NameSpace\n"], [469, "          POWERTOOLS_LOG_LEVEL:\n"], [470, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [438, 470], "resource": "AWS::Serverless::Function.CreateOSSIndexLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.POWERTOOLS_LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[438, "  CreateOSSIndexLambdaFunction:\n"], [439, "    Type: AWS::Serverless::Function\n"], [440, "    Metadata:\n"], [441, "      SamResourceId: CreateOSSIndexLambdaFunction\n"], [442, "      cfn_nag:\n"], [443, "        rules_to_suppress:\n"], [444, "        - id: W89\n"], [445, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [446, "            services via APIs\n"], [447, "        - id: W92\n"], [448, "          reason: Function does not require reserved concurrency as it scales based\n"], [449, "            on demand\n"], [450, "    Properties:\n"], [451, "      PermissionsBoundary:\n"], [452, "        Fn::If:\n"], [453, "        - HasPermissionsBoundary\n"], [454, "        - Ref: PermissionsBoundaryArn\n"], [455, "        - Ref: AWS::NoValue\n"], [456, "      Handler: oss_handler.lambda_handler\n"], [457, "      MemorySize: 1024\n"], [458, "      Role:\n"], [459, "        Fn::GetAtt:\n"], [460, "        - OpenSearchLambdaExecutionRole\n"], [461, "        - Arn\n"], [462, "      Runtime: python3.12\n"], [463, "      Timeout: 840\n"], [464, "      CodeUri: CreateOSSIndexLambdaFunction\n"], [465, "      Environment:\n"], [466, "        Variables:\n"], [467, "          POWERTOOLS_SERVICE_NAME: InfraSetupLambda\n"], [468, "          POWERTOOLS_METRICS_NAMESPACE: InfraSetupLambda-NameSpace\n"], [469, "          POWERTOOLS_LOG_LEVEL:\n"], [470, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [438, 470], "resource": "AWS::Serverless::Function.CreateOSSIndexLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.POWERTOOLS_LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterConfig/TargetArn"]}, "code_block": [[743, "  StartIngestionJobFunction:\n"], [744, "    Type: AWS::Lambda::Function\n"], [745, "    Metadata:\n"], [746, "      SamResourceId: StartIngestionJobFunction\n"], [747, "      cfn_nag:\n"], [748, "        rules_to_suppress:\n"], [749, "        - id: W89\n"], [750, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [751, "            services via APIs\n"], [752, "        - id: W92\n"], [753, "          reason: Function does not require reserved concurrency as it scales based\n"], [754, "            on demand\n"], [755, "    Properties:\n"], [756, "      Handler: handler.lambda_handler\n"], [757, "      Role:\n"], [758, "        Fn::GetAtt:\n"], [759, "        - StartIngestionJobFunctionRole\n"], [760, "        - Arn\n"], [761, "      Runtime: python3.12\n"], [762, "      Timeout: 600\n"], [763, "      MemorySize: 128\n"], [764, "      Code: StartIngestionJobFunction\n"], [765, "      Environment:\n"], [766, "        Variables:\n"], [767, "          LOG_LEVEL:\n"], [768, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [743, 768], "resource": "AWS::Lambda::Function.StartIngestionJobFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[743, "  StartIngestionJobFunction:\n"], [744, "    Type: AWS::Lambda::Function\n"], [745, "    Metadata:\n"], [746, "      SamResourceId: StartIngestionJobFunction\n"], [747, "      cfn_nag:\n"], [748, "        rules_to_suppress:\n"], [749, "        - id: W89\n"], [750, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [751, "            services via APIs\n"], [752, "        - id: W92\n"], [753, "          reason: Function does not require reserved concurrency as it scales based\n"], [754, "            on demand\n"], [755, "    Properties:\n"], [756, "      Handler: handler.lambda_handler\n"], [757, "      Role:\n"], [758, "        Fn::GetAtt:\n"], [759, "        - StartIngestionJobFunctionRole\n"], [760, "        - Arn\n"], [761, "      Runtime: python3.12\n"], [762, "      Timeout: 600\n"], [763, "      MemorySize: 128\n"], [764, "      Code: StartIngestionJobFunction\n"], [765, "      Environment:\n"], [766, "        Variables:\n"], [767, "          LOG_LEVEL:\n"], [768, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [743, 768], "resource": "AWS::Lambda::Function.StartIngestionJobFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[743, "  StartIngestionJobFunction:\n"], [744, "    Type: AWS::Lambda::Function\n"], [745, "    Metadata:\n"], [746, "      SamResourceId: StartIngestionJobFunction\n"], [747, "      cfn_nag:\n"], [748, "        rules_to_suppress:\n"], [749, "        - id: W89\n"], [750, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [751, "            services via APIs\n"], [752, "        - id: W92\n"], [753, "          reason: Function does not require reserved concurrency as it scales based\n"], [754, "            on demand\n"], [755, "    Properties:\n"], [756, "      Handler: handler.lambda_handler\n"], [757, "      Role:\n"], [758, "        Fn::GetAtt:\n"], [759, "        - StartIngestionJobFunctionRole\n"], [760, "        - Arn\n"], [761, "      Runtime: python3.12\n"], [762, "      Timeout: 600\n"], [763, "      MemorySize: 128\n"], [764, "      Code: StartIngestionJobFunction\n"], [765, "      Environment:\n"], [766, "        Variables:\n"], [767, "          LOG_LEVEL:\n"], [768, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [743, 768], "resource": "AWS::Lambda::Function.StartIngestionJobFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[743, "  StartIngestionJobFunction:\n"], [744, "    Type: AWS::Lambda::Function\n"], [745, "    Metadata:\n"], [746, "      SamResourceId: StartIngestionJobFunction\n"], [747, "      cfn_nag:\n"], [748, "        rules_to_suppress:\n"], [749, "        - id: W89\n"], [750, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [751, "            services via APIs\n"], [752, "        - id: W92\n"], [753, "          reason: Function does not require reserved concurrency as it scales based\n"], [754, "            on demand\n"], [755, "    Properties:\n"], [756, "      Handler: handler.lambda_handler\n"], [757, "      Role:\n"], [758, "        Fn::GetAtt:\n"], [759, "        - StartIngestionJobFunctionRole\n"], [760, "        - Arn\n"], [761, "      Runtime: python3.12\n"], [762, "      Timeout: 600\n"], [763, "      MemorySize: 128\n"], [764, "      Code: StartIngestionJobFunction\n"], [765, "      Environment:\n"], [766, "        Variables:\n"], [767, "          LOG_LEVEL:\n"], [768, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [743, 768], "resource": "AWS::Lambda::Function.StartIngestionJobFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/options/bedrockkb/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}]}, "summary": {"passed": 45, "failed": 16, "skipped": 0, "parsing_errors": 0, "resource_count": 22, "checkov_version": "3.2.461"}}