[
  {
    "id": "GENAI-IDP-THREAT-001",
    "stack": "GenAI-IDP",
    "stride_category": "Spoofing",
    "severity": "Medium",
    "resource_type": "AWS::Cognito::UserPool",
    "resource_name": "UserPool",
    "title": "Cognito User Pool MFA Not Enforced",
    "issue": "The Cognito User Pool does not enforce Multi-Factor Authentication, which could allow attackers to authenticate with just a username and password if credentials are compromised.",
    "attack_vector": "An attacker who obtains user credentials through phishing, credential stuffing, or other means could access the system without being challenged for a second factor.",
    "impact": "Unauthorized access to the application and potentially sensitive document processing capabilities and data.",
    "remediation": "Enable and enforce MFA for the Cognito User Pool by adding 'MfaConfiguration: ON' and configuring appropriate MFA options.",
    "priority": 2,
    "estimated_effort": "Low",
    "cwe_id": "CWE-308",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.10", "NIST 800-53 IA-2(1)"],
    "references": ["https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-mfa.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-002",
    "stack": "GenAI-IDP",
    "stride_category": "Information Disclosure",
    "severity": "Medium",
    "resource_type": "AWS::S3::Bucket",
    "resource_name": "LoggingBucket",
    "title": "S3 Logging Bucket Server-Side Encryption Using Default AES256",
    "issue": "The logging bucket uses AES256 encryption instead of KMS, which provides less control over key management and rotation policies.",
    "attack_vector": "If logs contain sensitive information, and AWS-managed keys are compromised or access to them is obtained, an attacker could potentially decrypt log contents.",
    "impact": "Reduced control over encryption key management for potentially sensitive log data.",
    "remediation": "Configure the LoggingBucket to use KMS encryption similar to other buckets in the template, using the CustomerManagedEncryptionKey.",
    "priority": 3,
    "estimated_effort": "Low",
    "cwe_id": "CWE-311",
    "compliance_violations": ["CIS AWS Foundations Benchmark 2.1.2"],
    "references": ["https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-003",
    "stack": "GenAI-IDP",
    "stride_category": "Tampering",
    "severity": "Low",
    "resource_type": "AWS::ApiGateway::Method",
    "resource_name": "GraphQLApi",
    "title": "AppSync GraphQL API Introspection Disabled But No Query Depth Limiting",
    "issue": "While GraphQL introspection is disabled, which is good security practice, there are no query depth limitations defined that could prevent resource exhaustion or complex query attacks.",
    "attack_vector": "An attacker could craft highly nested, complex GraphQL queries that could lead to excessive resource consumption.",
    "impact": "Potential DoS condition or increased costs due to excessive resource usage processing complex queries.",
    "remediation": "Implement query depth limiting and complexity analysis for the AppSync API. This can be done by using AWS AppSync resolvers with appropriate field validation and limits.",
    "priority": 4,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-400",
    "compliance_violations": [],
    "references": ["https://docs.aws.amazon.com/appsync/latest/devguide/security-authorization-use-cases.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-004",
    "stack": "GenAI-IDP",
    "stride_category": "Repudiation",
    "severity": "Medium",
    "resource_type": "AWS::CloudTrail::Trail",
    "resource_name": "Missing CloudTrail Configuration",
    "title": "No CloudTrail Trail Defined for API and Management Events",
    "issue": "The template does not define a CloudTrail trail to capture API and management events, which could hinder investigation of security incidents and create accountability gaps.",
    "attack_vector": "Without proper API logging, an attacker's actions might go undetected or be difficult to trace during or after a security incident.",
    "impact": "Reduced ability to detect, investigate, and respond to security incidents or malicious activities.",
    "remediation": "Add a CloudTrail trail configuration to capture all management events, including read and write operations, with log file validation enabled and logs encrypted using the CustomerManagedEncryptionKey.",
    "priority": 2,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-778",
    "compliance_violations": ["CIS AWS Foundations Benchmark 3.1", "NIST 800-53 AU-2"],
    "references": ["https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-create-and-update-a-trail.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-005",
    "stack": "GenAI-IDP",
    "stride_category": "Elevation of Privilege",
    "severity": "High",
    "resource_type": "AWS::IAM::Role",
    "resource_name": "StartUICodeBuildExecutionRole",
    "title": "Overly Permissive CloudWatch Logs Permissions",
    "issue": "The StartUICodeBuildExecutionRole has '*' resource permissions for CloudWatch Logs which violates the principle of least privilege.",
    "attack_vector": "If this role is compromised, an attacker could access logs from other applications or services, potentially exposing sensitive information.",
    "impact": "Increased blast radius in case of role compromise, potentially leading to unauthorized access to sensitive log data across the account.",
    "remediation": "Restrict CloudWatch Logs permissions to specific log groups required by the function, using explicit ARNs instead of wildcard (*) resources.",
    "priority": 2,
    "estimated_effort": "Low",
    "cwe_id": "CWE-272",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.16"],
    "references": ["https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-006",
    "stack": "GenAI-IDP",
    "stride_category": "Denial of Service",
    "severity": "Medium",
    "resource_type": "AWS::AppSync::GraphQLApi",
    "resource_name": "GraphQLApi",
    "title": "No Rate Limiting on GraphQL API",
    "issue": "The GraphQL API does not have explicit rate limiting configured, which could allow for abuse through API flooding.",
    "attack_vector": "An attacker could flood the GraphQL API with requests, potentially causing service degradation or increased costs.",
    "impact": "Potential service disruption, poor performance for legitimate users, or unexpected cost increases due to high request volumes.",
    "remediation": "Implement WAF rate limiting rules for the GraphQL API and consider using AWS AppSync throttling settings to limit the rate of requests per user or IP.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-770",
    "compliance_violations": [],
    "references": ["https://docs.aws.amazon.com/appsync/latest/devguide/security-authz.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-007",
    "stack": "GenAI-IDP",
    "stride_category": "Information Disclosure",
    "severity": "Medium",
    "resource_type": "AWS::CloudFront::Distribution",
    "resource_name": "CloudFrontDistribution",
    "title": "CloudFront Distribution Using Default Certificate",
    "issue": "The CloudFront Distribution is using the default CloudFront certificate (CloudFrontDefaultCertificate: true) instead of a custom certificate, which may not meet security requirements for production deployments.",
    "attack_vector": "While HTTPS is enforced, users may be less likely to notice phishing sites using similar domains since the application uses the generic CloudFront domain rather than a custom branded domain with proper TLS certificates.",
    "impact": "Reduced user trust and potential for successful phishing attacks mimicking the application interface.",
    "remediation": "Use a custom domain with an ACM certificate for the CloudFront distribution to enhance trust and security posture.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-295",
    "compliance_violations": [],
    "references": ["https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/cnames-https-dedicated-ip-or-sni.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-008",
    "stack": "GenAI-IDP",
    "stride_category": "Elevation of Privilege",
    "severity": "High",
    "resource_type": "AWS::IAM::Role",
    "resource_name": "A2IHumanTaskUILambdaRole",
    "title": "Overly Permissive IAM Role for SageMaker A2I",
    "issue": "The A2IHumanTaskUILambdaRole has wildcard (*) resource permissions for multiple SageMaker actions, violating the principle of least privilege.",
    "attack_vector": "If this role is compromised, an attacker could potentially access or manipulate other SageMaker resources in the account beyond those needed for the application.",
    "impact": "Unauthorized access to or modification of SageMaker resources not related to this application.",
    "remediation": "Restrict SageMaker permissions to specific resources required by the function, using explicit ARNs instead of wildcard (*) resources.",
    "priority": 1,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-272",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.16"],
    "references": ["https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-009",
    "stack": "GenAI-IDP",
    "stride_category": "Tampering",
    "severity": "Medium",
    "resource_type": "AWS::Cognito::UserPool",
    "resource_name": "UserPool",
    "title": "Email Verification Subject and Message Not Using HTTPS Links",
    "issue": "The email verification template does not explicitly use HTTPS links, which could potentially lead to insecure communication if users click on HTTP links in verification emails.",
    "attack_vector": "If verification emails contain HTTP links, users might be directed to non-encrypted connections, potentially exposing verification codes or session information.",
    "impact": "Potential exposure of verification codes or session information during the user verification process.",
    "remediation": "Ensure all links in email templates use HTTPS explicitly, and consider implementing email templates with proper security messaging.",
    "priority": 3,
    "estimated_effort": "Low",
    "cwe_id": "CWE-319",
    "compliance_violations": [],
    "references": ["https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-settings-message-customizations.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-010",
    "stack": "GenAI-IDP",
    "stride_category": "Information Disclosure",
    "severity": "Medium",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "Multiple Lambda Functions",
    "title": "Lambda Functions Without VPC Configuration",
    "issue": "Most Lambda functions in the template are deployed outside a VPC, which could expose them to direct internet access and increase the attack surface.",
    "attack_vector": "Without VPC isolation, Lambda functions have potential internet connectivity, which could allow for data exfiltration if the function is compromised.",
    "impact": "Increased attack surface and potential data exfiltration paths if a function is compromised.",
    "remediation": "Deploy sensitive Lambda functions within a VPC with appropriate security groups and network ACLs to control traffic flow.",
    "priority": 2,
    "estimated_effort": "High",
    "cwe_id": "CWE-668",
    "compliance_violations": [],
    "references": ["https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-011",
    "stack": "GenAI-IDP",
    "stride_category": "Information Disclosure",
    "severity": "Medium",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "EvaluationFunction",
    "title": "Unrestricted Bedrock Model Access",
    "issue": "The EvaluationFunction has permissions to invoke any foundation model in Bedrock (arn:aws:bedrock:*::foundation-model/*), which is more permissive than necessary.",
    "attack_vector": "If the function is compromised, an attacker could utilize any Bedrock model, potentially leading to unexpected costs or access to more powerful models than intended.",
    "impact": "Potential for cost increases, or unintended model access if function is compromised.",
    "remediation": "Restrict Bedrock model access to only the specific models required for the application instead of using wildcard permissions.",
    "priority": 3,
    "estimated_effort": "Low",
    "cwe_id": "CWE-250",
    "compliance_violations": [],
    "references": ["https://docs.aws.amazon.com/bedrock/latest/userguide/security-iam.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-012",
    "stack": "GenAI-IDP",
    "stride_category": "Repudiation",
    "severity": "Medium",
    "resource_type": "AWS::DynamoDB::Table",
    "resource_name": "TrackingTable",
    "title": "Missing DynamoDB Table Data Access Logging",
    "issue": "The template does not configure detailed data access logging or auditing for DynamoDB tables that may contain sensitive tracking information.",
    "attack_vector": "Without detailed access logging, unauthorized access or modifications to data may go undetected.",
    "impact": "Reduced ability to detect and investigate potential data breaches or unauthorized data access.",
    "remediation": "Enable AWS CloudTrail data events for DynamoDB tables containing sensitive information to capture detailed read and write operations.",
    "priority": 2,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-778",
    "compliance_violations": ["NIST 800-53 AU-3"],
    "references": ["https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/monitoring-cloudtrail.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-013",
    "stack": "GenAI-IDP",
    "stride_category": "Tampering",
    "severity": "Low",
    "resource_type": "AWS::S3::Bucket",
    "resource_name": "All S3 Buckets",
    "title": "Object Lock Not Configured for S3 Buckets",
    "issue": "S3 buckets in the template do not have Object Lock enabled, which could allow for deletion or modification of critical data even with appropriate IAM controls.",
    "attack_vector": "An attacker with appropriate permissions or a compromised account could delete or modify critical data in the buckets.",
    "impact": "Potential data loss or tampering with sensitive documents and processing results.",
    "remediation": "Consider enabling S3 Object Lock with appropriate retention configurations for buckets containing critical data that should be immutable.",
    "priority": 4,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-345",
    "compliance_violations": [],
    "references": ["https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lock.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-014",
    "stack": "GenAI-IDP",
    "stride_category": "Denial of Service",
    "severity": "Medium",
    "resource_type": "AWS::AppSync::GraphQLApi",
    "resource_name": "GraphQLApi",
    "title": "No Explicit Timeout Configuration for GraphQL Resolvers",
    "issue": "The template does not specify timeout configurations for GraphQL resolvers, potentially allowing for long-running operations that could consume excessive resources.",
    "attack_vector": "An attacker could craft complex GraphQL queries designed to run for extended periods, consuming resources and potentially causing service degradation.",
    "impact": "Potential resource exhaustion leading to degraded service performance or increased costs.",
    "remediation": "Configure appropriate timeouts for all GraphQL resolvers to limit the duration of any single operation.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-400",
    "compliance_violations": [],
    "references": ["https://docs.aws.amazon.com/appsync/latest/devguide/resolver-reference-overview-js.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-015",
    "stack": "GenAI-IDP",
    "stride_category": "Elevation of Privilege",
    "severity": "Medium",
    "resource_type": "AWS::IAM::Role",
    "resource_name": "CognitoAuthorizedRole",
    "title": "Overly Broad S3 Access for Authenticated Users",
    "issue": "The CognitoAuthorizedRole grants authenticated users ListBucket permissions on the entire S3 buckets, which may be more access than necessary for normal application operation.",
    "attack_vector": "Any authenticated user could list all objects in the buckets, potentially discovering sensitive files or information not directly related to their authorized use cases.",
    "impact": "Potential information leakage about bucket contents that could aid in further attacks.",
    "remediation": "Restrict S3 bucket listing permissions to specific prefixes that users should have access to, rather than the entire bucket.",
    "priority": 2,
    "estimated_effort": "Low",
    "cwe_id": "CWE-732",
    "compliance_violations": [],
    "references": ["https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_examples.html"],
    "status": "Open"
  }
]