[
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-001",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Information Disclosure",
    "severity": "High",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "InvokeBDAFunction",
    "title": "Overly Permissive Lambda IAM Permissions for KMS",
    "issue": "The Lambda function has been granted broad permissions on the KMS key including Encrypt, Decrypt, ReEncrypt*, GenerateDataKey*, and DescribeKey. This exceeds the principle of least privilege as the function may only need specific operations like Decrypt.",
    "attack_vector": "If the Lambda function is compromised, an attacker could leverage these permissions to encrypt/decrypt data beyond what's needed for the function's intended purpose.",
    "impact": "Potential unauthorized access to encrypted data or ability to manipulate encryption keys, leading to data confidentiality breaches.",
    "remediation": "Restrict KMS permissions to only what's necessary for the function's operation. For example, if the function only needs to read encrypted data, limit to kms:Decrypt.",
    "priority": 2,
    "estimated_effort": "Low",
    "cwe_id": "CWE-250",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.16", "NIST 800-53 AC-6"],
    "references": ["https://docs.aws.amazon.com/kms/latest/developerguide/kms-api-permissions-reference.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-002",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Information Disclosure",
    "severity": "Medium",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "ProcessResultsFunction",
    "title": "Excessive SSM Parameter Access",
    "issue": "The ProcessResultsFunction has broad permissions to read and write any SSM parameter in the account (ssm:GetParameter, ssm:PutParameter, ssm:GetParametersByPath) with a resource pattern of '*'.",
    "attack_vector": "A compromised function could access or modify sensitive parameters stored in Parameter Store that may contain credentials, API keys, or other sensitive configuration data unrelated to this application.",
    "impact": "Potential exposure of sensitive configuration data or credentials stored in Parameter Store across the entire AWS account.",
    "remediation": "Scope down the SSM Parameter permissions to specific parameter paths used by the application. Use a resource pattern like 'arn:aws:ssm:*:*:parameter/idp/*' to limit access to a specific path prefix.",
    "priority": 2,
    "estimated_effort": "Low",
    "cwe_id": "CWE-732",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.16"],
    "references": ["https://docs.aws.amazon.com/systems-manager/latest/userguide/security_iam_id-based-policy-examples.html#example-permissions-delegated-set"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-003",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Repudiation",
    "severity": "Medium",
    "resource_type": "AWS::CloudWatch::Dashboard",
    "resource_name": "Dashboard",
    "title": "Insufficient Monitoring for Security Events",
    "issue": "While the solution includes comprehensive operational dashboards for performance and errors, it lacks specific monitoring for security-related events such as authentication failures, permission denied errors, or suspicious API calls.",
    "attack_vector": "Security incidents or unauthorized access attempts might go undetected without specific monitoring for security events.",
    "impact": "Delayed detection of security incidents, potentially leading to longer exposure times during a breach or attack.",
    "remediation": "Enhance the CloudWatch dashboard to include security-focused metrics and logs, including IAM access denied events, unusual API call patterns, and authentication failures.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-778",
    "compliance_violations": ["NIST 800-53 AU-6"],
    "references": ["https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch_Dashboards_Security_Monitoring.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-004",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Denial of Service",
    "severity": "Medium",
    "resource_type": "AWS::SQS::Queue",
    "resource_name": "BDACompletionFunctionDLQ",
    "title": "Missing DLQ Monitoring and Alerting",
    "issue": "The BDACompletionFunctionDLQ is configured as a dead letter queue for failed Lambda invocations, but there's no monitoring or alerting configured to notify when messages are sent to this queue.",
    "attack_vector": "Failed processing may go undetected if messages accumulate in the DLQ without alerts, potentially causing workflow disruptions or data processing failures.",
    "impact": "Potential service degradation or processing failures without timely notification, leading to operational issues or incomplete document processing.",
    "remediation": "Implement CloudWatch alarms on the ApproximateNumberOfMessagesVisible metric for the DLQ with appropriate thresholds and notifications to alert when messages start accumulating.",
    "priority": 3,
    "estimated_effort": "Low",
    "cwe_id": "CWE-778",
    "compliance_violations": ["NIST 800-53 SI-4"],
    "references": ["https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sqs-queue.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-005",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Elevation of Privilege",
    "severity": "High",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "SummarizationFunction",
    "title": "Overly Permissive Bedrock Model Access",
    "issue": "The SummarizationFunction has broad permissions to invoke any foundation model in Amazon Bedrock with the resource pattern 'arn:aws:bedrock:*::foundation-model/*'.",
    "attack_vector": "If compromised, an attacker could use the function to access any Bedrock model, potentially increasing costs dramatically or accessing more capable models to generate malicious content.",
    "impact": "Potential for unauthorized model access, cost escalation through usage of expensive models, or generation of harmful content through higher capability models.",
    "remediation": "Restrict Bedrock model access to only the specific models needed for the application. Replace the wildcard with specific model ARNs like 'arn:aws:bedrock:us-west-2::foundation-model/anthropic.claude-3-sonnet-20240229-v1:0'.",
    "priority": 2,
    "estimated_effort": "Low",
    "cwe_id": "CWE-272",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.16"],
    "references": ["https://docs.aws.amazon.com/bedrock/latest/userguide/security-iam.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-006",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Tampering",
    "severity": "Medium",
    "resource_type": "AWS::DynamoDB::Table",
    "resource_name": "BDAMetadataTable",
    "title": "No DynamoDB Table Backup Configuration",
    "issue": "The BDAMetadataTable has Point-in-Time Recovery enabled, but no regular backup schedule is defined. This could lead to potential data loss if corruption occurs.",
    "attack_vector": "In case of accidental or malicious data corruption, the recovery options may be limited without regular backups.",
    "impact": "Risk of data loss or extended recovery times if the DynamoDB table data is corrupted or accidentally modified.",
    "remediation": "Configure AWS Backup or implement a scheduled backup solution for the DynamoDB table to ensure regular backups are taken in addition to Point-in-Time Recovery.",
    "priority": 3,
    "estimated_effort": "Low",
    "cwe_id": "CWE-693",
    "compliance_violations": ["NIST 800-53 CP-9"],
    "references": ["https://docs.aws.amazon.com/aws-backup/latest/devguide/dynamo-db-backup.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-007",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Repudiation",
    "severity": "Medium",
    "resource_type": "AWS::Logs::LogGroup",
    "resource_name": "Multiple Log Groups",
    "title": "Centralized Logging Configuration Missing",
    "issue": "While CloudWatch Log Groups are defined for individual Lambda functions, there's no centralized logging solution configured (like CloudWatch Logs Insights queries, Log Groups exporting to S3, or integration with security monitoring tools).",
    "attack_vector": "Distributed logs make security incident investigation more difficult, potentially allowing attackers' actions to go undetected across multiple components.",
    "impact": "Reduced visibility into security events across the system, leading to longer investigation times and potential missed security signals.",
    "remediation": "Implement centralized logging by configuring log exports to S3, setting up CloudWatch Logs Insights queries for security events, or integrating with a SIEM solution.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-778",
    "compliance_violations": ["NIST 800-53 AU-6", "PCI DSS 10.5"],
    "references": ["https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/WhatIsCloudWatchLogs.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-008",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Spoofing",
    "severity": "Medium",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "ProcessResultsFunction",
    "title": "Unrestricted AppSync GraphQL API Access",
    "issue": "The ProcessResultsFunction has access to execute any mutation on the AppSync GraphQL API without specific operation restrictions.",
    "attack_vector": "If compromised, the function could be used to execute unintended mutations on the GraphQL API, potentially manipulating document status data.",
    "impact": "Unauthorized modification of data through the AppSync API, potentially affecting document processing status integrity.",
    "remediation": "Restrict the AppSync GraphQL access to only the specific mutations needed by the function by specifying the exact field names in the resource pattern rather than using a wildcard.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-284",
    "compliance_violations": ["NIST 800-53 AC-6"],
    "references": ["https://docs.aws.amazon.com/appsync/latest/devguide/security-authz.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-009",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Information Disclosure",
    "severity": "Low",
    "resource_type": "AWS::Serverless::StateMachine",
    "resource_name": "DocumentProcessingStateMachine",
    "title": "Step Functions Execution Data Logging Enabled",
    "issue": "The DocumentProcessingStateMachine has IncludeExecutionData set to true, which logs the entire content of state machine executions, potentially including sensitive document data.",
    "attack_vector": "Anyone with access to CloudWatch Logs could view potentially sensitive information from documents being processed.",
    "impact": "Potential exposure of sensitive document information in CloudWatch Logs, accessible to anyone with logs access permissions.",
    "remediation": "Set IncludeExecutionData to false and implement more granular logging that excludes sensitive document content while still providing necessary operational visibility.",
    "priority": 4,
    "estimated_effort": "Low",
    "cwe_id": "CWE-532",
    "compliance_violations": ["NIST 800-53 SC-4"],
    "references": ["https://docs.aws.amazon.com/step-functions/latest/dg/cloudwatch-logs.html"],
    "status": "Open"
  },
  {
    "id": "AWS-GENAI-IDP-ACCELERATOR-THREAT-010",
    "stack": "AWS GenAI IDP Accelerator",
    "stride_category": "Denial of Service",
    "severity": "Medium",
    "resource_type": "AWS::Serverless::Function",
    "resource_name": "Multiple Lambda Functions",
    "title": "Missing Lambda Concurrency Limits",
    "issue": "None of the Lambda functions have concurrency limits defined, which could lead to resource exhaustion if there's an unexpected spike in invocations.",
    "attack_vector": "An attacker could trigger excessive Lambda invocations that might impact other services or exceed Bedrock API limits.",
    "impact": "Potential service disruption due to resource exhaustion or cost implications from unexpected Lambda scaling.",
    "remediation": "Implement appropriate reserved concurrency limits on key Lambda functions to prevent excessive scaling and potential resource exhaustion.",
    "priority": 3,
    "estimated_effort": "Low",
    "cwe_id": "CWE-770",
    "compliance_violations": ["NIST 800-53 SC-5"],
    "references": ["https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html"],
    "status": "Open"
  }
]