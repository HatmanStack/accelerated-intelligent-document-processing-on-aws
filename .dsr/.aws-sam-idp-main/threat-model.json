[
  {
    "id": "GENAI-IDP-THREAT-001",
    "stack": "GenAI IDP Accelerator",
    "stride_category": "Information Disclosure",
    "severity": "High",
    "resource_type": "AWS::S3::Bucket",
    "resource_name": "WebUIBucket",
    "title": "Missing encryption for web UI S3 bucket",
    "issue": "The WebUIBucket uses AES256 server-side encryption instead of AWS KMS which is used for other buckets in the stack. This inconsistent approach to encryption could lead to data protection gaps.",
    "attack_vector": "Attackers who gain access to the S3 bucket data through other means (e.g., misconfigured permissions) would have access to unencrypted data or data encrypted with AWS-managed keys rather than customer-managed keys.",
    "impact": "Lower security posture for web UI assets, potential compliance violations for organizations requiring customer-managed keys for all storage.",
    "remediation": "Modify the WebUIBucket to use the same CustomerManagedEncryptionKey as other buckets in the stack by changing the SSEAlgorithm from AES256 to aws:kms and adding the KMSMasterKeyID.",
    "priority": 2,
    "estimated_effort": "Low",
    "cwe_id": "CWE-311",
    "compliance_violations": ["PCI DSS Requirement 3.4", "GDPR Article 32", "HIPAA Security Rule"],
    "references": ["https://docs.aws.amazon.com/AmazonS3/latest/userguide/UsingKMSEncryption.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-002",
    "stack": "GenAI IDP Accelerator",
    "stride_category": "Elevation of Privilege",
    "severity": "High",
    "resource_type": "AWS::IAM::Role",
    "resource_name": "AppSyncServiceRole",
    "title": "Overly permissive IAM role policies",
    "issue": "The AppSyncServiceRole has access to multiple Lambda functions and other services without scoping permissions to specific actions or resources where possible.",
    "attack_vector": "If the AppSync service is compromised, an attacker could leverage the role to access multiple Lambda functions and potentially pivot to other services.",
    "impact": "Violation of least privilege principle could lead to unauthorized access across multiple services in the account.",
    "remediation": "Refine IAM policies to limit permissions to only the specific actions required by each service integration, and scope resource ARNs more narrowly where possible.",
    "priority": 1,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-272",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.16", "AWS Well-Architected Framework Security Pillar"],
    "references": ["https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-003",
    "stack": "GenAI IDP Accelerator",
    "stride_category": "Repudiation",
    "severity": "Medium",
    "resource_type": "AWS::Logs::LogGroup",
    "resource_name": "Multiple Log Groups",
    "title": "Variable log retention periods",
    "issue": "While log groups have encryption enabled with KMS, the retention period is parameterized and could be set too low (as little as 1 day) which might not meet compliance requirements for log retention.",
    "attack_vector": "Attackers' activities might not be discoverable if logs are purged too quickly, preventing proper forensic analysis after a security incident.",
    "impact": "Limited ability to investigate security incidents, potential compliance violations for organizations with specific log retention requirements.",
    "remediation": "Set a minimum value for LogRetentionDays parameter that meets organizational compliance requirements (typically 90 days minimum) and ensure this is communicated in parameter descriptions.",
    "priority": 2,
    "estimated_effort": "Low",
    "cwe_id": "CWE-778",
    "compliance_violations": ["PCI DSS Requirement 10.7", "SOC 2 Common Criteria 4.1"],
    "references": ["https://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/WhatIsCloudWatchLogs.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-004",
    "stack": "GenAI IDP Accelerator",
    "stride_category": "Information Disclosure",
    "severity": "Medium",
    "resource_type": "AWS::CloudFront::Distribution",
    "resource_name": "CloudFrontDistribution",
    "title": "CloudFront using default certificate",
    "issue": "The CloudFront distribution is using the default CloudFront certificate rather than a custom certificate, which could make it harder for users to verify the authenticity of the website.",
    "attack_vector": "Phishing attacks could be mounted by creating similar-looking distributions that users might not easily distinguish from the legitimate application.",
    "impact": "Users might not trust the site, potential for successful phishing attacks against users.",
    "remediation": "Use a custom SSL certificate with AWS Certificate Manager for the CloudFront distribution to provide a domain name that matches organizational branding.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-295",
    "compliance_violations": ["OWASP Top 10 A6:2017-Security Misconfiguration"],
    "references": ["https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/using-https-alternate-domain-names.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-005",
    "stack": "GenAI IDP Accelerator",
    "stride_category": "Denial of Service",
    "severity": "Medium",
    "resource_type": "AWS::DynamoDB::Table",
    "resource_name": "TrackingTable, ConfigurationTable, AnalyticsTable",
    "title": "No read/write capacity units specified",
    "issue": "DynamoDB tables are configured with PAY_PER_REQUEST billing mode without any capacity planning, which could lead to throttling during high load and potential DoS.",
    "attack_vector": "If an attacker generates a large volume of requests, they could cause the application to be throttled by DynamoDB, affecting legitimate users.",
    "impact": "Service disruption under high load, unpredictable costs, degraded user experience.",
    "remediation": "Consider switching to PROVISIONED capacity mode with auto-scaling for critical tables or implementing application-level throttling and retry mechanisms.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-400",
    "compliance_violations": ["AWS Well-Architected Framework Reliability Pillar"],
    "references": ["https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.ReadWriteCapacityMode.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-006",
    "stack": "GenAI IDP Accelerator",
    "stride_category": "Tampering",
    "severity": "Medium",
    "resource_type": "AWS::Cognito::UserPool",
    "resource_name": "UserPool",
    "title": "No MFA required for Cognito User Pool",
    "issue": "The Cognito User Pool does not require MFA, which increases the risk of unauthorized access if user credentials are compromised.",
    "attack_vector": "Attackers who obtain user credentials through phishing or other means could directly access the application without an additional authentication factor.",
    "impact": "Higher risk of unauthorized access to sensitive data processing capabilities, potentially leading to data breaches or misuse of AI services.",
    "remediation": "Enable MFA for the Cognito User Pool, preferably using TOTP or SMS verification as a second factor.",
    "priority": 2,
    "estimated_effort": "Low",
    "cwe_id": "CWE-308",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.10", "NIST 800-53 IA-2(1)"],
    "references": ["https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-mfa.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-007",
    "stack": "GenAI IDP Accelerator",
    "stride_category": "Elevation of Privilege",
    "severity": "High",
    "resource_type": "AWS::IAM::Role",
    "resource_name": "CognitoClientUpdaterRole",
    "title": "IAM role with broad permissions",
    "issue": "The CognitoClientUpdaterRole has a policy with resource: '*' for several Cognito and SageMaker actions, which violates the principle of least privilege.",
    "attack_vector": "If the associated Lambda function is compromised, an attacker could use these broad permissions to access or modify Cognito and SageMaker resources beyond the intended scope.",
    "impact": "Potential unauthorized access to user authentication mechanisms or machine learning resources.",
    "remediation": "Scope down the permissions to specific resources where possible, limiting the role to only the specific Cognito User Pool and SageMaker workteams that need to be accessed.",
    "priority": 2,
    "estimated_effort": "Low",
    "cwe_id": "CWE-272",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.16"],
    "references": ["https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-008",
    "stack": "GenAI IDP Accelerator",
    "stride_category": "Repudiation",
    "severity": "Medium",
    "resource_type": "AWS::CloudWatch::Dashboard",
    "resource_name": "MainTemplateSubsetDashboard, MergedDashboard",
    "title": "Insufficient security metrics and alerting",
    "issue": "While there are metrics for workflow errors and execution time, there are insufficient security-specific metrics and alerts for potential security incidents (such as unusual access patterns, permission changes, or configuration modifications).",
    "attack_vector": "Attackers could perform actions that don't trigger the existing alerts but still compromise security, and these actions might go undetected.",
    "impact": "Delayed detection of security incidents, potential for unauthorized activities to continue for longer periods.",
    "remediation": "Add security-specific CloudWatch metrics and alerts, such as monitoring for unauthorized API calls, permission changes, or unusual access patterns. Consider integrating with AWS Security Hub or GuardDuty for enhanced security monitoring.",
    "priority": 2,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-778",
    "compliance_violations": ["SOC 2 Common Criteria 7.1", "NIST 800-53 AU-6"],
    "references": ["https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch_Dashboards.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-009",
    "stack": "GenAI IDP Accelerator",
    "stride_category": "Information Disclosure",
    "severity": "Medium",
    "resource_type": "AWS::Cognito::UserPoolClient",
    "resource_name": "UserPoolClient",
    "title": "Long-lived refresh tokens in Cognito User Pool Client",
    "issue": "The UserPoolClient has a RefreshTokenValidity of 30 days, which means compromised refresh tokens could be used for up to a month.",
    "attack_vector": "If a refresh token is stolen, an attacker could continue to generate new access tokens for up to 30 days without needing the original user credentials.",
    "impact": "Extended window of unauthorized access if refresh tokens are compromised.",
    "remediation": "Reduce the RefreshTokenValidity to a shorter period (e.g., 1-7 days) based on the application's security requirements, and implement proper token revocation mechanisms.",
    "priority": 3,
    "estimated_effort": "Low",
    "cwe_id": "CWE-613",
    "compliance_violations": ["OWASP Top 10 A2:2017-Broken Authentication"],
    "references": ["https://docs.aws.amazon.com/cognito/latest/developerguide/amazon-cognito-user-pools-using-tokens-with-identity-providers.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-010",
    "stack": "GenAI IDP Accelerator",
    "stride_category": "Tampering",
    "severity": "Medium",
    "resource_type": "AWS::AppSync::GraphQLApi",
    "resource_name": "GraphQLApi",
    "title": "Default ALLOW action in AppSync API authorization",
    "issue": "The GraphQL API is configured with DefaultAction: ALLOW for Cognito user pools, which means all authenticated users can access any GraphQL operation by default unless explicitly denied.",
    "attack_vector": "Authenticated users could potentially access GraphQL operations that they shouldn't have permission for if proper fine-grained access controls aren't implemented.",
    "impact": "Potential unauthorized access to data or operations within the GraphQL API.",
    "remediation": "Change the DefaultAction to DENY and use more granular authorization patterns such as @auth directives in the GraphQL schema to explicitly grant access to specific types and fields based on user groups or claims.",
    "priority": 2,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-284",
    "compliance_violations": ["OWASP Top 10 A5:2017-Broken Access Control"],
    "references": ["https://docs.aws.amazon.com/appsync/latest/devguide/security-authz.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-011",
    "stack": "GenAI IDP Accelerator",
    "stride_category": "Information Disclosure",
    "severity": "Low",
    "resource_type": "AWS::CloudFormation::CustomResource",
    "resource_name": "UpdateSettingsValues",
    "title": "Sensitive settings stored in SSM Parameter Store with default encryption",
    "issue": "The template stores settings in SSM Parameter Store, but doesn't explicitly configure the parameter with a customer-managed KMS key for encryption.",
    "attack_vector": "If an attacker gains access to SSM parameters, they might be able to access sensitive configuration information protected only by AWS-managed keys.",
    "impact": "Potential exposure of configuration information that could aid in further attacks.",
    "remediation": "Modify the SSM Parameter Store resource to use the CustomerManagedEncryptionKey for parameter encryption.",
    "priority": 4,
    "estimated_effort": "Low",
    "cwe_id": "CWE-311",
    "compliance_violations": ["CIS AWS Foundations Benchmark 2.4"],
    "references": ["https://docs.aws.amazon.com/systems-manager/latest/userguide/parameter-store-advanced-parameters.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-012",
    "stack": "GenAI IDP Accelerator",
    "stride_category": "Denial of Service",
    "severity": "Medium",
    "resource_type": "AWS::Lambda::Function",
    "resource_name": "Multiple Lambda Functions",
    "title": "No reserved concurrency for critical Lambda functions",
    "issue": "Critical Lambda functions like QueueProcessor, WorkflowTracker, and AnalyticsProcessorFunction don't have reserved concurrency configured, which could lead to resource exhaustion during high load.",
    "attack_vector": "An attacker could trigger many simultaneous Lambda invocations, potentially consuming the account's Lambda concurrency limit and affecting other functions.",
    "impact": "Potential service degradation or unavailability during high traffic periods or DoS attacks.",
    "remediation": "Configure reserved concurrency for critical Lambda functions to ensure they always have resources available, and set provisioned concurrency for functions that need consistent performance.",
    "priority": 3,
    "estimated_effort": "Low",
    "cwe_id": "CWE-400",
    "compliance_violations": ["AWS Well-Architected Framework Reliability Pillar"],
    "references": ["https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-013",
    "stack": "GenAI IDP Accelerator",
    "stride_category": "Spoofing",
    "severity": "Medium",
    "resource_type": "AWS::Cognito::UserPool",
    "resource_name": "UserPool",
    "title": "No advanced security features for Cognito User Pool",
    "issue": "The Cognito User Pool does not have advanced security features enabled, such as risk-based adaptive authentication or compromised credentials checking.",
    "attack_vector": "Attackers could use credential stuffing or brute force attacks without triggering additional security measures beyond basic password policies.",
    "impact": "Higher risk of unauthorized access through compromised credentials or automated attacks.",
    "remediation": "Enable Cognito Advanced Security features, including risk-based authentication and compromised credentials checking.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-307",
    "compliance_violations": ["NIST 800-63B"],
    "references": ["https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pool-settings-advanced-security.html"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-014",
    "stack": "GenAI IDP Accelerator",
    "stride_category": "Tampering",
    "severity": "Low",
    "resource_type": "AWS::CloudFormation::Stack",
    "resource_name": "PATTERN1STACK, PATTERN2STACK, PATTERN3STACK",
    "title": "Nested stacks pass sensitive parameters",
    "issue": "Sensitive parameters like KMS key ARNs, bucket names, and role ARNs are passed to nested stacks as plaintext parameters, which could expose this information in CloudFormation events and logs.",
    "attack_vector": "Attackers with access to CloudFormation event logs or deployment history could access sensitive configuration details.",
    "impact": "Exposure of internal resource identifiers that could aid in planning further attacks.",
    "remediation": "Consider using AWS Secrets Manager or SSM Parameter Store for passing sensitive values to nested stacks, or implement NoEcho properties on sensitive parameters.",
    "priority": 4,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-312",
    "compliance_violations": ["CIS AWS Foundations Benchmark 3.1"],
    "references": ["https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/parameters-section-structure.html#parameters-section-structure-properties"],
    "status": "Open"
  },
  {
    "id": "GENAI-IDP-THREAT-015",
    "stack": "GenAI IDP Accelerator",
    "stride_category": "Elevation of Privilege",
    "severity": "High",
    "resource_type": "AWS::IAM::Role",
    "resource_name": "A2IHumanTaskUILambdaRole, DashboardMergerFunction",
    "title": "IAM roles with wildcard resource permissions",
    "issue": "Several IAM roles in the template use wildcard (*) resource permissions for various AWS services, which violates the principle of least privilege.",
    "attack_vector": "If a Lambda function using these roles is compromised, an attacker could access or modify resources beyond the intended scope.",
    "impact": "Potential unauthorized access to resources within the AWS account.",
    "remediation": "Refine IAM policies to scope permissions to specific resources where possible, and limit actions to only what is required.",
    "priority": 1,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-272",
    "compliance_violations": ["CIS AWS Foundations Benchmark 1.16", "AWS Well-Architected Framework Security Pillar"],
    "references": ["https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege"],
    "status": "Open"
  }
]