{"check_type": "cloudformation", "results": {"failed_checks": [{"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[224, "  GetAdjustedStackNameFunction:\n"], [225, "    Type: AWS::Serverless::Function\n"], [226, "    Metadata:\n"], [227, "      cfn_nag:\n"], [228, "        rules_to_suppress:\n"], [229, "        - id: W89\n"], [230, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [231, "            services via APIs\n"], [232, "        - id: W92\n"], [233, "          reason: Function does not require reserved concurrency as it scales based\n"], [234, "            on demand\n"], [235, "      SamResourceId: GetAdjustedStackNameFunction\n"], [236, "    Properties:\n"], [237, "      PermissionsBoundary:\n"], [238, "        Fn::If:\n"], [239, "        - HasPermissionsBoundary\n"], [240, "        - Ref: PermissionsBoundaryArn\n"], [241, "        - Ref: AWS::NoValue\n"], [242, "      Handler: index.handler\n"], [243, "      Runtime: python3.12\n"], [244, "      Timeout: 30\n"], [245, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [246, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [247, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [248, "        \\ log_level))\\n\\ndef handler(event, context):\\n    logger.info(event)  \\n\\\n"], [249, "        \\    output = event['ResourceProperties'].get('InputString', '').lower()\\n\\\n"], [250, "        \\    output = output[:32]\\n    responseData = {'OutputString': output}   \\\n"], [251, "        \\                                         \\n    cfnresponse.send(event, context,\\\n"], [252, "        \\ cfnresponse.SUCCESS, responseData)\\n\"\n"], [253, "      Environment:\n"], [254, "        Variables:\n"], [255, "          LOG_LEVEL:\n"], [256, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [224, 256], "resource": "AWS::Serverless::Function.GetAdjustedStackNameFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[224, "  GetAdjustedStackNameFunction:\n"], [225, "    Type: AWS::Serverless::Function\n"], [226, "    Metadata:\n"], [227, "      cfn_nag:\n"], [228, "        rules_to_suppress:\n"], [229, "        - id: W89\n"], [230, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [231, "            services via APIs\n"], [232, "        - id: W92\n"], [233, "          reason: Function does not require reserved concurrency as it scales based\n"], [234, "            on demand\n"], [235, "      SamResourceId: GetAdjustedStackNameFunction\n"], [236, "    Properties:\n"], [237, "      PermissionsBoundary:\n"], [238, "        Fn::If:\n"], [239, "        - HasPermissionsBoundary\n"], [240, "        - Ref: PermissionsBoundaryArn\n"], [241, "        - Ref: AWS::NoValue\n"], [242, "      Handler: index.handler\n"], [243, "      Runtime: python3.12\n"], [244, "      Timeout: 30\n"], [245, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [246, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [247, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [248, "        \\ log_level))\\n\\ndef handler(event, context):\\n    logger.info(event)  \\n\\\n"], [249, "        \\    output = event['ResourceProperties'].get('InputString', '').lower()\\n\\\n"], [250, "        \\    output = output[:32]\\n    responseData = {'OutputString': output}   \\\n"], [251, "        \\                                         \\n    cfnresponse.send(event, context,\\\n"], [252, "        \\ cfnresponse.SUCCESS, responseData)\\n\"\n"], [253, "      Environment:\n"], [254, "        Variables:\n"], [255, "          LOG_LEVEL:\n"], [256, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [224, 256], "resource": "AWS::Serverless::Function.GetAdjustedStackNameFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[224, "  GetAdjustedStackNameFunction:\n"], [225, "    Type: AWS::Serverless::Function\n"], [226, "    Metadata:\n"], [227, "      cfn_nag:\n"], [228, "        rules_to_suppress:\n"], [229, "        - id: W89\n"], [230, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [231, "            services via APIs\n"], [232, "        - id: W92\n"], [233, "          reason: Function does not require reserved concurrency as it scales based\n"], [234, "            on demand\n"], [235, "      SamResourceId: GetAdjustedStackNameFunction\n"], [236, "    Properties:\n"], [237, "      PermissionsBoundary:\n"], [238, "        Fn::If:\n"], [239, "        - HasPermissionsBoundary\n"], [240, "        - Ref: PermissionsBoundaryArn\n"], [241, "        - Ref: AWS::NoValue\n"], [242, "      Handler: index.handler\n"], [243, "      Runtime: python3.12\n"], [244, "      Timeout: 30\n"], [245, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [246, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [247, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [248, "        \\ log_level))\\n\\ndef handler(event, context):\\n    logger.info(event)  \\n\\\n"], [249, "        \\    output = event['ResourceProperties'].get('InputString', '').lower()\\n\\\n"], [250, "        \\    output = output[:32]\\n    responseData = {'OutputString': output}   \\\n"], [251, "        \\                                         \\n    cfnresponse.send(event, context,\\\n"], [252, "        \\ cfnresponse.SUCCESS, responseData)\\n\"\n"], [253, "      Environment:\n"], [254, "        Variables:\n"], [255, "          LOG_LEVEL:\n"], [256, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [224, 256], "resource": "AWS::Serverless::Function.GetAdjustedStackNameFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[224, "  GetAdjustedStackNameFunction:\n"], [225, "    Type: AWS::Serverless::Function\n"], [226, "    Metadata:\n"], [227, "      cfn_nag:\n"], [228, "        rules_to_suppress:\n"], [229, "        - id: W89\n"], [230, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [231, "            services via APIs\n"], [232, "        - id: W92\n"], [233, "          reason: Function does not require reserved concurrency as it scales based\n"], [234, "            on demand\n"], [235, "      SamResourceId: GetAdjustedStackNameFunction\n"], [236, "    Properties:\n"], [237, "      PermissionsBoundary:\n"], [238, "        Fn::If:\n"], [239, "        - HasPermissionsBoundary\n"], [240, "        - Ref: PermissionsBoundaryArn\n"], [241, "        - Ref: AWS::NoValue\n"], [242, "      Handler: index.handler\n"], [243, "      Runtime: python3.12\n"], [244, "      Timeout: 30\n"], [245, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [246, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [247, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [248, "        \\ log_level))\\n\\ndef handler(event, context):\\n    logger.info(event)  \\n\\\n"], [249, "        \\    output = event['ResourceProperties'].get('InputString', '').lower()\\n\\\n"], [250, "        \\    output = output[:32]\\n    responseData = {'OutputString': output}   \\\n"], [251, "        \\                                         \\n    cfnresponse.send(event, context,\\\n"], [252, "        \\ cfnresponse.SUCCESS, responseData)\\n\"\n"], [253, "      Environment:\n"], [254, "        Variables:\n"], [255, "          LOG_LEVEL:\n"], [256, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [224, 256], "resource": "AWS::Serverless::Function.GetAdjustedStackNameFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[268, "  GetSeedUrlsFunction:\n"], [269, "    Type: AWS::Serverless::Function\n"], [270, "    Metadata:\n"], [271, "      cfn_nag:\n"], [272, "        rules_to_suppress:\n"], [273, "        - id: W89\n"], [274, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [275, "            services via APIs\n"], [276, "        - id: W92\n"], [277, "          reason: Function does not require reserved concurrency as it scales based\n"], [278, "            on demand\n"], [279, "      SamResourceId: GetSeedUrlsFunction\n"], [280, "    Properties:\n"], [281, "      PermissionsBoundary:\n"], [282, "        Fn::If:\n"], [283, "        - HasPermissionsBoundary\n"], [284, "        - Ref: PermissionsBoundaryArn\n"], [285, "        - Ref: AWS::NoValue\n"], [286, "      Handler: index.handler\n"], [287, "      Runtime: python3.12\n"], [288, "      Timeout: 30\n"], [289, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [290, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [291, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [292, "        \\ log_level))\\n\\ndef handler(event, context):\\n  logger.info(event)\\n  urls\\\n"], [293, "        \\ = event['ResourceProperties'].get('WebCrawlerURLs', '').split(',')\\n  seedUrls\\\n"], [294, "        \\ = [{'Url': url.strip()} for url in urls]\\n  responseData = {'SeedUrls':\\\n"], [295, "        \\ seedUrls}\\n  cfnresponse.send(event, context, cfnresponse.SUCCESS, responseData)\\n\"\n"], [296, "      Environment:\n"], [297, "        Variables:\n"], [298, "          LOG_LEVEL:\n"], [299, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [268, 299], "resource": "AWS::Serverless::Function.GetSeedUrlsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[268, "  GetSeedUrlsFunction:\n"], [269, "    Type: AWS::Serverless::Function\n"], [270, "    Metadata:\n"], [271, "      cfn_nag:\n"], [272, "        rules_to_suppress:\n"], [273, "        - id: W89\n"], [274, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [275, "            services via APIs\n"], [276, "        - id: W92\n"], [277, "          reason: Function does not require reserved concurrency as it scales based\n"], [278, "            on demand\n"], [279, "      SamResourceId: GetSeedUrlsFunction\n"], [280, "    Properties:\n"], [281, "      PermissionsBoundary:\n"], [282, "        Fn::If:\n"], [283, "        - HasPermissionsBoundary\n"], [284, "        - Ref: PermissionsBoundaryArn\n"], [285, "        - Ref: AWS::NoValue\n"], [286, "      Handler: index.handler\n"], [287, "      Runtime: python3.12\n"], [288, "      Timeout: 30\n"], [289, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [290, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [291, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [292, "        \\ log_level))\\n\\ndef handler(event, context):\\n  logger.info(event)\\n  urls\\\n"], [293, "        \\ = event['ResourceProperties'].get('WebCrawlerURLs', '').split(',')\\n  seedUrls\\\n"], [294, "        \\ = [{'Url': url.strip()} for url in urls]\\n  responseData = {'SeedUrls':\\\n"], [295, "        \\ seedUrls}\\n  cfnresponse.send(event, context, cfnresponse.SUCCESS, responseData)\\n\"\n"], [296, "      Environment:\n"], [297, "        Variables:\n"], [298, "          LOG_LEVEL:\n"], [299, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [268, 299], "resource": "AWS::Serverless::Function.GetSeedUrlsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[268, "  GetSeedUrlsFunction:\n"], [269, "    Type: AWS::Serverless::Function\n"], [270, "    Metadata:\n"], [271, "      cfn_nag:\n"], [272, "        rules_to_suppress:\n"], [273, "        - id: W89\n"], [274, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [275, "            services via APIs\n"], [276, "        - id: W92\n"], [277, "          reason: Function does not require reserved concurrency as it scales based\n"], [278, "            on demand\n"], [279, "      SamResourceId: GetSeedUrlsFunction\n"], [280, "    Properties:\n"], [281, "      PermissionsBoundary:\n"], [282, "        Fn::If:\n"], [283, "        - HasPermissionsBoundary\n"], [284, "        - Ref: PermissionsBoundaryArn\n"], [285, "        - Ref: AWS::NoValue\n"], [286, "      Handler: index.handler\n"], [287, "      Runtime: python3.12\n"], [288, "      Timeout: 30\n"], [289, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [290, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [291, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [292, "        \\ log_level))\\n\\ndef handler(event, context):\\n  logger.info(event)\\n  urls\\\n"], [293, "        \\ = event['ResourceProperties'].get('WebCrawlerURLs', '').split(',')\\n  seedUrls\\\n"], [294, "        \\ = [{'Url': url.strip()} for url in urls]\\n  responseData = {'SeedUrls':\\\n"], [295, "        \\ seedUrls}\\n  cfnresponse.send(event, context, cfnresponse.SUCCESS, responseData)\\n\"\n"], [296, "      Environment:\n"], [297, "        Variables:\n"], [298, "          LOG_LEVEL:\n"], [299, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [268, 299], "resource": "AWS::Serverless::Function.GetSeedUrlsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[268, "  GetSeedUrlsFunction:\n"], [269, "    Type: AWS::Serverless::Function\n"], [270, "    Metadata:\n"], [271, "      cfn_nag:\n"], [272, "        rules_to_suppress:\n"], [273, "        - id: W89\n"], [274, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [275, "            services via APIs\n"], [276, "        - id: W92\n"], [277, "          reason: Function does not require reserved concurrency as it scales based\n"], [278, "            on demand\n"], [279, "      SamResourceId: GetSeedUrlsFunction\n"], [280, "    Properties:\n"], [281, "      PermissionsBoundary:\n"], [282, "        Fn::If:\n"], [283, "        - HasPermissionsBoundary\n"], [284, "        - Ref: PermissionsBoundaryArn\n"], [285, "        - Ref: AWS::NoValue\n"], [286, "      Handler: index.handler\n"], [287, "      Runtime: python3.12\n"], [288, "      Timeout: 30\n"], [289, "      InlineCode: \"import cfnresponse\\nimport time\\nimport os\\nimport logging\\n\\n\\\n"], [290, "        # Get logging level from environment variable with INFO as default\\nlog_level\\\n"], [291, "        \\ = os.environ.get('LOG_LEVEL', 'INFO')\\nlogger = logging.getLogger()\\nlogger.setLevel(getattr(logging,\\\n"], [292, "        \\ log_level))\\n\\ndef handler(event, context):\\n  logger.info(event)\\n  urls\\\n"], [293, "        \\ = event['ResourceProperties'].get('WebCrawlerURLs', '').split(',')\\n  seedUrls\\\n"], [294, "        \\ = [{'Url': url.strip()} for url in urls]\\n  responseData = {'SeedUrls':\\\n"], [295, "        \\ seedUrls}\\n  cfnresponse.send(event, context, cfnresponse.SUCCESS, responseData)\\n\"\n"], [296, "      Environment:\n"], [297, "        Variables:\n"], [298, "          LOG_LEVEL:\n"], [299, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [268, 299], "resource": "AWS::Serverless::Function.GetSeedUrlsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[453, "  CreateOSSIndexLambdaFunction:\n"], [454, "    Type: AWS::Serverless::Function\n"], [455, "    Metadata:\n"], [456, "      SamResourceId: CreateOSSIndexLambdaFunction\n"], [457, "      cfn_nag:\n"], [458, "        rules_to_suppress:\n"], [459, "        - id: W89\n"], [460, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [461, "            services via APIs\n"], [462, "        - id: W92\n"], [463, "          reason: Function does not require reserved concurrency as it scales based\n"], [464, "            on demand\n"], [465, "    Properties:\n"], [466, "      PermissionsBoundary:\n"], [467, "        Fn::If:\n"], [468, "        - HasPermissionsBoundary\n"], [469, "        - Ref: PermissionsBoundaryArn\n"], [470, "        - Ref: AWS::NoValue\n"], [471, "      Handler: oss_handler.lambda_handler\n"], [472, "      MemorySize: 1024\n"], [473, "      Role:\n"], [474, "        Fn::GetAtt:\n"], [475, "        - OpenSearchLambdaExecutionRole\n"], [476, "        - Arn\n"], [477, "      Runtime: python3.12\n"], [478, "      Timeout: 840\n"], [479, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/3b7fdf47c9394bfa668db72674e60685\n"], [480, "      Environment:\n"], [481, "        Variables:\n"], [482, "          POWERTOOLS_SERVICE_NAME: InfraSetupLambda\n"], [483, "          POWERTOOLS_METRICS_NAMESPACE: InfraSetupLambda-NameSpace\n"], [484, "          POWERTOOLS_LOG_LEVEL:\n"], [485, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [453, 485], "resource": "AWS::Serverless::Function.CreateOSSIndexLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.POWERTOOLS_LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[453, "  CreateOSSIndexLambdaFunction:\n"], [454, "    Type: AWS::Serverless::Function\n"], [455, "    Metadata:\n"], [456, "      SamResourceId: CreateOSSIndexLambdaFunction\n"], [457, "      cfn_nag:\n"], [458, "        rules_to_suppress:\n"], [459, "        - id: W89\n"], [460, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [461, "            services via APIs\n"], [462, "        - id: W92\n"], [463, "          reason: Function does not require reserved concurrency as it scales based\n"], [464, "            on demand\n"], [465, "    Properties:\n"], [466, "      PermissionsBoundary:\n"], [467, "        Fn::If:\n"], [468, "        - HasPermissionsBoundary\n"], [469, "        - Ref: PermissionsBoundaryArn\n"], [470, "        - Ref: AWS::NoValue\n"], [471, "      Handler: oss_handler.lambda_handler\n"], [472, "      MemorySize: 1024\n"], [473, "      Role:\n"], [474, "        Fn::GetAtt:\n"], [475, "        - OpenSearchLambdaExecutionRole\n"], [476, "        - Arn\n"], [477, "      Runtime: python3.12\n"], [478, "      Timeout: 840\n"], [479, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/3b7fdf47c9394bfa668db72674e60685\n"], [480, "      Environment:\n"], [481, "        Variables:\n"], [482, "          POWERTOOLS_SERVICE_NAME: InfraSetupLambda\n"], [483, "          POWERTOOLS_METRICS_NAMESPACE: InfraSetupLambda-NameSpace\n"], [484, "          POWERTOOLS_LOG_LEVEL:\n"], [485, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [453, 485], "resource": "AWS::Serverless::Function.CreateOSSIndexLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.POWERTOOLS_LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[453, "  CreateOSSIndexLambdaFunction:\n"], [454, "    Type: AWS::Serverless::Function\n"], [455, "    Metadata:\n"], [456, "      SamResourceId: CreateOSSIndexLambdaFunction\n"], [457, "      cfn_nag:\n"], [458, "        rules_to_suppress:\n"], [459, "        - id: W89\n"], [460, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [461, "            services via APIs\n"], [462, "        - id: W92\n"], [463, "          reason: Function does not require reserved concurrency as it scales based\n"], [464, "            on demand\n"], [465, "    Properties:\n"], [466, "      PermissionsBoundary:\n"], [467, "        Fn::If:\n"], [468, "        - HasPermissionsBoundary\n"], [469, "        - Ref: PermissionsBoundaryArn\n"], [470, "        - Ref: AWS::NoValue\n"], [471, "      Handler: oss_handler.lambda_handler\n"], [472, "      MemorySize: 1024\n"], [473, "      Role:\n"], [474, "        Fn::GetAtt:\n"], [475, "        - OpenSearchLambdaExecutionRole\n"], [476, "        - Arn\n"], [477, "      Runtime: python3.12\n"], [478, "      Timeout: 840\n"], [479, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/3b7fdf47c9394bfa668db72674e60685\n"], [480, "      Environment:\n"], [481, "        Variables:\n"], [482, "          POWERTOOLS_SERVICE_NAME: InfraSetupLambda\n"], [483, "          POWERTOOLS_METRICS_NAMESPACE: InfraSetupLambda-NameSpace\n"], [484, "          POWERTOOLS_LOG_LEVEL:\n"], [485, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [453, 485], "resource": "AWS::Serverless::Function.CreateOSSIndexLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.POWERTOOLS_LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[453, "  CreateOSSIndexLambdaFunction:\n"], [454, "    Type: AWS::Serverless::Function\n"], [455, "    Metadata:\n"], [456, "      SamResourceId: CreateOSSIndexLambdaFunction\n"], [457, "      cfn_nag:\n"], [458, "        rules_to_suppress:\n"], [459, "        - id: W89\n"], [460, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [461, "            services via APIs\n"], [462, "        - id: W92\n"], [463, "          reason: Function does not require reserved concurrency as it scales based\n"], [464, "            on demand\n"], [465, "    Properties:\n"], [466, "      PermissionsBoundary:\n"], [467, "        Fn::If:\n"], [468, "        - HasPermissionsBoundary\n"], [469, "        - Ref: PermissionsBoundaryArn\n"], [470, "        - Ref: AWS::NoValue\n"], [471, "      Handler: oss_handler.lambda_handler\n"], [472, "      MemorySize: 1024\n"], [473, "      Role:\n"], [474, "        Fn::GetAtt:\n"], [475, "        - OpenSearchLambdaExecutionRole\n"], [476, "        - Arn\n"], [477, "      Runtime: python3.12\n"], [478, "      Timeout: 840\n"], [479, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/3b7fdf47c9394bfa668db72674e60685\n"], [480, "      Environment:\n"], [481, "        Variables:\n"], [482, "          POWERTOOLS_SERVICE_NAME: InfraSetupLambda\n"], [483, "          POWERTOOLS_METRICS_NAMESPACE: InfraSetupLambda-NameSpace\n"], [484, "          POWERTOOLS_LOG_LEVEL:\n"], [485, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [453, 485], "resource": "AWS::Serverless::Function.CreateOSSIndexLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.POWERTOOLS_LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterConfig/TargetArn"]}, "code_block": [[770, "  StartIngestionJobFunction:\n"], [771, "    Type: AWS::Lambda::Function\n"], [772, "    Metadata:\n"], [773, "      SamResourceId: StartIngestionJobFunction\n"], [774, "      cfn_nag:\n"], [775, "        rules_to_suppress:\n"], [776, "        - id: W89\n"], [777, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [778, "            services via APIs\n"], [779, "        - id: W92\n"], [780, "          reason: Function does not require reserved concurrency as it scales based\n"], [781, "            on demand\n"], [782, "    Properties:\n"], [783, "      Handler: handler.lambda_handler\n"], [784, "      Role:\n"], [785, "        Fn::GetAtt:\n"], [786, "        - StartIngestionJobFunctionRole\n"], [787, "        - Arn\n"], [788, "      Runtime: python3.12\n"], [789, "      Timeout: 600\n"], [790, "      MemorySize: 128\n"], [791, "      Code:\n"], [792, "        S3Bucket: bobs-artifacts-us-west-2\n"], [793, "        S3Key: idp-dev-private/0.3.12-wip/ab418b38211c1cb52a5dcf3b34599bf2\n"], [794, "      Environment:\n"], [795, "        Variables:\n"], [796, "          LOG_LEVEL:\n"], [797, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [770, 797], "resource": "AWS::Lambda::Function.StartIngestionJobFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[770, "  StartIngestionJobFunction:\n"], [771, "    Type: AWS::Lambda::Function\n"], [772, "    Metadata:\n"], [773, "      SamResourceId: StartIngestionJobFunction\n"], [774, "      cfn_nag:\n"], [775, "        rules_to_suppress:\n"], [776, "        - id: W89\n"], [777, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [778, "            services via APIs\n"], [779, "        - id: W92\n"], [780, "          reason: Function does not require reserved concurrency as it scales based\n"], [781, "            on demand\n"], [782, "    Properties:\n"], [783, "      Handler: handler.lambda_handler\n"], [784, "      Role:\n"], [785, "        Fn::GetAtt:\n"], [786, "        - StartIngestionJobFunctionRole\n"], [787, "        - Arn\n"], [788, "      Runtime: python3.12\n"], [789, "      Timeout: 600\n"], [790, "      MemorySize: 128\n"], [791, "      Code:\n"], [792, "        S3Bucket: bobs-artifacts-us-west-2\n"], [793, "        S3Key: idp-dev-private/0.3.12-wip/ab418b38211c1cb52a5dcf3b34599bf2\n"], [794, "      Environment:\n"], [795, "        Variables:\n"], [796, "          LOG_LEVEL:\n"], [797, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [770, 797], "resource": "AWS::Lambda::Function.StartIngestionJobFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[770, "  StartIngestionJobFunction:\n"], [771, "    Type: AWS::Lambda::Function\n"], [772, "    Metadata:\n"], [773, "      SamResourceId: StartIngestionJobFunction\n"], [774, "      cfn_nag:\n"], [775, "        rules_to_suppress:\n"], [776, "        - id: W89\n"], [777, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [778, "            services via APIs\n"], [779, "        - id: W92\n"], [780, "          reason: Function does not require reserved concurrency as it scales based\n"], [781, "            on demand\n"], [782, "    Properties:\n"], [783, "      Handler: handler.lambda_handler\n"], [784, "      Role:\n"], [785, "        Fn::GetAtt:\n"], [786, "        - StartIngestionJobFunctionRole\n"], [787, "        - Arn\n"], [788, "      Runtime: python3.12\n"], [789, "      Timeout: 600\n"], [790, "      MemorySize: 128\n"], [791, "      Code:\n"], [792, "        S3Bucket: bobs-artifacts-us-west-2\n"], [793, "        S3Key: idp-dev-private/0.3.12-wip/ab418b38211c1cb52a5dcf3b34599bf2\n"], [794, "      Environment:\n"], [795, "        Variables:\n"], [796, "          LOG_LEVEL:\n"], [797, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [770, 797], "resource": "AWS::Lambda::Function.StartIngestionJobFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[770, "  StartIngestionJobFunction:\n"], [771, "    Type: AWS::Lambda::Function\n"], [772, "    Metadata:\n"], [773, "      SamResourceId: StartIngestionJobFunction\n"], [774, "      cfn_nag:\n"], [775, "        rules_to_suppress:\n"], [776, "        - id: W89\n"], [777, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [778, "            services via APIs\n"], [779, "        - id: W92\n"], [780, "          reason: Function does not require reserved concurrency as it scales based\n"], [781, "            on demand\n"], [782, "    Properties:\n"], [783, "      Handler: handler.lambda_handler\n"], [784, "      Role:\n"], [785, "        Fn::GetAtt:\n"], [786, "        - StartIngestionJobFunctionRole\n"], [787, "        - Arn\n"], [788, "      Runtime: python3.12\n"], [789, "      Timeout: 600\n"], [790, "      MemorySize: 128\n"], [791, "      Code:\n"], [792, "        S3Bucket: bobs-artifacts-us-west-2\n"], [793, "        S3Key: idp-dev-private/0.3.12-wip/ab418b38211c1cb52a5dcf3b34599bf2\n"], [794, "      Environment:\n"], [795, "        Variables:\n"], [796, "          LOG_LEVEL:\n"], [797, "            Ref: LogLevel\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [770, 797], "resource": "AWS::Lambda::Function.StartIngestionJobFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/.aws-sam/build/DOCUMENTBEDROCKKB/template.yaml", "attribute_key": "Default"}]}}]}, "summary": {"passed": 45, "failed": 16, "skipped": 0, "parsing_errors": 0, "resource_count": 22, "checkov_version": "3.2.461"}}