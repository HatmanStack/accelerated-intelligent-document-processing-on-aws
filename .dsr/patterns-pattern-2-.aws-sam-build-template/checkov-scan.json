{"check_type": "cloudformation", "results": {"failed_checks": [{"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[952, "  OCRFunction:\n"], [953, "    Type: AWS::Serverless::Function\n"], [954, "    Metadata:\n"], [955, "      SamResourceId: OCRFunction\n"], [956, "      cfn_nag:\n"], [957, "        rules_to_suppress:\n"], [958, "        - id: W89\n"], [959, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [960, "            with AWS services via AWS APIs\n"], [961, "        - id: W92\n"], [962, "          reason: Function does not require concurrent execution limits as it is designed\n"], [963, "            to scale based on demand\n"], [964, "        - id: W11\n"], [965, "          reason: Textract DetectDocumentText API and Cloudwatch APIs do not support\n"], [966, "            resource-level permissions\n"], [967, "    Properties:\n"], [968, "      PermissionsBoundary:\n"], [969, "        Fn::If:\n"], [970, "        - HasPermissionsBoundary\n"], [971, "        - Ref: PermissionsBoundaryArn\n"], [972, "        - Ref: AWS::NoValue\n"], [973, "      CodeUri: OCRFunction\n"], [974, "      Handler: index.handler\n"], [975, "      Runtime: python3.12\n"], [976, "      Timeout: 900\n"], [977, "      MemorySize: 4096\n"], [978, "      Environment:\n"], [979, "        Variables:\n"], [980, "          METRIC_NAMESPACE:\n"], [981, "            Ref: StackName\n"], [982, "          MAX_WORKERS: 20\n"], [983, "          CONFIGURATION_TABLE_NAME:\n"], [984, "            Ref: ConfigurationTable\n"], [985, "          LOG_LEVEL:\n"], [986, "            Ref: LogLevel\n"], [987, "          APPSYNC_API_URL:\n"], [988, "            Ref: AppSyncApiUrl\n"], [989, "          WORKING_BUCKET:\n"], [990, "            Ref: WorkingBucket\n"], [991, "      LoggingConfig:\n"], [992, "        LogGroup:\n"], [993, "          Ref: OCRFunctionLogGroup\n"], [994, "      Policies:\n"], [995, "      - AWSLambdaBasicExecutionRole\n"], [996, "      - S3CrudPolicy:\n"], [997, "          BucketName:\n"], [998, "            Ref: OutputBucket\n"], [999, "      - S3CrudPolicy:\n"], [1000, "          BucketName:\n"], [1001, "            Ref: WorkingBucket\n"], [1002, "      - S3ReadPolicy:\n"], [1003, "          BucketName:\n"], [1004, "            Ref: InputBucket\n"], [1005, "      - DynamoDBCrudPolicy:\n"], [1006, "          TableName:\n"], [1007, "            Ref: ConfigurationTable\n"], [1008, "      - Statement:\n"], [1009, "        - Effect: Allow\n"], [1010, "          Action: cloudwatch:PutMetricData\n"], [1011, "          Resource: '*'\n"], [1012, "        - Effect: Allow\n"], [1013, "          Action:\n"], [1014, "          - kms:Encrypt\n"], [1015, "          - kms:Decrypt\n"], [1016, "          - kms:ReEncrypt*\n"], [1017, "          - kms:GenerateDataKey*\n"], [1018, "          - kms:DescribeKey\n"], [1019, "          Resource:\n"], [1020, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1021, "        - Effect: Allow\n"], [1022, "          Action:\n"], [1023, "          - textract:DetectDocumentText\n"], [1024, "          - textract:AnalyzeDocument\n"], [1025, "          Resource: '*'\n"], [1026, "        - Effect: Allow\n"], [1027, "          Action: bedrock:InvokeModel\n"], [1028, "          Resource:\n"], [1029, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1030, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1031, "        - Effect: Allow\n"], [1032, "          Action:\n"], [1033, "          - appsync:GraphQL\n"], [1034, "          Resource:\n"], [1035, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [952, 1035], "resource": "AWS::Serverless::Function.OCRFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[952, "  OCRFunction:\n"], [953, "    Type: AWS::Serverless::Function\n"], [954, "    Metadata:\n"], [955, "      SamResourceId: OCRFunction\n"], [956, "      cfn_nag:\n"], [957, "        rules_to_suppress:\n"], [958, "        - id: W89\n"], [959, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [960, "            with AWS services via AWS APIs\n"], [961, "        - id: W92\n"], [962, "          reason: Function does not require concurrent execution limits as it is designed\n"], [963, "            to scale based on demand\n"], [964, "        - id: W11\n"], [965, "          reason: Textract DetectDocumentText API and Cloudwatch APIs do not support\n"], [966, "            resource-level permissions\n"], [967, "    Properties:\n"], [968, "      PermissionsBoundary:\n"], [969, "        Fn::If:\n"], [970, "        - HasPermissionsBoundary\n"], [971, "        - Ref: PermissionsBoundaryArn\n"], [972, "        - Ref: AWS::NoValue\n"], [973, "      CodeUri: OCRFunction\n"], [974, "      Handler: index.handler\n"], [975, "      Runtime: python3.12\n"], [976, "      Timeout: 900\n"], [977, "      MemorySize: 4096\n"], [978, "      Environment:\n"], [979, "        Variables:\n"], [980, "          METRIC_NAMESPACE:\n"], [981, "            Ref: StackName\n"], [982, "          MAX_WORKERS: 20\n"], [983, "          CONFIGURATION_TABLE_NAME:\n"], [984, "            Ref: ConfigurationTable\n"], [985, "          LOG_LEVEL:\n"], [986, "            Ref: LogLevel\n"], [987, "          APPSYNC_API_URL:\n"], [988, "            Ref: AppSyncApiUrl\n"], [989, "          WORKING_BUCKET:\n"], [990, "            Ref: WorkingBucket\n"], [991, "      LoggingConfig:\n"], [992, "        LogGroup:\n"], [993, "          Ref: OCRFunctionLogGroup\n"], [994, "      Policies:\n"], [995, "      - AWSLambdaBasicExecutionRole\n"], [996, "      - S3CrudPolicy:\n"], [997, "          BucketName:\n"], [998, "            Ref: OutputBucket\n"], [999, "      - S3CrudPolicy:\n"], [1000, "          BucketName:\n"], [1001, "            Ref: WorkingBucket\n"], [1002, "      - S3ReadPolicy:\n"], [1003, "          BucketName:\n"], [1004, "            Ref: InputBucket\n"], [1005, "      - DynamoDBCrudPolicy:\n"], [1006, "          TableName:\n"], [1007, "            Ref: ConfigurationTable\n"], [1008, "      - Statement:\n"], [1009, "        - Effect: Allow\n"], [1010, "          Action: cloudwatch:PutMetricData\n"], [1011, "          Resource: '*'\n"], [1012, "        - Effect: Allow\n"], [1013, "          Action:\n"], [1014, "          - kms:Encrypt\n"], [1015, "          - kms:Decrypt\n"], [1016, "          - kms:ReEncrypt*\n"], [1017, "          - kms:GenerateDataKey*\n"], [1018, "          - kms:DescribeKey\n"], [1019, "          Resource:\n"], [1020, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1021, "        - Effect: Allow\n"], [1022, "          Action:\n"], [1023, "          - textract:DetectDocumentText\n"], [1024, "          - textract:AnalyzeDocument\n"], [1025, "          Resource: '*'\n"], [1026, "        - Effect: Allow\n"], [1027, "          Action: bedrock:InvokeModel\n"], [1028, "          Resource:\n"], [1029, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1030, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1031, "        - Effect: Allow\n"], [1032, "          Action:\n"], [1033, "          - appsync:GraphQL\n"], [1034, "          Resource:\n"], [1035, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [952, 1035], "resource": "AWS::Serverless::Function.OCRFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[952, "  OCRFunction:\n"], [953, "    Type: AWS::Serverless::Function\n"], [954, "    Metadata:\n"], [955, "      SamResourceId: OCRFunction\n"], [956, "      cfn_nag:\n"], [957, "        rules_to_suppress:\n"], [958, "        - id: W89\n"], [959, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [960, "            with AWS services via AWS APIs\n"], [961, "        - id: W92\n"], [962, "          reason: Function does not require concurrent execution limits as it is designed\n"], [963, "            to scale based on demand\n"], [964, "        - id: W11\n"], [965, "          reason: Textract DetectDocumentText API and Cloudwatch APIs do not support\n"], [966, "            resource-level permissions\n"], [967, "    Properties:\n"], [968, "      PermissionsBoundary:\n"], [969, "        Fn::If:\n"], [970, "        - HasPermissionsBoundary\n"], [971, "        - Ref: PermissionsBoundaryArn\n"], [972, "        - Ref: AWS::NoValue\n"], [973, "      CodeUri: OCRFunction\n"], [974, "      Handler: index.handler\n"], [975, "      Runtime: python3.12\n"], [976, "      Timeout: 900\n"], [977, "      MemorySize: 4096\n"], [978, "      Environment:\n"], [979, "        Variables:\n"], [980, "          METRIC_NAMESPACE:\n"], [981, "            Ref: StackName\n"], [982, "          MAX_WORKERS: 20\n"], [983, "          CONFIGURATION_TABLE_NAME:\n"], [984, "            Ref: ConfigurationTable\n"], [985, "          LOG_LEVEL:\n"], [986, "            Ref: LogLevel\n"], [987, "          APPSYNC_API_URL:\n"], [988, "            Ref: AppSyncApiUrl\n"], [989, "          WORKING_BUCKET:\n"], [990, "            Ref: WorkingBucket\n"], [991, "      LoggingConfig:\n"], [992, "        LogGroup:\n"], [993, "          Ref: OCRFunctionLogGroup\n"], [994, "      Policies:\n"], [995, "      - AWSLambdaBasicExecutionRole\n"], [996, "      - S3CrudPolicy:\n"], [997, "          BucketName:\n"], [998, "            Ref: OutputBucket\n"], [999, "      - S3CrudPolicy:\n"], [1000, "          BucketName:\n"], [1001, "            Ref: WorkingBucket\n"], [1002, "      - S3ReadPolicy:\n"], [1003, "          BucketName:\n"], [1004, "            Ref: InputBucket\n"], [1005, "      - DynamoDBCrudPolicy:\n"], [1006, "          TableName:\n"], [1007, "            Ref: ConfigurationTable\n"], [1008, "      - Statement:\n"], [1009, "        - Effect: Allow\n"], [1010, "          Action: cloudwatch:PutMetricData\n"], [1011, "          Resource: '*'\n"], [1012, "        - Effect: Allow\n"], [1013, "          Action:\n"], [1014, "          - kms:Encrypt\n"], [1015, "          - kms:Decrypt\n"], [1016, "          - kms:ReEncrypt*\n"], [1017, "          - kms:GenerateDataKey*\n"], [1018, "          - kms:DescribeKey\n"], [1019, "          Resource:\n"], [1020, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1021, "        - Effect: Allow\n"], [1022, "          Action:\n"], [1023, "          - textract:DetectDocumentText\n"], [1024, "          - textract:AnalyzeDocument\n"], [1025, "          Resource: '*'\n"], [1026, "        - Effect: Allow\n"], [1027, "          Action: bedrock:InvokeModel\n"], [1028, "          Resource:\n"], [1029, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1030, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1031, "        - Effect: Allow\n"], [1032, "          Action:\n"], [1033, "          - appsync:GraphQL\n"], [1034, "          Resource:\n"], [1035, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [952, 1035], "resource": "AWS::Serverless::Function.OCRFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[952, "  OCRFunction:\n"], [953, "    Type: AWS::Serverless::Function\n"], [954, "    Metadata:\n"], [955, "      SamResourceId: OCRFunction\n"], [956, "      cfn_nag:\n"], [957, "        rules_to_suppress:\n"], [958, "        - id: W89\n"], [959, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [960, "            with AWS services via AWS APIs\n"], [961, "        - id: W92\n"], [962, "          reason: Function does not require concurrent execution limits as it is designed\n"], [963, "            to scale based on demand\n"], [964, "        - id: W11\n"], [965, "          reason: Textract DetectDocumentText API and Cloudwatch APIs do not support\n"], [966, "            resource-level permissions\n"], [967, "    Properties:\n"], [968, "      PermissionsBoundary:\n"], [969, "        Fn::If:\n"], [970, "        - HasPermissionsBoundary\n"], [971, "        - Ref: PermissionsBoundaryArn\n"], [972, "        - Ref: AWS::NoValue\n"], [973, "      CodeUri: OCRFunction\n"], [974, "      Handler: index.handler\n"], [975, "      Runtime: python3.12\n"], [976, "      Timeout: 900\n"], [977, "      MemorySize: 4096\n"], [978, "      Environment:\n"], [979, "        Variables:\n"], [980, "          METRIC_NAMESPACE:\n"], [981, "            Ref: StackName\n"], [982, "          MAX_WORKERS: 20\n"], [983, "          CONFIGURATION_TABLE_NAME:\n"], [984, "            Ref: ConfigurationTable\n"], [985, "          LOG_LEVEL:\n"], [986, "            Ref: LogLevel\n"], [987, "          APPSYNC_API_URL:\n"], [988, "            Ref: AppSyncApiUrl\n"], [989, "          WORKING_BUCKET:\n"], [990, "            Ref: WorkingBucket\n"], [991, "      LoggingConfig:\n"], [992, "        LogGroup:\n"], [993, "          Ref: OCRFunctionLogGroup\n"], [994, "      Policies:\n"], [995, "      - AWSLambdaBasicExecutionRole\n"], [996, "      - S3CrudPolicy:\n"], [997, "          BucketName:\n"], [998, "            Ref: OutputBucket\n"], [999, "      - S3CrudPolicy:\n"], [1000, "          BucketName:\n"], [1001, "            Ref: WorkingBucket\n"], [1002, "      - S3ReadPolicy:\n"], [1003, "          BucketName:\n"], [1004, "            Ref: InputBucket\n"], [1005, "      - DynamoDBCrudPolicy:\n"], [1006, "          TableName:\n"], [1007, "            Ref: ConfigurationTable\n"], [1008, "      - Statement:\n"], [1009, "        - Effect: Allow\n"], [1010, "          Action: cloudwatch:PutMetricData\n"], [1011, "          Resource: '*'\n"], [1012, "        - Effect: Allow\n"], [1013, "          Action:\n"], [1014, "          - kms:Encrypt\n"], [1015, "          - kms:Decrypt\n"], [1016, "          - kms:ReEncrypt*\n"], [1017, "          - kms:GenerateDataKey*\n"], [1018, "          - kms:DescribeKey\n"], [1019, "          Resource:\n"], [1020, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1021, "        - Effect: Allow\n"], [1022, "          Action:\n"], [1023, "          - textract:DetectDocumentText\n"], [1024, "          - textract:AnalyzeDocument\n"], [1025, "          Resource: '*'\n"], [1026, "        - Effect: Allow\n"], [1027, "          Action: bedrock:InvokeModel\n"], [1028, "          Resource:\n"], [1029, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1030, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1031, "        - Effect: Allow\n"], [1032, "          Action:\n"], [1033, "          - appsync:GraphQL\n"], [1034, "          Resource:\n"], [1035, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [952, 1035], "resource": "AWS::Serverless::Function.OCRFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[1045, "  ClassificationFunction:\n"], [1046, "    Type: AWS::Serverless::Function\n"], [1047, "    Metadata:\n"], [1048, "      SamResourceId: ClassificationFunction\n"], [1049, "      cfn_nag:\n"], [1050, "        rules_to_suppress:\n"], [1051, "        - id: W11\n"], [1052, "          reason: Cloudwatch does not support resource-level permissions\n"], [1053, "        - id: W89\n"], [1054, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1055, "            with AWS services via AWS APIs\n"], [1056, "        - id: W92\n"], [1057, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1058, "            to scale based on demand\n"], [1059, "    Properties:\n"], [1060, "      PermissionsBoundary:\n"], [1061, "        Fn::If:\n"], [1062, "        - HasPermissionsBoundary\n"], [1063, "        - Ref: PermissionsBoundaryArn\n"], [1064, "        - Ref: AWS::NoValue\n"], [1065, "      CodeUri: ClassificationFunction\n"], [1066, "      Handler: index.handler\n"], [1067, "      Runtime: python3.12\n"], [1068, "      Timeout: 900\n"], [1069, "      MemorySize: 4096\n"], [1070, "      Environment:\n"], [1071, "        Variables:\n"], [1072, "          METRIC_NAMESPACE:\n"], [1073, "            Ref: StackName\n"], [1074, "          MAX_WORKERS: 20\n"], [1075, "          TRACKING_TABLE:\n"], [1076, "            Ref: TrackingTable\n"], [1077, "          CONFIGURATION_BUCKET:\n"], [1078, "            Ref: ConfigurationBucket\n"], [1079, "          CONFIGURATION_TABLE_NAME:\n"], [1080, "            Ref: ConfigurationTable\n"], [1081, "          LOG_LEVEL:\n"], [1082, "            Ref: LogLevel\n"], [1083, "          APPSYNC_API_URL:\n"], [1084, "            Ref: AppSyncApiUrl\n"], [1085, "          WORKING_BUCKET:\n"], [1086, "            Ref: WorkingBucket\n"], [1087, "      LoggingConfig:\n"], [1088, "        LogGroup:\n"], [1089, "          Ref: ClassificationFunctionLogGroup\n"], [1090, "      Policies:\n"], [1091, "      - AWSLambdaBasicExecutionRole\n"], [1092, "      - S3CrudPolicy:\n"], [1093, "          BucketName:\n"], [1094, "            Ref: OutputBucket\n"], [1095, "      - S3CrudPolicy:\n"], [1096, "          BucketName:\n"], [1097, "            Ref: WorkingBucket\n"], [1098, "      - S3ReadPolicy:\n"], [1099, "          BucketName:\n"], [1100, "            Ref: InputBucket\n"], [1101, "      - DynamoDBCrudPolicy:\n"], [1102, "          TableName:\n"], [1103, "            Ref: TrackingTable\n"], [1104, "      - S3ReadPolicy:\n"], [1105, "          BucketName:\n"], [1106, "            Ref: ConfigurationBucket\n"], [1107, "      - DynamoDBCrudPolicy:\n"], [1108, "          TableName:\n"], [1109, "            Ref: ConfigurationTable\n"], [1110, "      - Statement:\n"], [1111, "        - Effect: Allow\n"], [1112, "          Action: cloudwatch:PutMetricData\n"], [1113, "          Resource: '*'\n"], [1114, "        - Effect: Allow\n"], [1115, "          Action:\n"], [1116, "          - kms:Encrypt\n"], [1117, "          - kms:Decrypt\n"], [1118, "          - kms:ReEncrypt*\n"], [1119, "          - kms:GenerateDataKey*\n"], [1120, "          - kms:DescribeKey\n"], [1121, "          Resource:\n"], [1122, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1123, "        - Effect: Allow\n"], [1124, "          Action:\n"], [1125, "          - appsync:GraphQL\n"], [1126, "          Resource:\n"], [1127, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1128, "        - Effect: Allow\n"], [1129, "          Action: bedrock:InvokeModel\n"], [1130, "          Resource:\n"], [1131, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1132, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1133, "          - Fn::If:\n"], [1134, "            - HasCustomClassificationModelARN\n"], [1135, "            - Ref: CustomClassificationModelARN\n"], [1136, "            - Ref: AWS::NoValue\n"], [1137, "        - Fn::If:\n"], [1138, "          - HasGuardrailConfig\n"], [1139, "          - Effect: Allow\n"], [1140, "            Action: bedrock:ApplyGuardrail\n"], [1141, "            Resource:\n"], [1142, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1143, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1045, 1143], "resource": "AWS::Serverless::Function.ClassificationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[1045, "  ClassificationFunction:\n"], [1046, "    Type: AWS::Serverless::Function\n"], [1047, "    Metadata:\n"], [1048, "      SamResourceId: ClassificationFunction\n"], [1049, "      cfn_nag:\n"], [1050, "        rules_to_suppress:\n"], [1051, "        - id: W11\n"], [1052, "          reason: Cloudwatch does not support resource-level permissions\n"], [1053, "        - id: W89\n"], [1054, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1055, "            with AWS services via AWS APIs\n"], [1056, "        - id: W92\n"], [1057, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1058, "            to scale based on demand\n"], [1059, "    Properties:\n"], [1060, "      PermissionsBoundary:\n"], [1061, "        Fn::If:\n"], [1062, "        - HasPermissionsBoundary\n"], [1063, "        - Ref: PermissionsBoundaryArn\n"], [1064, "        - Ref: AWS::NoValue\n"], [1065, "      CodeUri: ClassificationFunction\n"], [1066, "      Handler: index.handler\n"], [1067, "      Runtime: python3.12\n"], [1068, "      Timeout: 900\n"], [1069, "      MemorySize: 4096\n"], [1070, "      Environment:\n"], [1071, "        Variables:\n"], [1072, "          METRIC_NAMESPACE:\n"], [1073, "            Ref: StackName\n"], [1074, "          MAX_WORKERS: 20\n"], [1075, "          TRACKING_TABLE:\n"], [1076, "            Ref: TrackingTable\n"], [1077, "          CONFIGURATION_BUCKET:\n"], [1078, "            Ref: ConfigurationBucket\n"], [1079, "          CONFIGURATION_TABLE_NAME:\n"], [1080, "            Ref: ConfigurationTable\n"], [1081, "          LOG_LEVEL:\n"], [1082, "            Ref: LogLevel\n"], [1083, "          APPSYNC_API_URL:\n"], [1084, "            Ref: AppSyncApiUrl\n"], [1085, "          WORKING_BUCKET:\n"], [1086, "            Ref: WorkingBucket\n"], [1087, "      LoggingConfig:\n"], [1088, "        LogGroup:\n"], [1089, "          Ref: ClassificationFunctionLogGroup\n"], [1090, "      Policies:\n"], [1091, "      - AWSLambdaBasicExecutionRole\n"], [1092, "      - S3CrudPolicy:\n"], [1093, "          BucketName:\n"], [1094, "            Ref: OutputBucket\n"], [1095, "      - S3CrudPolicy:\n"], [1096, "          BucketName:\n"], [1097, "            Ref: WorkingBucket\n"], [1098, "      - S3ReadPolicy:\n"], [1099, "          BucketName:\n"], [1100, "            Ref: InputBucket\n"], [1101, "      - DynamoDBCrudPolicy:\n"], [1102, "          TableName:\n"], [1103, "            Ref: TrackingTable\n"], [1104, "      - S3ReadPolicy:\n"], [1105, "          BucketName:\n"], [1106, "            Ref: ConfigurationBucket\n"], [1107, "      - DynamoDBCrudPolicy:\n"], [1108, "          TableName:\n"], [1109, "            Ref: ConfigurationTable\n"], [1110, "      - Statement:\n"], [1111, "        - Effect: Allow\n"], [1112, "          Action: cloudwatch:PutMetricData\n"], [1113, "          Resource: '*'\n"], [1114, "        - Effect: Allow\n"], [1115, "          Action:\n"], [1116, "          - kms:Encrypt\n"], [1117, "          - kms:Decrypt\n"], [1118, "          - kms:ReEncrypt*\n"], [1119, "          - kms:GenerateDataKey*\n"], [1120, "          - kms:DescribeKey\n"], [1121, "          Resource:\n"], [1122, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1123, "        - Effect: Allow\n"], [1124, "          Action:\n"], [1125, "          - appsync:GraphQL\n"], [1126, "          Resource:\n"], [1127, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1128, "        - Effect: Allow\n"], [1129, "          Action: bedrock:InvokeModel\n"], [1130, "          Resource:\n"], [1131, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1132, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1133, "          - Fn::If:\n"], [1134, "            - HasCustomClassificationModelARN\n"], [1135, "            - Ref: CustomClassificationModelARN\n"], [1136, "            - Ref: AWS::NoValue\n"], [1137, "        - Fn::If:\n"], [1138, "          - HasGuardrailConfig\n"], [1139, "          - Effect: Allow\n"], [1140, "            Action: bedrock:ApplyGuardrail\n"], [1141, "            Resource:\n"], [1142, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1143, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1045, 1143], "resource": "AWS::Serverless::Function.ClassificationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[1045, "  ClassificationFunction:\n"], [1046, "    Type: AWS::Serverless::Function\n"], [1047, "    Metadata:\n"], [1048, "      SamResourceId: ClassificationFunction\n"], [1049, "      cfn_nag:\n"], [1050, "        rules_to_suppress:\n"], [1051, "        - id: W11\n"], [1052, "          reason: Cloudwatch does not support resource-level permissions\n"], [1053, "        - id: W89\n"], [1054, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1055, "            with AWS services via AWS APIs\n"], [1056, "        - id: W92\n"], [1057, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1058, "            to scale based on demand\n"], [1059, "    Properties:\n"], [1060, "      PermissionsBoundary:\n"], [1061, "        Fn::If:\n"], [1062, "        - HasPermissionsBoundary\n"], [1063, "        - Ref: PermissionsBoundaryArn\n"], [1064, "        - Ref: AWS::NoValue\n"], [1065, "      CodeUri: ClassificationFunction\n"], [1066, "      Handler: index.handler\n"], [1067, "      Runtime: python3.12\n"], [1068, "      Timeout: 900\n"], [1069, "      MemorySize: 4096\n"], [1070, "      Environment:\n"], [1071, "        Variables:\n"], [1072, "          METRIC_NAMESPACE:\n"], [1073, "            Ref: StackName\n"], [1074, "          MAX_WORKERS: 20\n"], [1075, "          TRACKING_TABLE:\n"], [1076, "            Ref: TrackingTable\n"], [1077, "          CONFIGURATION_BUCKET:\n"], [1078, "            Ref: ConfigurationBucket\n"], [1079, "          CONFIGURATION_TABLE_NAME:\n"], [1080, "            Ref: ConfigurationTable\n"], [1081, "          LOG_LEVEL:\n"], [1082, "            Ref: LogLevel\n"], [1083, "          APPSYNC_API_URL:\n"], [1084, "            Ref: AppSyncApiUrl\n"], [1085, "          WORKING_BUCKET:\n"], [1086, "            Ref: WorkingBucket\n"], [1087, "      LoggingConfig:\n"], [1088, "        LogGroup:\n"], [1089, "          Ref: ClassificationFunctionLogGroup\n"], [1090, "      Policies:\n"], [1091, "      - AWSLambdaBasicExecutionRole\n"], [1092, "      - S3CrudPolicy:\n"], [1093, "          BucketName:\n"], [1094, "            Ref: OutputBucket\n"], [1095, "      - S3CrudPolicy:\n"], [1096, "          BucketName:\n"], [1097, "            Ref: WorkingBucket\n"], [1098, "      - S3ReadPolicy:\n"], [1099, "          BucketName:\n"], [1100, "            Ref: InputBucket\n"], [1101, "      - DynamoDBCrudPolicy:\n"], [1102, "          TableName:\n"], [1103, "            Ref: TrackingTable\n"], [1104, "      - S3ReadPolicy:\n"], [1105, "          BucketName:\n"], [1106, "            Ref: ConfigurationBucket\n"], [1107, "      - DynamoDBCrudPolicy:\n"], [1108, "          TableName:\n"], [1109, "            Ref: ConfigurationTable\n"], [1110, "      - Statement:\n"], [1111, "        - Effect: Allow\n"], [1112, "          Action: cloudwatch:PutMetricData\n"], [1113, "          Resource: '*'\n"], [1114, "        - Effect: Allow\n"], [1115, "          Action:\n"], [1116, "          - kms:Encrypt\n"], [1117, "          - kms:Decrypt\n"], [1118, "          - kms:ReEncrypt*\n"], [1119, "          - kms:GenerateDataKey*\n"], [1120, "          - kms:DescribeKey\n"], [1121, "          Resource:\n"], [1122, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1123, "        - Effect: Allow\n"], [1124, "          Action:\n"], [1125, "          - appsync:GraphQL\n"], [1126, "          Resource:\n"], [1127, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1128, "        - Effect: Allow\n"], [1129, "          Action: bedrock:InvokeModel\n"], [1130, "          Resource:\n"], [1131, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1132, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1133, "          - Fn::If:\n"], [1134, "            - HasCustomClassificationModelARN\n"], [1135, "            - Ref: CustomClassificationModelARN\n"], [1136, "            - Ref: AWS::NoValue\n"], [1137, "        - Fn::If:\n"], [1138, "          - HasGuardrailConfig\n"], [1139, "          - Effect: Allow\n"], [1140, "            Action: bedrock:ApplyGuardrail\n"], [1141, "            Resource:\n"], [1142, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1143, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1045, 1143], "resource": "AWS::Serverless::Function.ClassificationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[1045, "  ClassificationFunction:\n"], [1046, "    Type: AWS::Serverless::Function\n"], [1047, "    Metadata:\n"], [1048, "      SamResourceId: ClassificationFunction\n"], [1049, "      cfn_nag:\n"], [1050, "        rules_to_suppress:\n"], [1051, "        - id: W11\n"], [1052, "          reason: Cloudwatch does not support resource-level permissions\n"], [1053, "        - id: W89\n"], [1054, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1055, "            with AWS services via AWS APIs\n"], [1056, "        - id: W92\n"], [1057, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1058, "            to scale based on demand\n"], [1059, "    Properties:\n"], [1060, "      PermissionsBoundary:\n"], [1061, "        Fn::If:\n"], [1062, "        - HasPermissionsBoundary\n"], [1063, "        - Ref: PermissionsBoundaryArn\n"], [1064, "        - Ref: AWS::NoValue\n"], [1065, "      CodeUri: ClassificationFunction\n"], [1066, "      Handler: index.handler\n"], [1067, "      Runtime: python3.12\n"], [1068, "      Timeout: 900\n"], [1069, "      MemorySize: 4096\n"], [1070, "      Environment:\n"], [1071, "        Variables:\n"], [1072, "          METRIC_NAMESPACE:\n"], [1073, "            Ref: StackName\n"], [1074, "          MAX_WORKERS: 20\n"], [1075, "          TRACKING_TABLE:\n"], [1076, "            Ref: TrackingTable\n"], [1077, "          CONFIGURATION_BUCKET:\n"], [1078, "            Ref: ConfigurationBucket\n"], [1079, "          CONFIGURATION_TABLE_NAME:\n"], [1080, "            Ref: ConfigurationTable\n"], [1081, "          LOG_LEVEL:\n"], [1082, "            Ref: LogLevel\n"], [1083, "          APPSYNC_API_URL:\n"], [1084, "            Ref: AppSyncApiUrl\n"], [1085, "          WORKING_BUCKET:\n"], [1086, "            Ref: WorkingBucket\n"], [1087, "      LoggingConfig:\n"], [1088, "        LogGroup:\n"], [1089, "          Ref: ClassificationFunctionLogGroup\n"], [1090, "      Policies:\n"], [1091, "      - AWSLambdaBasicExecutionRole\n"], [1092, "      - S3CrudPolicy:\n"], [1093, "          BucketName:\n"], [1094, "            Ref: OutputBucket\n"], [1095, "      - S3CrudPolicy:\n"], [1096, "          BucketName:\n"], [1097, "            Ref: WorkingBucket\n"], [1098, "      - S3ReadPolicy:\n"], [1099, "          BucketName:\n"], [1100, "            Ref: InputBucket\n"], [1101, "      - DynamoDBCrudPolicy:\n"], [1102, "          TableName:\n"], [1103, "            Ref: TrackingTable\n"], [1104, "      - S3ReadPolicy:\n"], [1105, "          BucketName:\n"], [1106, "            Ref: ConfigurationBucket\n"], [1107, "      - DynamoDBCrudPolicy:\n"], [1108, "          TableName:\n"], [1109, "            Ref: ConfigurationTable\n"], [1110, "      - Statement:\n"], [1111, "        - Effect: Allow\n"], [1112, "          Action: cloudwatch:PutMetricData\n"], [1113, "          Resource: '*'\n"], [1114, "        - Effect: Allow\n"], [1115, "          Action:\n"], [1116, "          - kms:Encrypt\n"], [1117, "          - kms:Decrypt\n"], [1118, "          - kms:ReEncrypt*\n"], [1119, "          - kms:GenerateDataKey*\n"], [1120, "          - kms:DescribeKey\n"], [1121, "          Resource:\n"], [1122, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1123, "        - Effect: Allow\n"], [1124, "          Action:\n"], [1125, "          - appsync:GraphQL\n"], [1126, "          Resource:\n"], [1127, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1128, "        - Effect: Allow\n"], [1129, "          Action: bedrock:InvokeModel\n"], [1130, "          Resource:\n"], [1131, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1132, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1133, "          - Fn::If:\n"], [1134, "            - HasCustomClassificationModelARN\n"], [1135, "            - Ref: CustomClassificationModelARN\n"], [1136, "            - Ref: AWS::NoValue\n"], [1137, "        - Fn::If:\n"], [1138, "          - HasGuardrailConfig\n"], [1139, "          - Effect: Allow\n"], [1140, "            Action: bedrock:ApplyGuardrail\n"], [1141, "            Resource:\n"], [1142, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1143, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1045, 1143], "resource": "AWS::Serverless::Function.ClassificationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[1153, "  ExtractionFunction:\n"], [1154, "    Type: AWS::Serverless::Function\n"], [1155, "    Metadata:\n"], [1156, "      SamResourceId: ExtractionFunction\n"], [1157, "      cfn_nag:\n"], [1158, "        rules_to_suppress:\n"], [1159, "        - id: W89\n"], [1160, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1161, "            with AWS services via AWS APIs\n"], [1162, "        - id: W92\n"], [1163, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1164, "            to scale based on demand\n"], [1165, "        - id: W11\n"], [1166, "          reason: Cloudwatch does not support resource-level permissions, and Bedrock\n"], [1167, "            should support any enabled Bedrock model_id or inference profile\n"], [1168, "    Properties:\n"], [1169, "      PermissionsBoundary:\n"], [1170, "        Fn::If:\n"], [1171, "        - HasPermissionsBoundary\n"], [1172, "        - Ref: PermissionsBoundaryArn\n"], [1173, "        - Ref: AWS::NoValue\n"], [1174, "      CodeUri: ExtractionFunction\n"], [1175, "      Handler: index.handler\n"], [1176, "      Runtime: python3.12\n"], [1177, "      Timeout: 900\n"], [1178, "      MemorySize: 512\n"], [1179, "      Environment:\n"], [1180, "        Variables:\n"], [1181, "          METRIC_NAMESPACE:\n"], [1182, "            Ref: StackName\n"], [1183, "          CONFIGURATION_BUCKET:\n"], [1184, "            Ref: ConfigurationBucket\n"], [1185, "          CONFIGURATION_TABLE_NAME:\n"], [1186, "            Ref: ConfigurationTable\n"], [1187, "          GUARDRAIL_ID_AND_VERSION:\n"], [1188, "            Fn::If:\n"], [1189, "            - HasGuardrailConfig\n"], [1190, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1191, "            - ''\n"], [1192, "          LOG_LEVEL:\n"], [1193, "            Ref: LogLevel\n"], [1194, "          APPSYNC_API_URL:\n"], [1195, "            Ref: AppSyncApiUrl\n"], [1196, "          WORKING_BUCKET:\n"], [1197, "            Ref: WorkingBucket\n"], [1198, "      LoggingConfig:\n"], [1199, "        LogGroup:\n"], [1200, "          Ref: ExtractionFunctionLogGroup\n"], [1201, "      Policies:\n"], [1202, "      - AWSLambdaBasicExecutionRole\n"], [1203, "      - S3CrudPolicy:\n"], [1204, "          BucketName:\n"], [1205, "            Ref: OutputBucket\n"], [1206, "      - S3CrudPolicy:\n"], [1207, "          BucketName:\n"], [1208, "            Ref: WorkingBucket\n"], [1209, "      - S3ReadPolicy:\n"], [1210, "          BucketName:\n"], [1211, "            Ref: InputBucket\n"], [1212, "      - S3ReadPolicy:\n"], [1213, "          BucketName:\n"], [1214, "            Ref: ConfigurationBucket\n"], [1215, "      - DynamoDBCrudPolicy:\n"], [1216, "          TableName:\n"], [1217, "            Ref: ConfigurationTable\n"], [1218, "      - Statement:\n"], [1219, "        - Effect: Allow\n"], [1220, "          Action: cloudwatch:PutMetricData\n"], [1221, "          Resource: '*'\n"], [1222, "        - Effect: Allow\n"], [1223, "          Action:\n"], [1224, "          - kms:Encrypt\n"], [1225, "          - kms:Decrypt\n"], [1226, "          - kms:ReEncrypt*\n"], [1227, "          - kms:GenerateDataKey*\n"], [1228, "          - kms:DescribeKey\n"], [1229, "          Resource:\n"], [1230, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1231, "        - Effect: Allow\n"], [1232, "          Action:\n"], [1233, "          - appsync:GraphQL\n"], [1234, "          Resource:\n"], [1235, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1236, "        - Effect: Allow\n"], [1237, "          Action: bedrock:InvokeModel\n"], [1238, "          Resource:\n"], [1239, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1240, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1241, "          - Fn::If:\n"], [1242, "            - HasCustomExtractionModelARN\n"], [1243, "            - Ref: CustomExtractionModelARN\n"], [1244, "            - Ref: AWS::NoValue\n"], [1245, "        - Fn::If:\n"], [1246, "          - HasGuardrailConfig\n"], [1247, "          - Effect: Allow\n"], [1248, "            Action: bedrock:ApplyGuardrail\n"], [1249, "            Resource:\n"], [1250, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1251, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1153, 1251], "resource": "AWS::Serverless::Function.ExtractionFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[1153, "  ExtractionFunction:\n"], [1154, "    Type: AWS::Serverless::Function\n"], [1155, "    Metadata:\n"], [1156, "      SamResourceId: ExtractionFunction\n"], [1157, "      cfn_nag:\n"], [1158, "        rules_to_suppress:\n"], [1159, "        - id: W89\n"], [1160, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1161, "            with AWS services via AWS APIs\n"], [1162, "        - id: W92\n"], [1163, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1164, "            to scale based on demand\n"], [1165, "        - id: W11\n"], [1166, "          reason: Cloudwatch does not support resource-level permissions, and Bedrock\n"], [1167, "            should support any enabled Bedrock model_id or inference profile\n"], [1168, "    Properties:\n"], [1169, "      PermissionsBoundary:\n"], [1170, "        Fn::If:\n"], [1171, "        - HasPermissionsBoundary\n"], [1172, "        - Ref: PermissionsBoundaryArn\n"], [1173, "        - Ref: AWS::NoValue\n"], [1174, "      CodeUri: ExtractionFunction\n"], [1175, "      Handler: index.handler\n"], [1176, "      Runtime: python3.12\n"], [1177, "      Timeout: 900\n"], [1178, "      MemorySize: 512\n"], [1179, "      Environment:\n"], [1180, "        Variables:\n"], [1181, "          METRIC_NAMESPACE:\n"], [1182, "            Ref: StackName\n"], [1183, "          CONFIGURATION_BUCKET:\n"], [1184, "            Ref: ConfigurationBucket\n"], [1185, "          CONFIGURATION_TABLE_NAME:\n"], [1186, "            Ref: ConfigurationTable\n"], [1187, "          GUARDRAIL_ID_AND_VERSION:\n"], [1188, "            Fn::If:\n"], [1189, "            - HasGuardrailConfig\n"], [1190, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1191, "            - ''\n"], [1192, "          LOG_LEVEL:\n"], [1193, "            Ref: LogLevel\n"], [1194, "          APPSYNC_API_URL:\n"], [1195, "            Ref: AppSyncApiUrl\n"], [1196, "          WORKING_BUCKET:\n"], [1197, "            Ref: WorkingBucket\n"], [1198, "      LoggingConfig:\n"], [1199, "        LogGroup:\n"], [1200, "          Ref: ExtractionFunctionLogGroup\n"], [1201, "      Policies:\n"], [1202, "      - AWSLambdaBasicExecutionRole\n"], [1203, "      - S3CrudPolicy:\n"], [1204, "          BucketName:\n"], [1205, "            Ref: OutputBucket\n"], [1206, "      - S3CrudPolicy:\n"], [1207, "          BucketName:\n"], [1208, "            Ref: WorkingBucket\n"], [1209, "      - S3ReadPolicy:\n"], [1210, "          BucketName:\n"], [1211, "            Ref: InputBucket\n"], [1212, "      - S3ReadPolicy:\n"], [1213, "          BucketName:\n"], [1214, "            Ref: ConfigurationBucket\n"], [1215, "      - DynamoDBCrudPolicy:\n"], [1216, "          TableName:\n"], [1217, "            Ref: ConfigurationTable\n"], [1218, "      - Statement:\n"], [1219, "        - Effect: Allow\n"], [1220, "          Action: cloudwatch:PutMetricData\n"], [1221, "          Resource: '*'\n"], [1222, "        - Effect: Allow\n"], [1223, "          Action:\n"], [1224, "          - kms:Encrypt\n"], [1225, "          - kms:Decrypt\n"], [1226, "          - kms:ReEncrypt*\n"], [1227, "          - kms:GenerateDataKey*\n"], [1228, "          - kms:DescribeKey\n"], [1229, "          Resource:\n"], [1230, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1231, "        - Effect: Allow\n"], [1232, "          Action:\n"], [1233, "          - appsync:GraphQL\n"], [1234, "          Resource:\n"], [1235, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1236, "        - Effect: Allow\n"], [1237, "          Action: bedrock:InvokeModel\n"], [1238, "          Resource:\n"], [1239, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1240, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1241, "          - Fn::If:\n"], [1242, "            - HasCustomExtractionModelARN\n"], [1243, "            - Ref: CustomExtractionModelARN\n"], [1244, "            - Ref: AWS::NoValue\n"], [1245, "        - Fn::If:\n"], [1246, "          - HasGuardrailConfig\n"], [1247, "          - Effect: Allow\n"], [1248, "            Action: bedrock:ApplyGuardrail\n"], [1249, "            Resource:\n"], [1250, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1251, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1153, 1251], "resource": "AWS::Serverless::Function.ExtractionFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[1153, "  ExtractionFunction:\n"], [1154, "    Type: AWS::Serverless::Function\n"], [1155, "    Metadata:\n"], [1156, "      SamResourceId: ExtractionFunction\n"], [1157, "      cfn_nag:\n"], [1158, "        rules_to_suppress:\n"], [1159, "        - id: W89\n"], [1160, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1161, "            with AWS services via AWS APIs\n"], [1162, "        - id: W92\n"], [1163, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1164, "            to scale based on demand\n"], [1165, "        - id: W11\n"], [1166, "          reason: Cloudwatch does not support resource-level permissions, and Bedrock\n"], [1167, "            should support any enabled Bedrock model_id or inference profile\n"], [1168, "    Properties:\n"], [1169, "      PermissionsBoundary:\n"], [1170, "        Fn::If:\n"], [1171, "        - HasPermissionsBoundary\n"], [1172, "        - Ref: PermissionsBoundaryArn\n"], [1173, "        - Ref: AWS::NoValue\n"], [1174, "      CodeUri: ExtractionFunction\n"], [1175, "      Handler: index.handler\n"], [1176, "      Runtime: python3.12\n"], [1177, "      Timeout: 900\n"], [1178, "      MemorySize: 512\n"], [1179, "      Environment:\n"], [1180, "        Variables:\n"], [1181, "          METRIC_NAMESPACE:\n"], [1182, "            Ref: StackName\n"], [1183, "          CONFIGURATION_BUCKET:\n"], [1184, "            Ref: ConfigurationBucket\n"], [1185, "          CONFIGURATION_TABLE_NAME:\n"], [1186, "            Ref: ConfigurationTable\n"], [1187, "          GUARDRAIL_ID_AND_VERSION:\n"], [1188, "            Fn::If:\n"], [1189, "            - HasGuardrailConfig\n"], [1190, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1191, "            - ''\n"], [1192, "          LOG_LEVEL:\n"], [1193, "            Ref: LogLevel\n"], [1194, "          APPSYNC_API_URL:\n"], [1195, "            Ref: AppSyncApiUrl\n"], [1196, "          WORKING_BUCKET:\n"], [1197, "            Ref: WorkingBucket\n"], [1198, "      LoggingConfig:\n"], [1199, "        LogGroup:\n"], [1200, "          Ref: ExtractionFunctionLogGroup\n"], [1201, "      Policies:\n"], [1202, "      - AWSLambdaBasicExecutionRole\n"], [1203, "      - S3CrudPolicy:\n"], [1204, "          BucketName:\n"], [1205, "            Ref: OutputBucket\n"], [1206, "      - S3CrudPolicy:\n"], [1207, "          BucketName:\n"], [1208, "            Ref: WorkingBucket\n"], [1209, "      - S3ReadPolicy:\n"], [1210, "          BucketName:\n"], [1211, "            Ref: InputBucket\n"], [1212, "      - S3ReadPolicy:\n"], [1213, "          BucketName:\n"], [1214, "            Ref: ConfigurationBucket\n"], [1215, "      - DynamoDBCrudPolicy:\n"], [1216, "          TableName:\n"], [1217, "            Ref: ConfigurationTable\n"], [1218, "      - Statement:\n"], [1219, "        - Effect: Allow\n"], [1220, "          Action: cloudwatch:PutMetricData\n"], [1221, "          Resource: '*'\n"], [1222, "        - Effect: Allow\n"], [1223, "          Action:\n"], [1224, "          - kms:Encrypt\n"], [1225, "          - kms:Decrypt\n"], [1226, "          - kms:ReEncrypt*\n"], [1227, "          - kms:GenerateDataKey*\n"], [1228, "          - kms:DescribeKey\n"], [1229, "          Resource:\n"], [1230, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1231, "        - Effect: Allow\n"], [1232, "          Action:\n"], [1233, "          - appsync:GraphQL\n"], [1234, "          Resource:\n"], [1235, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1236, "        - Effect: Allow\n"], [1237, "          Action: bedrock:InvokeModel\n"], [1238, "          Resource:\n"], [1239, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1240, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1241, "          - Fn::If:\n"], [1242, "            - HasCustomExtractionModelARN\n"], [1243, "            - Ref: CustomExtractionModelARN\n"], [1244, "            - Ref: AWS::NoValue\n"], [1245, "        - Fn::If:\n"], [1246, "          - HasGuardrailConfig\n"], [1247, "          - Effect: Allow\n"], [1248, "            Action: bedrock:ApplyGuardrail\n"], [1249, "            Resource:\n"], [1250, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1251, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1153, 1251], "resource": "AWS::Serverless::Function.ExtractionFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[1153, "  ExtractionFunction:\n"], [1154, "    Type: AWS::Serverless::Function\n"], [1155, "    Metadata:\n"], [1156, "      SamResourceId: ExtractionFunction\n"], [1157, "      cfn_nag:\n"], [1158, "        rules_to_suppress:\n"], [1159, "        - id: W89\n"], [1160, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1161, "            with AWS services via AWS APIs\n"], [1162, "        - id: W92\n"], [1163, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1164, "            to scale based on demand\n"], [1165, "        - id: W11\n"], [1166, "          reason: Cloudwatch does not support resource-level permissions, and Bedrock\n"], [1167, "            should support any enabled Bedrock model_id or inference profile\n"], [1168, "    Properties:\n"], [1169, "      PermissionsBoundary:\n"], [1170, "        Fn::If:\n"], [1171, "        - HasPermissionsBoundary\n"], [1172, "        - Ref: PermissionsBoundaryArn\n"], [1173, "        - Ref: AWS::NoValue\n"], [1174, "      CodeUri: ExtractionFunction\n"], [1175, "      Handler: index.handler\n"], [1176, "      Runtime: python3.12\n"], [1177, "      Timeout: 900\n"], [1178, "      MemorySize: 512\n"], [1179, "      Environment:\n"], [1180, "        Variables:\n"], [1181, "          METRIC_NAMESPACE:\n"], [1182, "            Ref: StackName\n"], [1183, "          CONFIGURATION_BUCKET:\n"], [1184, "            Ref: ConfigurationBucket\n"], [1185, "          CONFIGURATION_TABLE_NAME:\n"], [1186, "            Ref: ConfigurationTable\n"], [1187, "          GUARDRAIL_ID_AND_VERSION:\n"], [1188, "            Fn::If:\n"], [1189, "            - HasGuardrailConfig\n"], [1190, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1191, "            - ''\n"], [1192, "          LOG_LEVEL:\n"], [1193, "            Ref: LogLevel\n"], [1194, "          APPSYNC_API_URL:\n"], [1195, "            Ref: AppSyncApiUrl\n"], [1196, "          WORKING_BUCKET:\n"], [1197, "            Ref: WorkingBucket\n"], [1198, "      LoggingConfig:\n"], [1199, "        LogGroup:\n"], [1200, "          Ref: ExtractionFunctionLogGroup\n"], [1201, "      Policies:\n"], [1202, "      - AWSLambdaBasicExecutionRole\n"], [1203, "      - S3CrudPolicy:\n"], [1204, "          BucketName:\n"], [1205, "            Ref: OutputBucket\n"], [1206, "      - S3CrudPolicy:\n"], [1207, "          BucketName:\n"], [1208, "            Ref: WorkingBucket\n"], [1209, "      - S3ReadPolicy:\n"], [1210, "          BucketName:\n"], [1211, "            Ref: InputBucket\n"], [1212, "      - S3ReadPolicy:\n"], [1213, "          BucketName:\n"], [1214, "            Ref: ConfigurationBucket\n"], [1215, "      - DynamoDBCrudPolicy:\n"], [1216, "          TableName:\n"], [1217, "            Ref: ConfigurationTable\n"], [1218, "      - Statement:\n"], [1219, "        - Effect: Allow\n"], [1220, "          Action: cloudwatch:PutMetricData\n"], [1221, "          Resource: '*'\n"], [1222, "        - Effect: Allow\n"], [1223, "          Action:\n"], [1224, "          - kms:Encrypt\n"], [1225, "          - kms:Decrypt\n"], [1226, "          - kms:ReEncrypt*\n"], [1227, "          - kms:GenerateDataKey*\n"], [1228, "          - kms:DescribeKey\n"], [1229, "          Resource:\n"], [1230, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1231, "        - Effect: Allow\n"], [1232, "          Action:\n"], [1233, "          - appsync:GraphQL\n"], [1234, "          Resource:\n"], [1235, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1236, "        - Effect: Allow\n"], [1237, "          Action: bedrock:InvokeModel\n"], [1238, "          Resource:\n"], [1239, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1240, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1241, "          - Fn::If:\n"], [1242, "            - HasCustomExtractionModelARN\n"], [1243, "            - Ref: CustomExtractionModelARN\n"], [1244, "            - Ref: AWS::NoValue\n"], [1245, "        - Fn::If:\n"], [1246, "          - HasGuardrailConfig\n"], [1247, "          - Effect: Allow\n"], [1248, "            Action: bedrock:ApplyGuardrail\n"], [1249, "            Resource:\n"], [1250, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1251, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1153, 1251], "resource": "AWS::Serverless::Function.ExtractionFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[1261, "  AssessmentFunction:\n"], [1262, "    Type: AWS::Serverless::Function\n"], [1263, "    Metadata:\n"], [1264, "      SamResourceId: AssessmentFunction\n"], [1265, "      cfn_nag:\n"], [1266, "        rules_to_suppress:\n"], [1267, "        - id: W89\n"], [1268, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1269, "            with AWS services via AWS APIs\n"], [1270, "        - id: W92\n"], [1271, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1272, "            to scale based on demand\n"], [1273, "        - id: W11\n"], [1274, "          reason: Cloudwatch does not support resource-level permissions, and Bedrock\n"], [1275, "            should support any enabled Bedrock model_id or inference profile\n"], [1276, "    Properties:\n"], [1277, "      PermissionsBoundary:\n"], [1278, "        Fn::If:\n"], [1279, "        - HasPermissionsBoundary\n"], [1280, "        - Ref: PermissionsBoundaryArn\n"], [1281, "        - Ref: AWS::NoValue\n"], [1282, "      CodeUri: AssessmentFunction\n"], [1283, "      Handler: index.handler\n"], [1284, "      Runtime: python3.12\n"], [1285, "      Timeout: 900\n"], [1286, "      MemorySize: 512\n"], [1287, "      Environment:\n"], [1288, "        Variables:\n"], [1289, "          METRIC_NAMESPACE:\n"], [1290, "            Ref: StackName\n"], [1291, "          CONFIGURATION_BUCKET:\n"], [1292, "            Ref: ConfigurationBucket\n"], [1293, "          CONFIGURATION_TABLE_NAME:\n"], [1294, "            Ref: ConfigurationTable\n"], [1295, "          LOG_LEVEL:\n"], [1296, "            Ref: LogLevel\n"], [1297, "          APPSYNC_API_URL:\n"], [1298, "            Ref: AppSyncApiUrl\n"], [1299, "          WORKING_BUCKET:\n"], [1300, "            Ref: WorkingBucket\n"], [1301, "      LoggingConfig:\n"], [1302, "        LogGroup:\n"], [1303, "          Ref: AssessmentFunctionLogGroup\n"], [1304, "      Policies:\n"], [1305, "      - AWSLambdaBasicExecutionRole\n"], [1306, "      - S3CrudPolicy:\n"], [1307, "          BucketName:\n"], [1308, "            Ref: OutputBucket\n"], [1309, "      - S3CrudPolicy:\n"], [1310, "          BucketName:\n"], [1311, "            Ref: WorkingBucket\n"], [1312, "      - S3ReadPolicy:\n"], [1313, "          BucketName:\n"], [1314, "            Ref: InputBucket\n"], [1315, "      - S3ReadPolicy:\n"], [1316, "          BucketName:\n"], [1317, "            Ref: ConfigurationBucket\n"], [1318, "      - DynamoDBCrudPolicy:\n"], [1319, "          TableName:\n"], [1320, "            Ref: ConfigurationTable\n"], [1321, "      - Statement:\n"], [1322, "        - Effect: Allow\n"], [1323, "          Action: cloudwatch:PutMetricData\n"], [1324, "          Resource: '*'\n"], [1325, "        - Effect: Allow\n"], [1326, "          Action:\n"], [1327, "          - kms:Encrypt\n"], [1328, "          - kms:Decrypt\n"], [1329, "          - kms:ReEncrypt*\n"], [1330, "          - kms:GenerateDataKey*\n"], [1331, "          - kms:DescribeKey\n"], [1332, "          Resource:\n"], [1333, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1334, "        - Effect: Allow\n"], [1335, "          Action:\n"], [1336, "          - appsync:GraphQL\n"], [1337, "          Resource:\n"], [1338, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1339, "        - Effect: Allow\n"], [1340, "          Action: bedrock:InvokeModel\n"], [1341, "          Resource:\n"], [1342, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1343, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1344, "        - Fn::If:\n"], [1345, "          - HasGuardrailConfig\n"], [1346, "          - Effect: Allow\n"], [1347, "            Action: bedrock:ApplyGuardrail\n"], [1348, "            Resource:\n"], [1349, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1350, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1261, 1350], "resource": "AWS::Serverless::Function.AssessmentFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[1261, "  AssessmentFunction:\n"], [1262, "    Type: AWS::Serverless::Function\n"], [1263, "    Metadata:\n"], [1264, "      SamResourceId: AssessmentFunction\n"], [1265, "      cfn_nag:\n"], [1266, "        rules_to_suppress:\n"], [1267, "        - id: W89\n"], [1268, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1269, "            with AWS services via AWS APIs\n"], [1270, "        - id: W92\n"], [1271, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1272, "            to scale based on demand\n"], [1273, "        - id: W11\n"], [1274, "          reason: Cloudwatch does not support resource-level permissions, and Bedrock\n"], [1275, "            should support any enabled Bedrock model_id or inference profile\n"], [1276, "    Properties:\n"], [1277, "      PermissionsBoundary:\n"], [1278, "        Fn::If:\n"], [1279, "        - HasPermissionsBoundary\n"], [1280, "        - Ref: PermissionsBoundaryArn\n"], [1281, "        - Ref: AWS::NoValue\n"], [1282, "      CodeUri: AssessmentFunction\n"], [1283, "      Handler: index.handler\n"], [1284, "      Runtime: python3.12\n"], [1285, "      Timeout: 900\n"], [1286, "      MemorySize: 512\n"], [1287, "      Environment:\n"], [1288, "        Variables:\n"], [1289, "          METRIC_NAMESPACE:\n"], [1290, "            Ref: StackName\n"], [1291, "          CONFIGURATION_BUCKET:\n"], [1292, "            Ref: ConfigurationBucket\n"], [1293, "          CONFIGURATION_TABLE_NAME:\n"], [1294, "            Ref: ConfigurationTable\n"], [1295, "          LOG_LEVEL:\n"], [1296, "            Ref: LogLevel\n"], [1297, "          APPSYNC_API_URL:\n"], [1298, "            Ref: AppSyncApiUrl\n"], [1299, "          WORKING_BUCKET:\n"], [1300, "            Ref: WorkingBucket\n"], [1301, "      LoggingConfig:\n"], [1302, "        LogGroup:\n"], [1303, "          Ref: AssessmentFunctionLogGroup\n"], [1304, "      Policies:\n"], [1305, "      - AWSLambdaBasicExecutionRole\n"], [1306, "      - S3CrudPolicy:\n"], [1307, "          BucketName:\n"], [1308, "            Ref: OutputBucket\n"], [1309, "      - S3CrudPolicy:\n"], [1310, "          BucketName:\n"], [1311, "            Ref: WorkingBucket\n"], [1312, "      - S3ReadPolicy:\n"], [1313, "          BucketName:\n"], [1314, "            Ref: InputBucket\n"], [1315, "      - S3ReadPolicy:\n"], [1316, "          BucketName:\n"], [1317, "            Ref: ConfigurationBucket\n"], [1318, "      - DynamoDBCrudPolicy:\n"], [1319, "          TableName:\n"], [1320, "            Ref: ConfigurationTable\n"], [1321, "      - Statement:\n"], [1322, "        - Effect: Allow\n"], [1323, "          Action: cloudwatch:PutMetricData\n"], [1324, "          Resource: '*'\n"], [1325, "        - Effect: Allow\n"], [1326, "          Action:\n"], [1327, "          - kms:Encrypt\n"], [1328, "          - kms:Decrypt\n"], [1329, "          - kms:ReEncrypt*\n"], [1330, "          - kms:GenerateDataKey*\n"], [1331, "          - kms:DescribeKey\n"], [1332, "          Resource:\n"], [1333, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1334, "        - Effect: Allow\n"], [1335, "          Action:\n"], [1336, "          - appsync:GraphQL\n"], [1337, "          Resource:\n"], [1338, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1339, "        - Effect: Allow\n"], [1340, "          Action: bedrock:InvokeModel\n"], [1341, "          Resource:\n"], [1342, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1343, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1344, "        - Fn::If:\n"], [1345, "          - HasGuardrailConfig\n"], [1346, "          - Effect: Allow\n"], [1347, "            Action: bedrock:ApplyGuardrail\n"], [1348, "            Resource:\n"], [1349, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1350, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1261, 1350], "resource": "AWS::Serverless::Function.AssessmentFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[1261, "  AssessmentFunction:\n"], [1262, "    Type: AWS::Serverless::Function\n"], [1263, "    Metadata:\n"], [1264, "      SamResourceId: AssessmentFunction\n"], [1265, "      cfn_nag:\n"], [1266, "        rules_to_suppress:\n"], [1267, "        - id: W89\n"], [1268, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1269, "            with AWS services via AWS APIs\n"], [1270, "        - id: W92\n"], [1271, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1272, "            to scale based on demand\n"], [1273, "        - id: W11\n"], [1274, "          reason: Cloudwatch does not support resource-level permissions, and Bedrock\n"], [1275, "            should support any enabled Bedrock model_id or inference profile\n"], [1276, "    Properties:\n"], [1277, "      PermissionsBoundary:\n"], [1278, "        Fn::If:\n"], [1279, "        - HasPermissionsBoundary\n"], [1280, "        - Ref: PermissionsBoundaryArn\n"], [1281, "        - Ref: AWS::NoValue\n"], [1282, "      CodeUri: AssessmentFunction\n"], [1283, "      Handler: index.handler\n"], [1284, "      Runtime: python3.12\n"], [1285, "      Timeout: 900\n"], [1286, "      MemorySize: 512\n"], [1287, "      Environment:\n"], [1288, "        Variables:\n"], [1289, "          METRIC_NAMESPACE:\n"], [1290, "            Ref: StackName\n"], [1291, "          CONFIGURATION_BUCKET:\n"], [1292, "            Ref: ConfigurationBucket\n"], [1293, "          CONFIGURATION_TABLE_NAME:\n"], [1294, "            Ref: ConfigurationTable\n"], [1295, "          LOG_LEVEL:\n"], [1296, "            Ref: LogLevel\n"], [1297, "          APPSYNC_API_URL:\n"], [1298, "            Ref: AppSyncApiUrl\n"], [1299, "          WORKING_BUCKET:\n"], [1300, "            Ref: WorkingBucket\n"], [1301, "      LoggingConfig:\n"], [1302, "        LogGroup:\n"], [1303, "          Ref: AssessmentFunctionLogGroup\n"], [1304, "      Policies:\n"], [1305, "      - AWSLambdaBasicExecutionRole\n"], [1306, "      - S3CrudPolicy:\n"], [1307, "          BucketName:\n"], [1308, "            Ref: OutputBucket\n"], [1309, "      - S3CrudPolicy:\n"], [1310, "          BucketName:\n"], [1311, "            Ref: WorkingBucket\n"], [1312, "      - S3ReadPolicy:\n"], [1313, "          BucketName:\n"], [1314, "            Ref: InputBucket\n"], [1315, "      - S3ReadPolicy:\n"], [1316, "          BucketName:\n"], [1317, "            Ref: ConfigurationBucket\n"], [1318, "      - DynamoDBCrudPolicy:\n"], [1319, "          TableName:\n"], [1320, "            Ref: ConfigurationTable\n"], [1321, "      - Statement:\n"], [1322, "        - Effect: Allow\n"], [1323, "          Action: cloudwatch:PutMetricData\n"], [1324, "          Resource: '*'\n"], [1325, "        - Effect: Allow\n"], [1326, "          Action:\n"], [1327, "          - kms:Encrypt\n"], [1328, "          - kms:Decrypt\n"], [1329, "          - kms:ReEncrypt*\n"], [1330, "          - kms:GenerateDataKey*\n"], [1331, "          - kms:DescribeKey\n"], [1332, "          Resource:\n"], [1333, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1334, "        - Effect: Allow\n"], [1335, "          Action:\n"], [1336, "          - appsync:GraphQL\n"], [1337, "          Resource:\n"], [1338, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1339, "        - Effect: Allow\n"], [1340, "          Action: bedrock:InvokeModel\n"], [1341, "          Resource:\n"], [1342, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1343, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1344, "        - Fn::If:\n"], [1345, "          - HasGuardrailConfig\n"], [1346, "          - Effect: Allow\n"], [1347, "            Action: bedrock:ApplyGuardrail\n"], [1348, "            Resource:\n"], [1349, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1350, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1261, 1350], "resource": "AWS::Serverless::Function.AssessmentFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[1261, "  AssessmentFunction:\n"], [1262, "    Type: AWS::Serverless::Function\n"], [1263, "    Metadata:\n"], [1264, "      SamResourceId: AssessmentFunction\n"], [1265, "      cfn_nag:\n"], [1266, "        rules_to_suppress:\n"], [1267, "        - id: W89\n"], [1268, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1269, "            with AWS services via AWS APIs\n"], [1270, "        - id: W92\n"], [1271, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1272, "            to scale based on demand\n"], [1273, "        - id: W11\n"], [1274, "          reason: Cloudwatch does not support resource-level permissions, and Bedrock\n"], [1275, "            should support any enabled Bedrock model_id or inference profile\n"], [1276, "    Properties:\n"], [1277, "      PermissionsBoundary:\n"], [1278, "        Fn::If:\n"], [1279, "        - HasPermissionsBoundary\n"], [1280, "        - Ref: PermissionsBoundaryArn\n"], [1281, "        - Ref: AWS::NoValue\n"], [1282, "      CodeUri: AssessmentFunction\n"], [1283, "      Handler: index.handler\n"], [1284, "      Runtime: python3.12\n"], [1285, "      Timeout: 900\n"], [1286, "      MemorySize: 512\n"], [1287, "      Environment:\n"], [1288, "        Variables:\n"], [1289, "          METRIC_NAMESPACE:\n"], [1290, "            Ref: StackName\n"], [1291, "          CONFIGURATION_BUCKET:\n"], [1292, "            Ref: ConfigurationBucket\n"], [1293, "          CONFIGURATION_TABLE_NAME:\n"], [1294, "            Ref: ConfigurationTable\n"], [1295, "          LOG_LEVEL:\n"], [1296, "            Ref: LogLevel\n"], [1297, "          APPSYNC_API_URL:\n"], [1298, "            Ref: AppSyncApiUrl\n"], [1299, "          WORKING_BUCKET:\n"], [1300, "            Ref: WorkingBucket\n"], [1301, "      LoggingConfig:\n"], [1302, "        LogGroup:\n"], [1303, "          Ref: AssessmentFunctionLogGroup\n"], [1304, "      Policies:\n"], [1305, "      - AWSLambdaBasicExecutionRole\n"], [1306, "      - S3CrudPolicy:\n"], [1307, "          BucketName:\n"], [1308, "            Ref: OutputBucket\n"], [1309, "      - S3CrudPolicy:\n"], [1310, "          BucketName:\n"], [1311, "            Ref: WorkingBucket\n"], [1312, "      - S3ReadPolicy:\n"], [1313, "          BucketName:\n"], [1314, "            Ref: InputBucket\n"], [1315, "      - S3ReadPolicy:\n"], [1316, "          BucketName:\n"], [1317, "            Ref: ConfigurationBucket\n"], [1318, "      - DynamoDBCrudPolicy:\n"], [1319, "          TableName:\n"], [1320, "            Ref: ConfigurationTable\n"], [1321, "      - Statement:\n"], [1322, "        - Effect: Allow\n"], [1323, "          Action: cloudwatch:PutMetricData\n"], [1324, "          Resource: '*'\n"], [1325, "        - Effect: Allow\n"], [1326, "          Action:\n"], [1327, "          - kms:Encrypt\n"], [1328, "          - kms:Decrypt\n"], [1329, "          - kms:ReEncrypt*\n"], [1330, "          - kms:GenerateDataKey*\n"], [1331, "          - kms:DescribeKey\n"], [1332, "          Resource:\n"], [1333, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1334, "        - Effect: Allow\n"], [1335, "          Action:\n"], [1336, "          - appsync:GraphQL\n"], [1337, "          Resource:\n"], [1338, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1339, "        - Effect: Allow\n"], [1340, "          Action: bedrock:InvokeModel\n"], [1341, "          Resource:\n"], [1342, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1343, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1344, "        - Fn::If:\n"], [1345, "          - HasGuardrailConfig\n"], [1346, "          - Effect: Allow\n"], [1347, "            Action: bedrock:ApplyGuardrail\n"], [1348, "            Resource:\n"], [1349, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1350, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1261, 1350], "resource": "AWS::Serverless::Function.AssessmentFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[1360, "  ProcessResultsFunction:\n"], [1361, "    Type: AWS::Serverless::Function\n"], [1362, "    Metadata:\n"], [1363, "      SamResourceId: ProcessResultsFunction\n"], [1364, "      cfn_nag:\n"], [1365, "        rules_to_suppress:\n"], [1366, "        - id: W11\n"], [1367, "          reason: Cloudwatch does not support resource-level permissions\n"], [1368, "        - id: W89\n"], [1369, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1370, "            with AWS services via AWS APIs\n"], [1371, "        - id: W92\n"], [1372, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1373, "            to scale based on demand\n"], [1374, "    Properties:\n"], [1375, "      PermissionsBoundary:\n"], [1376, "        Fn::If:\n"], [1377, "        - HasPermissionsBoundary\n"], [1378, "        - Ref: PermissionsBoundaryArn\n"], [1379, "        - Ref: AWS::NoValue\n"], [1380, "      CodeUri: ProcessResultsFunction\n"], [1381, "      Handler: index.handler\n"], [1382, "      Runtime: python3.12\n"], [1383, "      Timeout: 900\n"], [1384, "      MemorySize: 4096\n"], [1385, "      Environment:\n"], [1386, "        Variables:\n"], [1387, "          METRIC_NAMESPACE:\n"], [1388, "            Ref: StackName\n"], [1389, "          LOG_LEVEL:\n"], [1390, "            Ref: LogLevel\n"], [1391, "          APPSYNC_API_URL:\n"], [1392, "            Ref: AppSyncApiUrl\n"], [1393, "          WORKING_BUCKET:\n"], [1394, "            Ref: WorkingBucket\n"], [1395, "      LoggingConfig:\n"], [1396, "        LogGroup:\n"], [1397, "          Ref: ProcessResultsFunctionLogGroup\n"], [1398, "      Policies:\n"], [1399, "      - AWSLambdaBasicExecutionRole\n"], [1400, "      - S3ReadPolicy:\n"], [1401, "          BucketName:\n"], [1402, "            Ref: InputBucket\n"], [1403, "      - S3CrudPolicy:\n"], [1404, "          BucketName:\n"], [1405, "            Ref: OutputBucket\n"], [1406, "      - S3CrudPolicy:\n"], [1407, "          BucketName:\n"], [1408, "            Ref: WorkingBucket\n"], [1409, "      - Statement:\n"], [1410, "        - Effect: Allow\n"], [1411, "          Action: cloudwatch:PutMetricData\n"], [1412, "          Resource: '*'\n"], [1413, "        - Effect: Allow\n"], [1414, "          Action:\n"], [1415, "          - kms:Encrypt\n"], [1416, "          - kms:Decrypt\n"], [1417, "          - kms:ReEncrypt*\n"], [1418, "          - kms:GenerateDataKey*\n"], [1419, "          - kms:DescribeKey\n"], [1420, "          Resource:\n"], [1421, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1422, "        - Effect: Allow\n"], [1423, "          Action:\n"], [1424, "          - appsync:GraphQL\n"], [1425, "          Resource:\n"], [1426, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1360, 1426], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[1360, "  ProcessResultsFunction:\n"], [1361, "    Type: AWS::Serverless::Function\n"], [1362, "    Metadata:\n"], [1363, "      SamResourceId: ProcessResultsFunction\n"], [1364, "      cfn_nag:\n"], [1365, "        rules_to_suppress:\n"], [1366, "        - id: W11\n"], [1367, "          reason: Cloudwatch does not support resource-level permissions\n"], [1368, "        - id: W89\n"], [1369, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1370, "            with AWS services via AWS APIs\n"], [1371, "        - id: W92\n"], [1372, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1373, "            to scale based on demand\n"], [1374, "    Properties:\n"], [1375, "      PermissionsBoundary:\n"], [1376, "        Fn::If:\n"], [1377, "        - HasPermissionsBoundary\n"], [1378, "        - Ref: PermissionsBoundaryArn\n"], [1379, "        - Ref: AWS::NoValue\n"], [1380, "      CodeUri: ProcessResultsFunction\n"], [1381, "      Handler: index.handler\n"], [1382, "      Runtime: python3.12\n"], [1383, "      Timeout: 900\n"], [1384, "      MemorySize: 4096\n"], [1385, "      Environment:\n"], [1386, "        Variables:\n"], [1387, "          METRIC_NAMESPACE:\n"], [1388, "            Ref: StackName\n"], [1389, "          LOG_LEVEL:\n"], [1390, "            Ref: LogLevel\n"], [1391, "          APPSYNC_API_URL:\n"], [1392, "            Ref: AppSyncApiUrl\n"], [1393, "          WORKING_BUCKET:\n"], [1394, "            Ref: WorkingBucket\n"], [1395, "      LoggingConfig:\n"], [1396, "        LogGroup:\n"], [1397, "          Ref: ProcessResultsFunctionLogGroup\n"], [1398, "      Policies:\n"], [1399, "      - AWSLambdaBasicExecutionRole\n"], [1400, "      - S3ReadPolicy:\n"], [1401, "          BucketName:\n"], [1402, "            Ref: InputBucket\n"], [1403, "      - S3CrudPolicy:\n"], [1404, "          BucketName:\n"], [1405, "            Ref: OutputBucket\n"], [1406, "      - S3CrudPolicy:\n"], [1407, "          BucketName:\n"], [1408, "            Ref: WorkingBucket\n"], [1409, "      - Statement:\n"], [1410, "        - Effect: Allow\n"], [1411, "          Action: cloudwatch:PutMetricData\n"], [1412, "          Resource: '*'\n"], [1413, "        - Effect: Allow\n"], [1414, "          Action:\n"], [1415, "          - kms:Encrypt\n"], [1416, "          - kms:Decrypt\n"], [1417, "          - kms:ReEncrypt*\n"], [1418, "          - kms:GenerateDataKey*\n"], [1419, "          - kms:DescribeKey\n"], [1420, "          Resource:\n"], [1421, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1422, "        - Effect: Allow\n"], [1423, "          Action:\n"], [1424, "          - appsync:GraphQL\n"], [1425, "          Resource:\n"], [1426, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1360, 1426], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[1360, "  ProcessResultsFunction:\n"], [1361, "    Type: AWS::Serverless::Function\n"], [1362, "    Metadata:\n"], [1363, "      SamResourceId: ProcessResultsFunction\n"], [1364, "      cfn_nag:\n"], [1365, "        rules_to_suppress:\n"], [1366, "        - id: W11\n"], [1367, "          reason: Cloudwatch does not support resource-level permissions\n"], [1368, "        - id: W89\n"], [1369, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1370, "            with AWS services via AWS APIs\n"], [1371, "        - id: W92\n"], [1372, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1373, "            to scale based on demand\n"], [1374, "    Properties:\n"], [1375, "      PermissionsBoundary:\n"], [1376, "        Fn::If:\n"], [1377, "        - HasPermissionsBoundary\n"], [1378, "        - Ref: PermissionsBoundaryArn\n"], [1379, "        - Ref: AWS::NoValue\n"], [1380, "      CodeUri: ProcessResultsFunction\n"], [1381, "      Handler: index.handler\n"], [1382, "      Runtime: python3.12\n"], [1383, "      Timeout: 900\n"], [1384, "      MemorySize: 4096\n"], [1385, "      Environment:\n"], [1386, "        Variables:\n"], [1387, "          METRIC_NAMESPACE:\n"], [1388, "            Ref: StackName\n"], [1389, "          LOG_LEVEL:\n"], [1390, "            Ref: LogLevel\n"], [1391, "          APPSYNC_API_URL:\n"], [1392, "            Ref: AppSyncApiUrl\n"], [1393, "          WORKING_BUCKET:\n"], [1394, "            Ref: WorkingBucket\n"], [1395, "      LoggingConfig:\n"], [1396, "        LogGroup:\n"], [1397, "          Ref: ProcessResultsFunctionLogGroup\n"], [1398, "      Policies:\n"], [1399, "      - AWSLambdaBasicExecutionRole\n"], [1400, "      - S3ReadPolicy:\n"], [1401, "          BucketName:\n"], [1402, "            Ref: InputBucket\n"], [1403, "      - S3CrudPolicy:\n"], [1404, "          BucketName:\n"], [1405, "            Ref: OutputBucket\n"], [1406, "      - S3CrudPolicy:\n"], [1407, "          BucketName:\n"], [1408, "            Ref: WorkingBucket\n"], [1409, "      - Statement:\n"], [1410, "        - Effect: Allow\n"], [1411, "          Action: cloudwatch:PutMetricData\n"], [1412, "          Resource: '*'\n"], [1413, "        - Effect: Allow\n"], [1414, "          Action:\n"], [1415, "          - kms:Encrypt\n"], [1416, "          - kms:Decrypt\n"], [1417, "          - kms:ReEncrypt*\n"], [1418, "          - kms:GenerateDataKey*\n"], [1419, "          - kms:DescribeKey\n"], [1420, "          Resource:\n"], [1421, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1422, "        - Effect: Allow\n"], [1423, "          Action:\n"], [1424, "          - appsync:GraphQL\n"], [1425, "          Resource:\n"], [1426, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1360, 1426], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[1360, "  ProcessResultsFunction:\n"], [1361, "    Type: AWS::Serverless::Function\n"], [1362, "    Metadata:\n"], [1363, "      SamResourceId: ProcessResultsFunction\n"], [1364, "      cfn_nag:\n"], [1365, "        rules_to_suppress:\n"], [1366, "        - id: W11\n"], [1367, "          reason: Cloudwatch does not support resource-level permissions\n"], [1368, "        - id: W89\n"], [1369, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1370, "            with AWS services via AWS APIs\n"], [1371, "        - id: W92\n"], [1372, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1373, "            to scale based on demand\n"], [1374, "    Properties:\n"], [1375, "      PermissionsBoundary:\n"], [1376, "        Fn::If:\n"], [1377, "        - HasPermissionsBoundary\n"], [1378, "        - Ref: PermissionsBoundaryArn\n"], [1379, "        - Ref: AWS::NoValue\n"], [1380, "      CodeUri: ProcessResultsFunction\n"], [1381, "      Handler: index.handler\n"], [1382, "      Runtime: python3.12\n"], [1383, "      Timeout: 900\n"], [1384, "      MemorySize: 4096\n"], [1385, "      Environment:\n"], [1386, "        Variables:\n"], [1387, "          METRIC_NAMESPACE:\n"], [1388, "            Ref: StackName\n"], [1389, "          LOG_LEVEL:\n"], [1390, "            Ref: LogLevel\n"], [1391, "          APPSYNC_API_URL:\n"], [1392, "            Ref: AppSyncApiUrl\n"], [1393, "          WORKING_BUCKET:\n"], [1394, "            Ref: WorkingBucket\n"], [1395, "      LoggingConfig:\n"], [1396, "        LogGroup:\n"], [1397, "          Ref: ProcessResultsFunctionLogGroup\n"], [1398, "      Policies:\n"], [1399, "      - AWSLambdaBasicExecutionRole\n"], [1400, "      - S3ReadPolicy:\n"], [1401, "          BucketName:\n"], [1402, "            Ref: InputBucket\n"], [1403, "      - S3CrudPolicy:\n"], [1404, "          BucketName:\n"], [1405, "            Ref: OutputBucket\n"], [1406, "      - S3CrudPolicy:\n"], [1407, "          BucketName:\n"], [1408, "            Ref: WorkingBucket\n"], [1409, "      - Statement:\n"], [1410, "        - Effect: Allow\n"], [1411, "          Action: cloudwatch:PutMetricData\n"], [1412, "          Resource: '*'\n"], [1413, "        - Effect: Allow\n"], [1414, "          Action:\n"], [1415, "          - kms:Encrypt\n"], [1416, "          - kms:Decrypt\n"], [1417, "          - kms:ReEncrypt*\n"], [1418, "          - kms:GenerateDataKey*\n"], [1419, "          - kms:DescribeKey\n"], [1420, "          Resource:\n"], [1421, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1422, "        - Effect: Allow\n"], [1423, "          Action:\n"], [1424, "          - appsync:GraphQL\n"], [1425, "          Resource:\n"], [1426, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1360, 1426], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[1436, "  SummarizationFunction:\n"], [1437, "    Type: AWS::Serverless::Function\n"], [1438, "    Metadata:\n"], [1439, "      SamResourceId: SummarizationFunction\n"], [1440, "      cfn_nag:\n"], [1441, "        rules_to_suppress:\n"], [1442, "        - id: W11\n"], [1443, "          reason: Cloudwatch does not support resource-level permissions\n"], [1444, "        - id: W89\n"], [1445, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1446, "            with AWS services via AWS APIs\n"], [1447, "        - id: W92\n"], [1448, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1449, "            to scale based on demand\n"], [1450, "    Properties:\n"], [1451, "      PermissionsBoundary:\n"], [1452, "        Fn::If:\n"], [1453, "        - HasPermissionsBoundary\n"], [1454, "        - Ref: PermissionsBoundaryArn\n"], [1455, "        - Ref: AWS::NoValue\n"], [1456, "      CodeUri: SummarizationFunction\n"], [1457, "      Handler: index.handler\n"], [1458, "      Runtime: python3.12\n"], [1459, "      Timeout: 900\n"], [1460, "      MemorySize: 4096\n"], [1461, "      Environment:\n"], [1462, "        Variables:\n"], [1463, "          METRIC_NAMESPACE:\n"], [1464, "            Ref: StackName\n"], [1465, "          CONFIGURATION_TABLE_NAME:\n"], [1466, "            Ref: ConfigurationTable\n"], [1467, "          GUARDRAIL_ID_AND_VERSION:\n"], [1468, "            Fn::If:\n"], [1469, "            - HasGuardrailConfig\n"], [1470, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1471, "            - ''\n"], [1472, "          LOG_LEVEL:\n"], [1473, "            Ref: LogLevel\n"], [1474, "          APPSYNC_API_URL:\n"], [1475, "            Ref: AppSyncApiUrl\n"], [1476, "          WORKING_BUCKET:\n"], [1477, "            Ref: WorkingBucket\n"], [1478, "      LoggingConfig:\n"], [1479, "        LogGroup:\n"], [1480, "          Ref: SummarizationFunctionLogGroup\n"], [1481, "      Policies:\n"], [1482, "      - AWSLambdaBasicExecutionRole\n"], [1483, "      - S3ReadPolicy:\n"], [1484, "          BucketName:\n"], [1485, "            Ref: InputBucket\n"], [1486, "      - S3CrudPolicy:\n"], [1487, "          BucketName:\n"], [1488, "            Ref: OutputBucket\n"], [1489, "      - S3CrudPolicy:\n"], [1490, "          BucketName:\n"], [1491, "            Ref: WorkingBucket\n"], [1492, "      - DynamoDBCrudPolicy:\n"], [1493, "          TableName:\n"], [1494, "            Ref: ConfigurationTable\n"], [1495, "      - Statement:\n"], [1496, "        - Effect: Allow\n"], [1497, "          Action: cloudwatch:PutMetricData\n"], [1498, "          Resource: '*'\n"], [1499, "        - Effect: Allow\n"], [1500, "          Action:\n"], [1501, "          - kms:Encrypt\n"], [1502, "          - kms:Decrypt\n"], [1503, "          - kms:ReEncrypt*\n"], [1504, "          - kms:GenerateDataKey*\n"], [1505, "          - kms:DescribeKey\n"], [1506, "          Resource:\n"], [1507, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1508, "        - Effect: Allow\n"], [1509, "          Action:\n"], [1510, "          - appsync:GraphQL\n"], [1511, "          Resource:\n"], [1512, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1513, "        - Effect: Allow\n"], [1514, "          Action: bedrock:InvokeModel\n"], [1515, "          Resource:\n"], [1516, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1517, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1518, "        - Fn::If:\n"], [1519, "          - HasGuardrailConfig\n"], [1520, "          - Effect: Allow\n"], [1521, "            Action: bedrock:ApplyGuardrail\n"], [1522, "            Resource:\n"], [1523, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1524, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1436, 1524], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[1436, "  SummarizationFunction:\n"], [1437, "    Type: AWS::Serverless::Function\n"], [1438, "    Metadata:\n"], [1439, "      SamResourceId: SummarizationFunction\n"], [1440, "      cfn_nag:\n"], [1441, "        rules_to_suppress:\n"], [1442, "        - id: W11\n"], [1443, "          reason: Cloudwatch does not support resource-level permissions\n"], [1444, "        - id: W89\n"], [1445, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1446, "            with AWS services via AWS APIs\n"], [1447, "        - id: W92\n"], [1448, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1449, "            to scale based on demand\n"], [1450, "    Properties:\n"], [1451, "      PermissionsBoundary:\n"], [1452, "        Fn::If:\n"], [1453, "        - HasPermissionsBoundary\n"], [1454, "        - Ref: PermissionsBoundaryArn\n"], [1455, "        - Ref: AWS::NoValue\n"], [1456, "      CodeUri: SummarizationFunction\n"], [1457, "      Handler: index.handler\n"], [1458, "      Runtime: python3.12\n"], [1459, "      Timeout: 900\n"], [1460, "      MemorySize: 4096\n"], [1461, "      Environment:\n"], [1462, "        Variables:\n"], [1463, "          METRIC_NAMESPACE:\n"], [1464, "            Ref: StackName\n"], [1465, "          CONFIGURATION_TABLE_NAME:\n"], [1466, "            Ref: ConfigurationTable\n"], [1467, "          GUARDRAIL_ID_AND_VERSION:\n"], [1468, "            Fn::If:\n"], [1469, "            - HasGuardrailConfig\n"], [1470, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1471, "            - ''\n"], [1472, "          LOG_LEVEL:\n"], [1473, "            Ref: LogLevel\n"], [1474, "          APPSYNC_API_URL:\n"], [1475, "            Ref: AppSyncApiUrl\n"], [1476, "          WORKING_BUCKET:\n"], [1477, "            Ref: WorkingBucket\n"], [1478, "      LoggingConfig:\n"], [1479, "        LogGroup:\n"], [1480, "          Ref: SummarizationFunctionLogGroup\n"], [1481, "      Policies:\n"], [1482, "      - AWSLambdaBasicExecutionRole\n"], [1483, "      - S3ReadPolicy:\n"], [1484, "          BucketName:\n"], [1485, "            Ref: InputBucket\n"], [1486, "      - S3CrudPolicy:\n"], [1487, "          BucketName:\n"], [1488, "            Ref: OutputBucket\n"], [1489, "      - S3CrudPolicy:\n"], [1490, "          BucketName:\n"], [1491, "            Ref: WorkingBucket\n"], [1492, "      - DynamoDBCrudPolicy:\n"], [1493, "          TableName:\n"], [1494, "            Ref: ConfigurationTable\n"], [1495, "      - Statement:\n"], [1496, "        - Effect: Allow\n"], [1497, "          Action: cloudwatch:PutMetricData\n"], [1498, "          Resource: '*'\n"], [1499, "        - Effect: Allow\n"], [1500, "          Action:\n"], [1501, "          - kms:Encrypt\n"], [1502, "          - kms:Decrypt\n"], [1503, "          - kms:ReEncrypt*\n"], [1504, "          - kms:GenerateDataKey*\n"], [1505, "          - kms:DescribeKey\n"], [1506, "          Resource:\n"], [1507, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1508, "        - Effect: Allow\n"], [1509, "          Action:\n"], [1510, "          - appsync:GraphQL\n"], [1511, "          Resource:\n"], [1512, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1513, "        - Effect: Allow\n"], [1514, "          Action: bedrock:InvokeModel\n"], [1515, "          Resource:\n"], [1516, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1517, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1518, "        - Fn::If:\n"], [1519, "          - HasGuardrailConfig\n"], [1520, "          - Effect: Allow\n"], [1521, "            Action: bedrock:ApplyGuardrail\n"], [1522, "            Resource:\n"], [1523, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1524, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1436, 1524], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[1436, "  SummarizationFunction:\n"], [1437, "    Type: AWS::Serverless::Function\n"], [1438, "    Metadata:\n"], [1439, "      SamResourceId: SummarizationFunction\n"], [1440, "      cfn_nag:\n"], [1441, "        rules_to_suppress:\n"], [1442, "        - id: W11\n"], [1443, "          reason: Cloudwatch does not support resource-level permissions\n"], [1444, "        - id: W89\n"], [1445, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1446, "            with AWS services via AWS APIs\n"], [1447, "        - id: W92\n"], [1448, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1449, "            to scale based on demand\n"], [1450, "    Properties:\n"], [1451, "      PermissionsBoundary:\n"], [1452, "        Fn::If:\n"], [1453, "        - HasPermissionsBoundary\n"], [1454, "        - Ref: PermissionsBoundaryArn\n"], [1455, "        - Ref: AWS::NoValue\n"], [1456, "      CodeUri: SummarizationFunction\n"], [1457, "      Handler: index.handler\n"], [1458, "      Runtime: python3.12\n"], [1459, "      Timeout: 900\n"], [1460, "      MemorySize: 4096\n"], [1461, "      Environment:\n"], [1462, "        Variables:\n"], [1463, "          METRIC_NAMESPACE:\n"], [1464, "            Ref: StackName\n"], [1465, "          CONFIGURATION_TABLE_NAME:\n"], [1466, "            Ref: ConfigurationTable\n"], [1467, "          GUARDRAIL_ID_AND_VERSION:\n"], [1468, "            Fn::If:\n"], [1469, "            - HasGuardrailConfig\n"], [1470, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1471, "            - ''\n"], [1472, "          LOG_LEVEL:\n"], [1473, "            Ref: LogLevel\n"], [1474, "          APPSYNC_API_URL:\n"], [1475, "            Ref: AppSyncApiUrl\n"], [1476, "          WORKING_BUCKET:\n"], [1477, "            Ref: WorkingBucket\n"], [1478, "      LoggingConfig:\n"], [1479, "        LogGroup:\n"], [1480, "          Ref: SummarizationFunctionLogGroup\n"], [1481, "      Policies:\n"], [1482, "      - AWSLambdaBasicExecutionRole\n"], [1483, "      - S3ReadPolicy:\n"], [1484, "          BucketName:\n"], [1485, "            Ref: InputBucket\n"], [1486, "      - S3CrudPolicy:\n"], [1487, "          BucketName:\n"], [1488, "            Ref: OutputBucket\n"], [1489, "      - S3CrudPolicy:\n"], [1490, "          BucketName:\n"], [1491, "            Ref: WorkingBucket\n"], [1492, "      - DynamoDBCrudPolicy:\n"], [1493, "          TableName:\n"], [1494, "            Ref: ConfigurationTable\n"], [1495, "      - Statement:\n"], [1496, "        - Effect: Allow\n"], [1497, "          Action: cloudwatch:PutMetricData\n"], [1498, "          Resource: '*'\n"], [1499, "        - Effect: Allow\n"], [1500, "          Action:\n"], [1501, "          - kms:Encrypt\n"], [1502, "          - kms:Decrypt\n"], [1503, "          - kms:ReEncrypt*\n"], [1504, "          - kms:GenerateDataKey*\n"], [1505, "          - kms:DescribeKey\n"], [1506, "          Resource:\n"], [1507, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1508, "        - Effect: Allow\n"], [1509, "          Action:\n"], [1510, "          - appsync:GraphQL\n"], [1511, "          Resource:\n"], [1512, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1513, "        - Effect: Allow\n"], [1514, "          Action: bedrock:InvokeModel\n"], [1515, "          Resource:\n"], [1516, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1517, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1518, "        - Fn::If:\n"], [1519, "          - HasGuardrailConfig\n"], [1520, "          - Effect: Allow\n"], [1521, "            Action: bedrock:ApplyGuardrail\n"], [1522, "            Resource:\n"], [1523, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1524, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1436, 1524], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[1436, "  SummarizationFunction:\n"], [1437, "    Type: AWS::Serverless::Function\n"], [1438, "    Metadata:\n"], [1439, "      SamResourceId: SummarizationFunction\n"], [1440, "      cfn_nag:\n"], [1441, "        rules_to_suppress:\n"], [1442, "        - id: W11\n"], [1443, "          reason: Cloudwatch does not support resource-level permissions\n"], [1444, "        - id: W89\n"], [1445, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1446, "            with AWS services via AWS APIs\n"], [1447, "        - id: W92\n"], [1448, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1449, "            to scale based on demand\n"], [1450, "    Properties:\n"], [1451, "      PermissionsBoundary:\n"], [1452, "        Fn::If:\n"], [1453, "        - HasPermissionsBoundary\n"], [1454, "        - Ref: PermissionsBoundaryArn\n"], [1455, "        - Ref: AWS::NoValue\n"], [1456, "      CodeUri: SummarizationFunction\n"], [1457, "      Handler: index.handler\n"], [1458, "      Runtime: python3.12\n"], [1459, "      Timeout: 900\n"], [1460, "      MemorySize: 4096\n"], [1461, "      Environment:\n"], [1462, "        Variables:\n"], [1463, "          METRIC_NAMESPACE:\n"], [1464, "            Ref: StackName\n"], [1465, "          CONFIGURATION_TABLE_NAME:\n"], [1466, "            Ref: ConfigurationTable\n"], [1467, "          GUARDRAIL_ID_AND_VERSION:\n"], [1468, "            Fn::If:\n"], [1469, "            - HasGuardrailConfig\n"], [1470, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [1471, "            - ''\n"], [1472, "          LOG_LEVEL:\n"], [1473, "            Ref: LogLevel\n"], [1474, "          APPSYNC_API_URL:\n"], [1475, "            Ref: AppSyncApiUrl\n"], [1476, "          WORKING_BUCKET:\n"], [1477, "            Ref: WorkingBucket\n"], [1478, "      LoggingConfig:\n"], [1479, "        LogGroup:\n"], [1480, "          Ref: SummarizationFunctionLogGroup\n"], [1481, "      Policies:\n"], [1482, "      - AWSLambdaBasicExecutionRole\n"], [1483, "      - S3ReadPolicy:\n"], [1484, "          BucketName:\n"], [1485, "            Ref: InputBucket\n"], [1486, "      - S3CrudPolicy:\n"], [1487, "          BucketName:\n"], [1488, "            Ref: OutputBucket\n"], [1489, "      - S3CrudPolicy:\n"], [1490, "          BucketName:\n"], [1491, "            Ref: WorkingBucket\n"], [1492, "      - DynamoDBCrudPolicy:\n"], [1493, "          TableName:\n"], [1494, "            Ref: ConfigurationTable\n"], [1495, "      - Statement:\n"], [1496, "        - Effect: Allow\n"], [1497, "          Action: cloudwatch:PutMetricData\n"], [1498, "          Resource: '*'\n"], [1499, "        - Effect: Allow\n"], [1500, "          Action:\n"], [1501, "          - kms:Encrypt\n"], [1502, "          - kms:Decrypt\n"], [1503, "          - kms:ReEncrypt*\n"], [1504, "          - kms:GenerateDataKey*\n"], [1505, "          - kms:DescribeKey\n"], [1506, "          Resource:\n"], [1507, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1508, "        - Effect: Allow\n"], [1509, "          Action:\n"], [1510, "          - appsync:GraphQL\n"], [1511, "          Resource:\n"], [1512, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [1513, "        - Effect: Allow\n"], [1514, "          Action: bedrock:InvokeModel\n"], [1515, "          Resource:\n"], [1516, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [1517, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [1518, "        - Fn::If:\n"], [1519, "          - HasGuardrailConfig\n"], [1520, "          - Effect: Allow\n"], [1521, "            Action: bedrock:ApplyGuardrail\n"], [1522, "            Resource:\n"], [1523, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [1524, "          - Ref: AWS::NoValue\n"]], "file_path": "/template.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "repo_file_path": "/template.yaml", "file_line_range": [1436, 1524], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-2/.aws-sam/build/template.yaml", "attribute_key": "Default"}]}}]}, "summary": {"passed": 26, "failed": 24, "skipped": 0, "parsing_errors": 0, "resource_count": 17, "checkov_version": "3.2.461"}}