[
  {
    "source": "security-matrix",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "resourceType": "IAM Role",
    "resourceName": "OpenSearchLambdaExecutionRole",
    "issue": "IAM policy grants overly permissive S3 access (s3:PutObject*, s3:GetObject*, s3:DeleteObject*) to all S3 resources ('arn:aws:s3:::*')",
    "priority": "High",
    "status": "Open"
  },
  {
    "source": "security-matrix",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "resourceType": "IAM Role",
    "resourceName": "OpenSearchLambdaExecutionRole",
    "issue": "IAM policy grants overly permissive access with wildcard permissions on multiple AOSSPermissions actions to all resources ('*')",
    "priority": "High",
    "status": "Open"
  },
  {
    "source": "security-matrix",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "resourceType": "AWS::Serverless::Function",
    "resourceName": "GetAdjustedStackNameFunction",
    "issue": "Lambda function does not have X-Ray tracing enabled",
    "priority": "High",
    "status": "Open"
  },
  {
    "source": "security-matrix",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "resourceType": "AWS::Serverless::Function",
    "resourceName": "GetSeedUrlsFunction",
    "issue": "Lambda function does not have X-Ray tracing enabled",
    "priority": "High",
    "status": "Open"
  },
  {
    "source": "security-matrix",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "resourceType": "AWS::Serverless::Function",
    "resourceName": "CreateOSSIndexLambdaFunction",
    "issue": "Lambda function does not have X-Ray tracing enabled",
    "priority": "High", 
    "status": "Open"
  },
  {
    "source": "security-matrix",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "resourceType": "AWS::Lambda::Function",
    "resourceName": "StartIngestionJobFunction",
    "issue": "Lambda function does not have X-Ray tracing enabled",
    "priority": "High",
    "status": "Open"
  },
  {
    "source": "security-matrix",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "resourceType": "OpenSearchServerless Collection",
    "resourceName": "OSSCollection",
    "issue": "OpenSearch Serverless Collection uses AWS owned keys instead of customer managed keys for sensitive data",
    "priority": "Medium",
    "status": "Open"
  },
  {
    "source": "security-matrix",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "resourceType": "OpenSearchServerless Network Policy",
    "resourceName": "OSSNetworkPolicy",
    "issue": "Network Policy allows public access to OpenSearch collection and dashboard",
    "priority": "High",
    "status": "Open"
  },
  {
    "source": "security-matrix",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "resourceType": "AWS::Serverless::Function",
    "resourceName": "CreateOSSIndexLambdaFunction",
    "issue": "Lambda function has high timeout (840 seconds) which may lead to increased costs and resource consumption",
    "priority": "Low",
    "status": "Open"
  },
  {
    "source": "security-matrix",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "resourceType": "AWS::Bedrock::DataSource",
    "resourceName": "WebDataSource",
    "issue": "Web crawler rate limit set to 300 which might be aggressive and cause throttling or service disruption for target sites",
    "priority": "Medium",
    "status": "Open"
  },
  {
    "source": "security-matrix",
    "stack": "AWS GenAI IDP Accelerator - Bedrock Knowledge Base setup",
    "resourceType": "IAM Role",
    "resourceName": "KnowledgeBaseServiceRole",
    "issue": "IAM policy grants access to all foundation models (bedrock:InvokeModel on 'arn:aws:bedrock:${AWS::Region}::foundation-model/*')",
    "priority": "Medium",
    "status": "Open"
  }
]