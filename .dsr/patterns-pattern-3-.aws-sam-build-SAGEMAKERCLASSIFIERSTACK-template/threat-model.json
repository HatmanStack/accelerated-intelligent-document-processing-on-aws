[
  {
    "id": "SAGEMAKER-INFERENCE-ENDPOINT-UDOP-THREAT-001",
    "stack": "SageMaker-Inference-Endpoint-UDOP",
    "stride_category": "Information Disclosure",
    "severity": "High",
    "resource_type": "AWS::SageMaker::EndpointConfig",
    "resource_name": "UDOPEndpointConfig",
    "title": "Missing Encryption for SageMaker Endpoint Storage",
    "issue": "The SageMaker endpoint configuration doesn't enforce encryption of data stored on instance volumes. This may expose sensitive model data and temporary processing data at rest.",
    "attack_vector": "An attacker with access to the underlying storage infrastructure could potentially extract sensitive information from unencrypted instance volumes.",
    "impact": "Unauthorized access to model data, prediction inputs/outputs, or other sensitive information processed by the endpoint.",
    "remediation": "Add KmsKeyId property to the EndpointConfig resource to enable encryption for the SageMaker endpoint. Note that there's a suppressed cfn_nag rule W1200 mentioning KMS key not being supported for NVMe instance storage - ensure your selected instance type supports volume encryption.",
    "priority": 1,
    "estimated_effort": "Low",
    "cwe_id": "CWE-311",
    "compliance_violations": ["HIPAA", "PCI DSS 3.2.1", "GDPR Article 32"],
    "references": ["https://docs.aws.amazon.com/sagemaker/latest/dg/API_CreateEndpointConfig.html"],
    "status": "Open"
  },
  {
    "id": "SAGEMAKER-INFERENCE-ENDPOINT-UDOP-THREAT-002",
    "stack": "SageMaker-Inference-Endpoint-UDOP",
    "stride_category": "Repudiation",
    "severity": "Medium",
    "resource_type": "AWS::SageMaker::Endpoint",
    "resource_name": "UDOPEndpoint",
    "title": "Missing Data Capture and Logging Configuration",
    "issue": "The SageMaker endpoint lacks data capture configuration for inputs and outputs. Without logging prediction requests and responses, there's no audit trail for model usage and predictions.",
    "attack_vector": "Without proper logging, malicious use of the endpoint cannot be traced, and there's no way to audit compliance or investigate incidents.",
    "impact": "Inability to detect unauthorized access, verify compliance with regulations, or investigate security incidents related to model predictions.",
    "remediation": "Enable data capture for the endpoint by adding DataCaptureConfig to the EndpointConfig resource, specifying CaptureOptions for both 'Input' and 'Output' data with appropriate DestinationS3Uri and KmsKeyId for encryption.",
    "priority": 2,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-778",
    "compliance_violations": ["GDPR Article 30", "SOC 2"],
    "references": ["https://docs.aws.amazon.com/sagemaker/latest/dg/model-monitor-data-capture.html"],
    "status": "Open"
  },
  {
    "id": "SAGEMAKER-INFERENCE-ENDPOINT-UDOP-THREAT-003",
    "stack": "SageMaker-Inference-Endpoint-UDOP",
    "stride_category": "Elevation of Privilege",
    "severity": "High",
    "resource_type": "AWS::IAM::Role",
    "resource_name": "UDOPExecutionRole",
    "title": "Overly Permissive IAM Role",
    "issue": "The execution role has the AmazonSageMakerFullAccess managed policy attached, which grants excessive permissions beyond what's needed for model inference.",
    "attack_vector": "If the SageMaker endpoint is compromised, an attacker could leverage the overly permissive role to access or manipulate other SageMaker resources in the account.",
    "impact": "Potential unauthorized access to other SageMaker resources, models, and data across the AWS account.",
    "remediation": "Replace the AmazonSageMakerFullAccess managed policy with specific inline policies that grant only the permissions needed for the endpoint's operation (such as sagemaker:InvokeEndpoint and specific S3 access).",
    "priority": 1,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-272",
    "compliance_violations": ["CIS AWS Foundations 1.16", "AWS Well-Architected Framework"],
    "references": ["https://docs.aws.amazon.com/sagemaker/latest/dg/sagemaker-roles.html"],
    "status": "Open"
  },
  {
    "id": "SAGEMAKER-INFERENCE-ENDPOINT-UDOP-THREAT-004",
    "stack": "SageMaker-Inference-Endpoint-UDOP",
    "stride_category": "Information Disclosure",
    "severity": "Medium",
    "resource_type": "AWS::SageMaker::Model",
    "resource_name": "UDOPModel",
    "title": "Missing Network Isolation for SageMaker Model",
    "issue": "The SageMaker model does not enable network isolation, which means the container can make external network calls during inference.",
    "attack_vector": "A compromised container could exfiltrate sensitive data to external endpoints or download unauthorized code during inference.",
    "impact": "Potential data leakage, model theft, or execution of unauthorized code within the SageMaker container.",
    "remediation": "Add the EnableNetworkIsolation property set to true on the AWS::SageMaker::Model resource to prevent the container from making external network calls.",
    "priority": 2,
    "estimated_effort": "Low",
    "cwe_id": "CWE-668",
    "compliance_violations": ["GDPR Article 32", "AWS Well-Architected Framework"],
    "references": ["https://docs.aws.amazon.com/sagemaker/latest/dg/model-isolated.html"],
    "status": "Open"
  },
  {
    "id": "SAGEMAKER-INFERENCE-ENDPOINT-UDOP-THREAT-005",
    "stack": "SageMaker-Inference-Endpoint-UDOP",
    "stride_category": "Tampering",
    "severity": "High",
    "resource_type": "AWS::SageMaker::Model",
    "resource_name": "UDOPModel",
    "title": "No Image Digest Pinning for Container Image",
    "issue": "The container image for the model is specified without a digest hash, using only a tag (2.1.0-gpu-py310), which could allow for image tampering.",
    "attack_vector": "If an attacker gains access to the ECR repository or can manipulate DNS, they could potentially serve a malicious container image with the same tag.",
    "impact": "Execution of unauthorized code within the SageMaker container, potentially leading to model theft or data exfiltration.",
    "remediation": "Use the full image URI with a digest hash (@sha256:...) instead of relying only on the tag to ensure image immutability and prevent tampering.",
    "priority": 1,
    "estimated_effort": "Low",
    "cwe_id": "CWE-345",
    "compliance_violations": ["NIST 800-53 SC-8", "AWS Well-Architected Framework"],
    "references": ["https://docs.aws.amazon.com/AmazonECR/latest/userguide/image-digests.html"],
    "status": "Open"
  },
  {
    "id": "SAGEMAKER-INFERENCE-ENDPOINT-UDOP-THREAT-006",
    "stack": "SageMaker-Inference-Endpoint-UDOP",
    "stride_category": "Denial of Service",
    "severity": "Medium",
    "resource_type": "AWS::ApplicationAutoScaling::ScalingPolicy",
    "resource_name": "ScalingPolicy",
    "title": "Suboptimal Auto-scaling Configuration",
    "issue": "The auto-scaling configuration may not be optimal to handle burst traffic scenarios with a relatively high ScaleInCooldown (300s) and potentially low TargetInvocationsPerInstance default value.",
    "attack_vector": "An attacker could perform a denial of service by overwhelming the endpoint with requests before it can scale out sufficiently.",
    "impact": "Service degradation or outage for legitimate users during traffic spikes or targeted DoS attacks.",
    "remediation": "Review and adjust the auto-scaling parameters based on workload patterns. Consider reducing ScaleInCooldown, increasing ScaleOutCooldown for faster scaling, and setting appropriate TargetInvocationsPerInstance based on model performance characteristics.",
    "priority": 3,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-400",
    "compliance_violations": ["AWS Well-Architected Framework"],
    "references": ["https://docs.aws.amazon.com/sagemaker/latest/dg/endpoint-auto-scaling.html"],
    "status": "Open"
  },
  {
    "id": "SAGEMAKER-INFERENCE-ENDPOINT-UDOP-THREAT-007",
    "stack": "SageMaker-Inference-Endpoint-UDOP",
    "stride_category": "Repudiation",
    "severity": "Medium",
    "resource_type": "AWS::CloudFormation::Stack",
    "resource_name": "Stack",
    "title": "Missing Monitoring and Alerting Configuration",
    "issue": "The template does not define CloudWatch alarms or monitoring for the SageMaker endpoint, making it difficult to detect and respond to suspicious activity or performance issues.",
    "attack_vector": "Security incidents or performance degradation may go unnoticed without proper monitoring and alerting.",
    "impact": "Delayed response to security incidents, unauthorized access, or model performance issues.",
    "remediation": "Add CloudWatch Alarms for key metrics such as Invocations, InvocationsPerInstance, ModelLatency, and Errors. Configure appropriate thresholds and notification actions.",
    "priority": 2,
    "estimated_effort": "Medium",
    "cwe_id": "CWE-778",
    "compliance_violations": ["NIST 800-53 AU-6", "SOC 2"],
    "references": ["https://docs.aws.amazon.com/sagemaker/latest/dg/monitoring-cloudwatch.html"],
    "status": "Open"
  },
  {
    "id": "SAGEMAKER-INFERENCE-ENDPOINT-UDOP-THREAT-008",
    "stack": "SageMaker-Inference-Endpoint-UDOP",
    "stride_category": "Information Disclosure",
    "severity": "Medium",
    "resource_type": "AWS::IAM::Role",
    "resource_name": "UDOPExecutionRole",
    "title": "Over-permissive S3 Access",
    "issue": "The IAM role policy for S3 access grants read permissions to the entire S3 bucket specified in the S3Bucket parameter, rather than restricting access to only the necessary paths.",
    "attack_vector": "If the SageMaker endpoint is compromised, an attacker could access any object in the specified S3 bucket, potentially accessing sensitive data unrelated to the model.",
    "impact": "Unauthorized access to sensitive data stored in the same S3 bucket but unrelated to the SageMaker model's operation.",
    "remediation": "Restrict S3 access to only the specific paths needed for model operation by limiting the resources in the IAM policy to specific prefixes rather than granting access to the entire bucket.",
    "priority": 2,
    "estimated_effort": "Low",
    "cwe_id": "CWE-732",
    "compliance_violations": ["CIS AWS Foundations 1.16", "AWS Well-Architected Framework"],
    "references": ["https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege"],
    "status": "Open"
  }
]