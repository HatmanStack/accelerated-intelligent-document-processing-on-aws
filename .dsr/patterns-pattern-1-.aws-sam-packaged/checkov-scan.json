{"check_type": "cloudformation", "results": {"failed_checks": [{"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[593, "  InvokeBDAFunction:\n"], [594, "    Type: AWS::Serverless::Function\n"], [595, "    Metadata:\n"], [596, "      SamResourceId: InvokeBDAFunction\n"], [597, "      cfn_nag:\n"], [598, "        rules_to_suppress:\n"], [599, "        - id: W11\n"], [600, "          reason: Cloudwatch does not support resource-level permissions\n"], [601, "        - id: W89\n"], [602, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [603, "            with AWS services via AWS APIs\n"], [604, "        - id: W92\n"], [605, "          reason: Function does not require concurrent execution limits as it is designed\n"], [606, "            to scale based on demand\n"], [607, "    Properties:\n"], [608, "      PermissionsBoundary:\n"], [609, "        Fn::If:\n"], [610, "        - HasPermissionsBoundary\n"], [611, "        - Ref: PermissionsBoundaryArn\n"], [612, "        - Ref: AWS::NoValue\n"], [613, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/efb561793d0eeecc77350b6fc92b8e73\n"], [614, "      Handler: index.handler\n"], [615, "      Runtime: python3.12\n"], [616, "      Timeout: 900\n"], [617, "      MemorySize: 4096\n"], [618, "      Environment:\n"], [619, "        Variables:\n"], [620, "          TRACKING_TABLE:\n"], [621, "            Ref: TrackingTable\n"], [622, "          METRIC_NAMESPACE:\n"], [623, "            Ref: StackName\n"], [624, "          MAX_WORKERS: 20\n"], [625, "          LOG_LEVEL:\n"], [626, "            Ref: LogLevel\n"], [627, "      LoggingConfig:\n"], [628, "        LogGroup:\n"], [629, "          Ref: InvokeBDAFunctionLogGroup\n"], [630, "      Policies:\n"], [631, "      - AWSLambdaBasicExecutionRole\n"], [632, "      - S3ReadPolicy:\n"], [633, "          BucketName:\n"], [634, "            Ref: InputBucket\n"], [635, "      - S3CrudPolicy:\n"], [636, "          BucketName:\n"], [637, "            Ref: WorkingBucket\n"], [638, "      - S3CrudPolicy:\n"], [639, "          BucketName:\n"], [640, "            Ref: OutputBucket\n"], [641, "      - DynamoDBCrudPolicy:\n"], [642, "          TableName:\n"], [643, "            Ref: TrackingTable\n"], [644, "      - Statement:\n"], [645, "        - Effect: Allow\n"], [646, "          Action: cloudwatch:PutMetricData\n"], [647, "          Resource: '*'\n"], [648, "        - Effect: Allow\n"], [649, "          Action:\n"], [650, "          - kms:Encrypt\n"], [651, "          - kms:Decrypt\n"], [652, "          - kms:ReEncrypt*\n"], [653, "          - kms:GenerateDataKey*\n"], [654, "          - kms:DescribeKey\n"], [655, "          Resource:\n"], [656, "            Ref: CustomerManagedEncryptionKeyArn\n"], [657, "        - Effect: Allow\n"], [658, "          Action: bedrock:InvokeDataAutomationAsync\n"], [659, "          Resource:\n"], [660, "          - Ref: BDAProjectArn\n"], [661, "          - Fn::Sub: arn:aws:bedrock:us-east-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [662, "          - Fn::Sub: arn:aws:bedrock:us-east-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [663, "          - Fn::Sub: arn:aws:bedrock:us-west-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [664, "          - Fn::Sub: arn:aws:bedrock:us-west-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [593, 664], "resource": "AWS::Serverless::Function.InvokeBDAFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[593, "  InvokeBDAFunction:\n"], [594, "    Type: AWS::Serverless::Function\n"], [595, "    Metadata:\n"], [596, "      SamResourceId: InvokeBDAFunction\n"], [597, "      cfn_nag:\n"], [598, "        rules_to_suppress:\n"], [599, "        - id: W11\n"], [600, "          reason: Cloudwatch does not support resource-level permissions\n"], [601, "        - id: W89\n"], [602, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [603, "            with AWS services via AWS APIs\n"], [604, "        - id: W92\n"], [605, "          reason: Function does not require concurrent execution limits as it is designed\n"], [606, "            to scale based on demand\n"], [607, "    Properties:\n"], [608, "      PermissionsBoundary:\n"], [609, "        Fn::If:\n"], [610, "        - HasPermissionsBoundary\n"], [611, "        - Ref: PermissionsBoundaryArn\n"], [612, "        - Ref: AWS::NoValue\n"], [613, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/efb561793d0eeecc77350b6fc92b8e73\n"], [614, "      Handler: index.handler\n"], [615, "      Runtime: python3.12\n"], [616, "      Timeout: 900\n"], [617, "      MemorySize: 4096\n"], [618, "      Environment:\n"], [619, "        Variables:\n"], [620, "          TRACKING_TABLE:\n"], [621, "            Ref: TrackingTable\n"], [622, "          METRIC_NAMESPACE:\n"], [623, "            Ref: StackName\n"], [624, "          MAX_WORKERS: 20\n"], [625, "          LOG_LEVEL:\n"], [626, "            Ref: LogLevel\n"], [627, "      LoggingConfig:\n"], [628, "        LogGroup:\n"], [629, "          Ref: InvokeBDAFunctionLogGroup\n"], [630, "      Policies:\n"], [631, "      - AWSLambdaBasicExecutionRole\n"], [632, "      - S3ReadPolicy:\n"], [633, "          BucketName:\n"], [634, "            Ref: InputBucket\n"], [635, "      - S3CrudPolicy:\n"], [636, "          BucketName:\n"], [637, "            Ref: WorkingBucket\n"], [638, "      - S3CrudPolicy:\n"], [639, "          BucketName:\n"], [640, "            Ref: OutputBucket\n"], [641, "      - DynamoDBCrudPolicy:\n"], [642, "          TableName:\n"], [643, "            Ref: TrackingTable\n"], [644, "      - Statement:\n"], [645, "        - Effect: Allow\n"], [646, "          Action: cloudwatch:PutMetricData\n"], [647, "          Resource: '*'\n"], [648, "        - Effect: Allow\n"], [649, "          Action:\n"], [650, "          - kms:Encrypt\n"], [651, "          - kms:Decrypt\n"], [652, "          - kms:ReEncrypt*\n"], [653, "          - kms:GenerateDataKey*\n"], [654, "          - kms:DescribeKey\n"], [655, "          Resource:\n"], [656, "            Ref: CustomerManagedEncryptionKeyArn\n"], [657, "        - Effect: Allow\n"], [658, "          Action: bedrock:InvokeDataAutomationAsync\n"], [659, "          Resource:\n"], [660, "          - Ref: BDAProjectArn\n"], [661, "          - Fn::Sub: arn:aws:bedrock:us-east-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [662, "          - Fn::Sub: arn:aws:bedrock:us-east-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [663, "          - Fn::Sub: arn:aws:bedrock:us-west-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [664, "          - Fn::Sub: arn:aws:bedrock:us-west-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [593, 664], "resource": "AWS::Serverless::Function.InvokeBDAFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[593, "  InvokeBDAFunction:\n"], [594, "    Type: AWS::Serverless::Function\n"], [595, "    Metadata:\n"], [596, "      SamResourceId: InvokeBDAFunction\n"], [597, "      cfn_nag:\n"], [598, "        rules_to_suppress:\n"], [599, "        - id: W11\n"], [600, "          reason: Cloudwatch does not support resource-level permissions\n"], [601, "        - id: W89\n"], [602, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [603, "            with AWS services via AWS APIs\n"], [604, "        - id: W92\n"], [605, "          reason: Function does not require concurrent execution limits as it is designed\n"], [606, "            to scale based on demand\n"], [607, "    Properties:\n"], [608, "      PermissionsBoundary:\n"], [609, "        Fn::If:\n"], [610, "        - HasPermissionsBoundary\n"], [611, "        - Ref: PermissionsBoundaryArn\n"], [612, "        - Ref: AWS::NoValue\n"], [613, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/efb561793d0eeecc77350b6fc92b8e73\n"], [614, "      Handler: index.handler\n"], [615, "      Runtime: python3.12\n"], [616, "      Timeout: 900\n"], [617, "      MemorySize: 4096\n"], [618, "      Environment:\n"], [619, "        Variables:\n"], [620, "          TRACKING_TABLE:\n"], [621, "            Ref: TrackingTable\n"], [622, "          METRIC_NAMESPACE:\n"], [623, "            Ref: StackName\n"], [624, "          MAX_WORKERS: 20\n"], [625, "          LOG_LEVEL:\n"], [626, "            Ref: LogLevel\n"], [627, "      LoggingConfig:\n"], [628, "        LogGroup:\n"], [629, "          Ref: InvokeBDAFunctionLogGroup\n"], [630, "      Policies:\n"], [631, "      - AWSLambdaBasicExecutionRole\n"], [632, "      - S3ReadPolicy:\n"], [633, "          BucketName:\n"], [634, "            Ref: InputBucket\n"], [635, "      - S3CrudPolicy:\n"], [636, "          BucketName:\n"], [637, "            Ref: WorkingBucket\n"], [638, "      - S3CrudPolicy:\n"], [639, "          BucketName:\n"], [640, "            Ref: OutputBucket\n"], [641, "      - DynamoDBCrudPolicy:\n"], [642, "          TableName:\n"], [643, "            Ref: TrackingTable\n"], [644, "      - Statement:\n"], [645, "        - Effect: Allow\n"], [646, "          Action: cloudwatch:PutMetricData\n"], [647, "          Resource: '*'\n"], [648, "        - Effect: Allow\n"], [649, "          Action:\n"], [650, "          - kms:Encrypt\n"], [651, "          - kms:Decrypt\n"], [652, "          - kms:ReEncrypt*\n"], [653, "          - kms:GenerateDataKey*\n"], [654, "          - kms:DescribeKey\n"], [655, "          Resource:\n"], [656, "            Ref: CustomerManagedEncryptionKeyArn\n"], [657, "        - Effect: Allow\n"], [658, "          Action: bedrock:InvokeDataAutomationAsync\n"], [659, "          Resource:\n"], [660, "          - Ref: BDAProjectArn\n"], [661, "          - Fn::Sub: arn:aws:bedrock:us-east-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [662, "          - Fn::Sub: arn:aws:bedrock:us-east-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [663, "          - Fn::Sub: arn:aws:bedrock:us-west-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [664, "          - Fn::Sub: arn:aws:bedrock:us-west-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [593, 664], "resource": "AWS::Serverless::Function.InvokeBDAFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[593, "  InvokeBDAFunction:\n"], [594, "    Type: AWS::Serverless::Function\n"], [595, "    Metadata:\n"], [596, "      SamResourceId: InvokeBDAFunction\n"], [597, "      cfn_nag:\n"], [598, "        rules_to_suppress:\n"], [599, "        - id: W11\n"], [600, "          reason: Cloudwatch does not support resource-level permissions\n"], [601, "        - id: W89\n"], [602, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [603, "            with AWS services via AWS APIs\n"], [604, "        - id: W92\n"], [605, "          reason: Function does not require concurrent execution limits as it is designed\n"], [606, "            to scale based on demand\n"], [607, "    Properties:\n"], [608, "      PermissionsBoundary:\n"], [609, "        Fn::If:\n"], [610, "        - HasPermissionsBoundary\n"], [611, "        - Ref: PermissionsBoundaryArn\n"], [612, "        - Ref: AWS::NoValue\n"], [613, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/efb561793d0eeecc77350b6fc92b8e73\n"], [614, "      Handler: index.handler\n"], [615, "      Runtime: python3.12\n"], [616, "      Timeout: 900\n"], [617, "      MemorySize: 4096\n"], [618, "      Environment:\n"], [619, "        Variables:\n"], [620, "          TRACKING_TABLE:\n"], [621, "            Ref: TrackingTable\n"], [622, "          METRIC_NAMESPACE:\n"], [623, "            Ref: StackName\n"], [624, "          MAX_WORKERS: 20\n"], [625, "          LOG_LEVEL:\n"], [626, "            Ref: LogLevel\n"], [627, "      LoggingConfig:\n"], [628, "        LogGroup:\n"], [629, "          Ref: InvokeBDAFunctionLogGroup\n"], [630, "      Policies:\n"], [631, "      - AWSLambdaBasicExecutionRole\n"], [632, "      - S3ReadPolicy:\n"], [633, "          BucketName:\n"], [634, "            Ref: InputBucket\n"], [635, "      - S3CrudPolicy:\n"], [636, "          BucketName:\n"], [637, "            Ref: WorkingBucket\n"], [638, "      - S3CrudPolicy:\n"], [639, "          BucketName:\n"], [640, "            Ref: OutputBucket\n"], [641, "      - DynamoDBCrudPolicy:\n"], [642, "          TableName:\n"], [643, "            Ref: TrackingTable\n"], [644, "      - Statement:\n"], [645, "        - Effect: Allow\n"], [646, "          Action: cloudwatch:PutMetricData\n"], [647, "          Resource: '*'\n"], [648, "        - Effect: Allow\n"], [649, "          Action:\n"], [650, "          - kms:Encrypt\n"], [651, "          - kms:Decrypt\n"], [652, "          - kms:ReEncrypt*\n"], [653, "          - kms:GenerateDataKey*\n"], [654, "          - kms:DescribeKey\n"], [655, "          Resource:\n"], [656, "            Ref: CustomerManagedEncryptionKeyArn\n"], [657, "        - Effect: Allow\n"], [658, "          Action: bedrock:InvokeDataAutomationAsync\n"], [659, "          Resource:\n"], [660, "          - Ref: BDAProjectArn\n"], [661, "          - Fn::Sub: arn:aws:bedrock:us-east-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [662, "          - Fn::Sub: arn:aws:bedrock:us-east-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [663, "          - Fn::Sub: arn:aws:bedrock:us-west-1:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"], [664, "          - Fn::Sub: arn:aws:bedrock:us-west-2:${AWS::AccountId}:data-automation-profile/us.data-automation-v1\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [593, 664], "resource": "AWS::Serverless::Function.InvokeBDAFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[676, "  ProcessResultsFunction:\n"], [677, "    Type: AWS::Serverless::Function\n"], [678, "    Metadata:\n"], [679, "      SamResourceId: ProcessResultsFunction\n"], [680, "      cfn_nag:\n"], [681, "        rules_to_suppress:\n"], [682, "        - id: W11\n"], [683, "          reason: Cloudwatch does not support resource-level permissions\n"], [684, "        - id: W89\n"], [685, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [686, "            with AWS services via AWS APIs\n"], [687, "        - id: W92\n"], [688, "          reason: Function does not require concurrent execution limits as it is designed\n"], [689, "            to scale based on demand\n"], [690, "    Properties:\n"], [691, "      PermissionsBoundary:\n"], [692, "        Fn::If:\n"], [693, "        - HasPermissionsBoundary\n"], [694, "        - Ref: PermissionsBoundaryArn\n"], [695, "        - Ref: AWS::NoValue\n"], [696, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/51806b7c862cd1c6804dcb5dde5c56c7\n"], [697, "      Handler: index.handler\n"], [698, "      Runtime: python3.12\n"], [699, "      Timeout: 900\n"], [700, "      MemorySize: 4096\n"], [701, "      Environment:\n"], [702, "        Variables:\n"], [703, "          METRIC_NAMESPACE:\n"], [704, "            Ref: StackName\n"], [705, "          LOG_LEVEL:\n"], [706, "            Ref: LogLevel\n"], [707, "          APPSYNC_API_URL:\n"], [708, "            Ref: AppSyncApiUrl\n"], [709, "          ENABLE_HITL:\n"], [710, "            Ref: EnableHITL\n"], [711, "          DB_NAME:\n"], [712, "            Ref: BDAMetadataTable\n"], [713, "          BDA_PROJECT_ARN:\n"], [714, "            Ref: BDAProjectArn\n"], [715, "          WORKING_BUCKET:\n"], [716, "            Ref: WorkingBucket\n"], [717, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [718, "            Ref: SageMakerA2IReviewPortalURL\n"], [719, "          CONFIGURATION_TABLE_NAME:\n"], [720, "            Ref: ConfigurationTable\n"], [721, "      LoggingConfig:\n"], [722, "        LogGroup:\n"], [723, "          Ref: ProcessResultsFunctionLogGroup\n"], [724, "      Policies:\n"], [725, "      - AWSLambdaBasicExecutionRole\n"], [726, "      - S3ReadPolicy:\n"], [727, "          BucketName:\n"], [728, "            Ref: InputBucket\n"], [729, "      - S3CrudPolicy:\n"], [730, "          BucketName:\n"], [731, "            Ref: WorkingBucket\n"], [732, "      - S3CrudPolicy:\n"], [733, "          BucketName:\n"], [734, "            Ref: OutputBucket\n"], [735, "      - DynamoDBCrudPolicy:\n"], [736, "          TableName:\n"], [737, "            Ref: BDAMetadataTable\n"], [738, "      - DynamoDBCrudPolicy:\n"], [739, "          TableName:\n"], [740, "            Ref: ConfigurationTable\n"], [741, "      - Statement:\n"], [742, "        - Effect: Allow\n"], [743, "          Action: cloudwatch:PutMetricData\n"], [744, "          Resource: '*'\n"], [745, "        - Effect: Allow\n"], [746, "          Action:\n"], [747, "          - kms:Encrypt\n"], [748, "          - kms:Decrypt\n"], [749, "          - kms:ReEncrypt*\n"], [750, "          - kms:GenerateDataKey*\n"], [751, "          - kms:DescribeKey\n"], [752, "          Resource:\n"], [753, "            Ref: CustomerManagedEncryptionKeyArn\n"], [754, "        - Effect: Allow\n"], [755, "          Action:\n"], [756, "          - appsync:GraphQL\n"], [757, "          Resource:\n"], [758, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [759, "        - Effect: Allow\n"], [760, "          Action:\n"], [761, "          - sagemaker:StartHumanLoop\n"], [762, "          Resource: arn:aws:sagemaker:*:*:flow-definition/*\n"], [763, "        - Effect: Allow\n"], [764, "          Action:\n"], [765, "          - ssm:GetParameter\n"], [766, "          - ssm:PutParameter\n"], [767, "          - ssm:GetParametersByPath\n"], [768, "          Resource: '*'\n"], [769, "        - Effect: Allow\n"], [770, "          Action:\n"], [771, "          - bedrock:GetDataAutomationProject\n"], [772, "          - bedrock:ListDataAutomationProjects\n"], [773, "          - bedrock:GetBlueprint\n"], [774, "          - bedrock:GetBlueprintRecommendation\n"], [775, "          Resource: '*'\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [676, 775], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables.ENABLE_HITL": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[676, "  ProcessResultsFunction:\n"], [677, "    Type: AWS::Serverless::Function\n"], [678, "    Metadata:\n"], [679, "      SamResourceId: ProcessResultsFunction\n"], [680, "      cfn_nag:\n"], [681, "        rules_to_suppress:\n"], [682, "        - id: W11\n"], [683, "          reason: Cloudwatch does not support resource-level permissions\n"], [684, "        - id: W89\n"], [685, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [686, "            with AWS services via AWS APIs\n"], [687, "        - id: W92\n"], [688, "          reason: Function does not require concurrent execution limits as it is designed\n"], [689, "            to scale based on demand\n"], [690, "    Properties:\n"], [691, "      PermissionsBoundary:\n"], [692, "        Fn::If:\n"], [693, "        - HasPermissionsBoundary\n"], [694, "        - Ref: PermissionsBoundaryArn\n"], [695, "        - Ref: AWS::NoValue\n"], [696, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/51806b7c862cd1c6804dcb5dde5c56c7\n"], [697, "      Handler: index.handler\n"], [698, "      Runtime: python3.12\n"], [699, "      Timeout: 900\n"], [700, "      MemorySize: 4096\n"], [701, "      Environment:\n"], [702, "        Variables:\n"], [703, "          METRIC_NAMESPACE:\n"], [704, "            Ref: StackName\n"], [705, "          LOG_LEVEL:\n"], [706, "            Ref: LogLevel\n"], [707, "          APPSYNC_API_URL:\n"], [708, "            Ref: AppSyncApiUrl\n"], [709, "          ENABLE_HITL:\n"], [710, "            Ref: EnableHITL\n"], [711, "          DB_NAME:\n"], [712, "            Ref: BDAMetadataTable\n"], [713, "          BDA_PROJECT_ARN:\n"], [714, "            Ref: BDAProjectArn\n"], [715, "          WORKING_BUCKET:\n"], [716, "            Ref: WorkingBucket\n"], [717, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [718, "            Ref: SageMakerA2IReviewPortalURL\n"], [719, "          CONFIGURATION_TABLE_NAME:\n"], [720, "            Ref: ConfigurationTable\n"], [721, "      LoggingConfig:\n"], [722, "        LogGroup:\n"], [723, "          Ref: ProcessResultsFunctionLogGroup\n"], [724, "      Policies:\n"], [725, "      - AWSLambdaBasicExecutionRole\n"], [726, "      - S3ReadPolicy:\n"], [727, "          BucketName:\n"], [728, "            Ref: InputBucket\n"], [729, "      - S3CrudPolicy:\n"], [730, "          BucketName:\n"], [731, "            Ref: WorkingBucket\n"], [732, "      - S3CrudPolicy:\n"], [733, "          BucketName:\n"], [734, "            Ref: OutputBucket\n"], [735, "      - DynamoDBCrudPolicy:\n"], [736, "          TableName:\n"], [737, "            Ref: BDAMetadataTable\n"], [738, "      - DynamoDBCrudPolicy:\n"], [739, "          TableName:\n"], [740, "            Ref: ConfigurationTable\n"], [741, "      - Statement:\n"], [742, "        - Effect: Allow\n"], [743, "          Action: cloudwatch:PutMetricData\n"], [744, "          Resource: '*'\n"], [745, "        - Effect: Allow\n"], [746, "          Action:\n"], [747, "          - kms:Encrypt\n"], [748, "          - kms:Decrypt\n"], [749, "          - kms:ReEncrypt*\n"], [750, "          - kms:GenerateDataKey*\n"], [751, "          - kms:DescribeKey\n"], [752, "          Resource:\n"], [753, "            Ref: CustomerManagedEncryptionKeyArn\n"], [754, "        - Effect: Allow\n"], [755, "          Action:\n"], [756, "          - appsync:GraphQL\n"], [757, "          Resource:\n"], [758, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [759, "        - Effect: Allow\n"], [760, "          Action:\n"], [761, "          - sagemaker:StartHumanLoop\n"], [762, "          Resource: arn:aws:sagemaker:*:*:flow-definition/*\n"], [763, "        - Effect: Allow\n"], [764, "          Action:\n"], [765, "          - ssm:GetParameter\n"], [766, "          - ssm:PutParameter\n"], [767, "          - ssm:GetParametersByPath\n"], [768, "          Resource: '*'\n"], [769, "        - Effect: Allow\n"], [770, "          Action:\n"], [771, "          - bedrock:GetDataAutomationProject\n"], [772, "          - bedrock:ListDataAutomationProjects\n"], [773, "          - bedrock:GetBlueprint\n"], [774, "          - bedrock:GetBlueprintRecommendation\n"], [775, "          Resource: '*'\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [676, 775], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables.ENABLE_HITL": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[676, "  ProcessResultsFunction:\n"], [677, "    Type: AWS::Serverless::Function\n"], [678, "    Metadata:\n"], [679, "      SamResourceId: ProcessResultsFunction\n"], [680, "      cfn_nag:\n"], [681, "        rules_to_suppress:\n"], [682, "        - id: W11\n"], [683, "          reason: Cloudwatch does not support resource-level permissions\n"], [684, "        - id: W89\n"], [685, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [686, "            with AWS services via AWS APIs\n"], [687, "        - id: W92\n"], [688, "          reason: Function does not require concurrent execution limits as it is designed\n"], [689, "            to scale based on demand\n"], [690, "    Properties:\n"], [691, "      PermissionsBoundary:\n"], [692, "        Fn::If:\n"], [693, "        - HasPermissionsBoundary\n"], [694, "        - Ref: PermissionsBoundaryArn\n"], [695, "        - Ref: AWS::NoValue\n"], [696, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/51806b7c862cd1c6804dcb5dde5c56c7\n"], [697, "      Handler: index.handler\n"], [698, "      Runtime: python3.12\n"], [699, "      Timeout: 900\n"], [700, "      MemorySize: 4096\n"], [701, "      Environment:\n"], [702, "        Variables:\n"], [703, "          METRIC_NAMESPACE:\n"], [704, "            Ref: StackName\n"], [705, "          LOG_LEVEL:\n"], [706, "            Ref: LogLevel\n"], [707, "          APPSYNC_API_URL:\n"], [708, "            Ref: AppSyncApiUrl\n"], [709, "          ENABLE_HITL:\n"], [710, "            Ref: EnableHITL\n"], [711, "          DB_NAME:\n"], [712, "            Ref: BDAMetadataTable\n"], [713, "          BDA_PROJECT_ARN:\n"], [714, "            Ref: BDAProjectArn\n"], [715, "          WORKING_BUCKET:\n"], [716, "            Ref: WorkingBucket\n"], [717, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [718, "            Ref: SageMakerA2IReviewPortalURL\n"], [719, "          CONFIGURATION_TABLE_NAME:\n"], [720, "            Ref: ConfigurationTable\n"], [721, "      LoggingConfig:\n"], [722, "        LogGroup:\n"], [723, "          Ref: ProcessResultsFunctionLogGroup\n"], [724, "      Policies:\n"], [725, "      - AWSLambdaBasicExecutionRole\n"], [726, "      - S3ReadPolicy:\n"], [727, "          BucketName:\n"], [728, "            Ref: InputBucket\n"], [729, "      - S3CrudPolicy:\n"], [730, "          BucketName:\n"], [731, "            Ref: WorkingBucket\n"], [732, "      - S3CrudPolicy:\n"], [733, "          BucketName:\n"], [734, "            Ref: OutputBucket\n"], [735, "      - DynamoDBCrudPolicy:\n"], [736, "          TableName:\n"], [737, "            Ref: BDAMetadataTable\n"], [738, "      - DynamoDBCrudPolicy:\n"], [739, "          TableName:\n"], [740, "            Ref: ConfigurationTable\n"], [741, "      - Statement:\n"], [742, "        - Effect: Allow\n"], [743, "          Action: cloudwatch:PutMetricData\n"], [744, "          Resource: '*'\n"], [745, "        - Effect: Allow\n"], [746, "          Action:\n"], [747, "          - kms:Encrypt\n"], [748, "          - kms:Decrypt\n"], [749, "          - kms:ReEncrypt*\n"], [750, "          - kms:GenerateDataKey*\n"], [751, "          - kms:DescribeKey\n"], [752, "          Resource:\n"], [753, "            Ref: CustomerManagedEncryptionKeyArn\n"], [754, "        - Effect: Allow\n"], [755, "          Action:\n"], [756, "          - appsync:GraphQL\n"], [757, "          Resource:\n"], [758, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [759, "        - Effect: Allow\n"], [760, "          Action:\n"], [761, "          - sagemaker:StartHumanLoop\n"], [762, "          Resource: arn:aws:sagemaker:*:*:flow-definition/*\n"], [763, "        - Effect: Allow\n"], [764, "          Action:\n"], [765, "          - ssm:GetParameter\n"], [766, "          - ssm:PutParameter\n"], [767, "          - ssm:GetParametersByPath\n"], [768, "          Resource: '*'\n"], [769, "        - Effect: Allow\n"], [770, "          Action:\n"], [771, "          - bedrock:GetDataAutomationProject\n"], [772, "          - bedrock:ListDataAutomationProjects\n"], [773, "          - bedrock:GetBlueprint\n"], [774, "          - bedrock:GetBlueprintRecommendation\n"], [775, "          Resource: '*'\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [676, 775], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables.ENABLE_HITL": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[676, "  ProcessResultsFunction:\n"], [677, "    Type: AWS::Serverless::Function\n"], [678, "    Metadata:\n"], [679, "      SamResourceId: ProcessResultsFunction\n"], [680, "      cfn_nag:\n"], [681, "        rules_to_suppress:\n"], [682, "        - id: W11\n"], [683, "          reason: Cloudwatch does not support resource-level permissions\n"], [684, "        - id: W89\n"], [685, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [686, "            with AWS services via AWS APIs\n"], [687, "        - id: W92\n"], [688, "          reason: Function does not require concurrent execution limits as it is designed\n"], [689, "            to scale based on demand\n"], [690, "    Properties:\n"], [691, "      PermissionsBoundary:\n"], [692, "        Fn::If:\n"], [693, "        - HasPermissionsBoundary\n"], [694, "        - Ref: PermissionsBoundaryArn\n"], [695, "        - Ref: AWS::NoValue\n"], [696, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/51806b7c862cd1c6804dcb5dde5c56c7\n"], [697, "      Handler: index.handler\n"], [698, "      Runtime: python3.12\n"], [699, "      Timeout: 900\n"], [700, "      MemorySize: 4096\n"], [701, "      Environment:\n"], [702, "        Variables:\n"], [703, "          METRIC_NAMESPACE:\n"], [704, "            Ref: StackName\n"], [705, "          LOG_LEVEL:\n"], [706, "            Ref: LogLevel\n"], [707, "          APPSYNC_API_URL:\n"], [708, "            Ref: AppSyncApiUrl\n"], [709, "          ENABLE_HITL:\n"], [710, "            Ref: EnableHITL\n"], [711, "          DB_NAME:\n"], [712, "            Ref: BDAMetadataTable\n"], [713, "          BDA_PROJECT_ARN:\n"], [714, "            Ref: BDAProjectArn\n"], [715, "          WORKING_BUCKET:\n"], [716, "            Ref: WorkingBucket\n"], [717, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [718, "            Ref: SageMakerA2IReviewPortalURL\n"], [719, "          CONFIGURATION_TABLE_NAME:\n"], [720, "            Ref: ConfigurationTable\n"], [721, "      LoggingConfig:\n"], [722, "        LogGroup:\n"], [723, "          Ref: ProcessResultsFunctionLogGroup\n"], [724, "      Policies:\n"], [725, "      - AWSLambdaBasicExecutionRole\n"], [726, "      - S3ReadPolicy:\n"], [727, "          BucketName:\n"], [728, "            Ref: InputBucket\n"], [729, "      - S3CrudPolicy:\n"], [730, "          BucketName:\n"], [731, "            Ref: WorkingBucket\n"], [732, "      - S3CrudPolicy:\n"], [733, "          BucketName:\n"], [734, "            Ref: OutputBucket\n"], [735, "      - DynamoDBCrudPolicy:\n"], [736, "          TableName:\n"], [737, "            Ref: BDAMetadataTable\n"], [738, "      - DynamoDBCrudPolicy:\n"], [739, "          TableName:\n"], [740, "            Ref: ConfigurationTable\n"], [741, "      - Statement:\n"], [742, "        - Effect: Allow\n"], [743, "          Action: cloudwatch:PutMetricData\n"], [744, "          Resource: '*'\n"], [745, "        - Effect: Allow\n"], [746, "          Action:\n"], [747, "          - kms:Encrypt\n"], [748, "          - kms:Decrypt\n"], [749, "          - kms:ReEncrypt*\n"], [750, "          - kms:GenerateDataKey*\n"], [751, "          - kms:DescribeKey\n"], [752, "          Resource:\n"], [753, "            Ref: CustomerManagedEncryptionKeyArn\n"], [754, "        - Effect: Allow\n"], [755, "          Action:\n"], [756, "          - appsync:GraphQL\n"], [757, "          Resource:\n"], [758, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [759, "        - Effect: Allow\n"], [760, "          Action:\n"], [761, "          - sagemaker:StartHumanLoop\n"], [762, "          Resource: arn:aws:sagemaker:*:*:flow-definition/*\n"], [763, "        - Effect: Allow\n"], [764, "          Action:\n"], [765, "          - ssm:GetParameter\n"], [766, "          - ssm:PutParameter\n"], [767, "          - ssm:GetParametersByPath\n"], [768, "          Resource: '*'\n"], [769, "        - Effect: Allow\n"], [770, "          Action:\n"], [771, "          - bedrock:GetDataAutomationProject\n"], [772, "          - bedrock:ListDataAutomationProjects\n"], [773, "          - bedrock:GetBlueprint\n"], [774, "          - bedrock:GetBlueprintRecommendation\n"], [775, "          Resource: '*'\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [676, 775], "resource": "AWS::Serverless::Function.ProcessResultsFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables.ENABLE_HITL": [{"type": "parameters", "name": "EnableHITL", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[787, "  SummarizationFunction:\n"], [788, "    Type: AWS::Serverless::Function\n"], [789, "    Metadata:\n"], [790, "      SamResourceId: SummarizationFunction\n"], [791, "      cfn_nag:\n"], [792, "        rules_to_suppress:\n"], [793, "        - id: W11\n"], [794, "          reason: Cloudwatch does not support resource-level permissions\n"], [795, "        - id: W89\n"], [796, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [797, "            with AWS services via AWS APIs\n"], [798, "        - id: W92\n"], [799, "          reason: Function does not require concurrent execution limits as it is designed\n"], [800, "            to scale based on demand\n"], [801, "    Properties:\n"], [802, "      PermissionsBoundary:\n"], [803, "        Fn::If:\n"], [804, "        - HasPermissionsBoundary\n"], [805, "        - Ref: PermissionsBoundaryArn\n"], [806, "        - Ref: AWS::NoValue\n"], [807, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/50c53f41fb63c075fb08bc37796bb3f7\n"], [808, "      Handler: index.handler\n"], [809, "      Runtime: python3.12\n"], [810, "      Timeout: 900\n"], [811, "      MemorySize: 4096\n"], [812, "      Environment:\n"], [813, "        Variables:\n"], [814, "          METRIC_NAMESPACE:\n"], [815, "            Ref: StackName\n"], [816, "          CONFIGURATION_TABLE_NAME:\n"], [817, "            Ref: ConfigurationTable\n"], [818, "          GUARDRAIL_ID_AND_VERSION:\n"], [819, "            Fn::If:\n"], [820, "            - HasGuardrailConfig\n"], [821, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [822, "            - ''\n"], [823, "          LOG_LEVEL:\n"], [824, "            Ref: LogLevel\n"], [825, "          APPSYNC_API_URL:\n"], [826, "            Ref: AppSyncApiUrl\n"], [827, "          WORKING_BUCKET:\n"], [828, "            Ref: WorkingBucket\n"], [829, "      LoggingConfig:\n"], [830, "        LogGroup:\n"], [831, "          Ref: SummarizationFunctionLogGroup\n"], [832, "      Policies:\n"], [833, "      - AWSLambdaBasicExecutionRole\n"], [834, "      - S3ReadPolicy:\n"], [835, "          BucketName:\n"], [836, "            Ref: InputBucket\n"], [837, "      - S3CrudPolicy:\n"], [838, "          BucketName:\n"], [839, "            Ref: OutputBucket\n"], [840, "      - S3CrudPolicy:\n"], [841, "          BucketName:\n"], [842, "            Ref: WorkingBucket\n"], [843, "      - DynamoDBCrudPolicy:\n"], [844, "          TableName:\n"], [845, "            Ref: ConfigurationTable\n"], [846, "      - Statement:\n"], [847, "        - Effect: Allow\n"], [848, "          Action: cloudwatch:PutMetricData\n"], [849, "          Resource: '*'\n"], [850, "        - Effect: Allow\n"], [851, "          Action:\n"], [852, "          - kms:Encrypt\n"], [853, "          - kms:Decrypt\n"], [854, "          - kms:ReEncrypt*\n"], [855, "          - kms:GenerateDataKey*\n"], [856, "          - kms:DescribeKey\n"], [857, "          Resource:\n"], [858, "            Ref: CustomerManagedEncryptionKeyArn\n"], [859, "        - Effect: Allow\n"], [860, "          Action:\n"], [861, "          - appsync:GraphQL\n"], [862, "          Resource:\n"], [863, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [864, "        - Effect: Allow\n"], [865, "          Action: bedrock:InvokeModel\n"], [866, "          Resource:\n"], [867, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [868, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [869, "        - Fn::If:\n"], [870, "          - HasGuardrailConfig\n"], [871, "          - Effect: Allow\n"], [872, "            Action: bedrock:ApplyGuardrail\n"], [873, "            Resource:\n"], [874, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [875, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [787, 875], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[787, "  SummarizationFunction:\n"], [788, "    Type: AWS::Serverless::Function\n"], [789, "    Metadata:\n"], [790, "      SamResourceId: SummarizationFunction\n"], [791, "      cfn_nag:\n"], [792, "        rules_to_suppress:\n"], [793, "        - id: W11\n"], [794, "          reason: Cloudwatch does not support resource-level permissions\n"], [795, "        - id: W89\n"], [796, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [797, "            with AWS services via AWS APIs\n"], [798, "        - id: W92\n"], [799, "          reason: Function does not require concurrent execution limits as it is designed\n"], [800, "            to scale based on demand\n"], [801, "    Properties:\n"], [802, "      PermissionsBoundary:\n"], [803, "        Fn::If:\n"], [804, "        - HasPermissionsBoundary\n"], [805, "        - Ref: PermissionsBoundaryArn\n"], [806, "        - Ref: AWS::NoValue\n"], [807, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/50c53f41fb63c075fb08bc37796bb3f7\n"], [808, "      Handler: index.handler\n"], [809, "      Runtime: python3.12\n"], [810, "      Timeout: 900\n"], [811, "      MemorySize: 4096\n"], [812, "      Environment:\n"], [813, "        Variables:\n"], [814, "          METRIC_NAMESPACE:\n"], [815, "            Ref: StackName\n"], [816, "          CONFIGURATION_TABLE_NAME:\n"], [817, "            Ref: ConfigurationTable\n"], [818, "          GUARDRAIL_ID_AND_VERSION:\n"], [819, "            Fn::If:\n"], [820, "            - HasGuardrailConfig\n"], [821, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [822, "            - ''\n"], [823, "          LOG_LEVEL:\n"], [824, "            Ref: LogLevel\n"], [825, "          APPSYNC_API_URL:\n"], [826, "            Ref: AppSyncApiUrl\n"], [827, "          WORKING_BUCKET:\n"], [828, "            Ref: WorkingBucket\n"], [829, "      LoggingConfig:\n"], [830, "        LogGroup:\n"], [831, "          Ref: SummarizationFunctionLogGroup\n"], [832, "      Policies:\n"], [833, "      - AWSLambdaBasicExecutionRole\n"], [834, "      - S3ReadPolicy:\n"], [835, "          BucketName:\n"], [836, "            Ref: InputBucket\n"], [837, "      - S3CrudPolicy:\n"], [838, "          BucketName:\n"], [839, "            Ref: OutputBucket\n"], [840, "      - S3CrudPolicy:\n"], [841, "          BucketName:\n"], [842, "            Ref: WorkingBucket\n"], [843, "      - DynamoDBCrudPolicy:\n"], [844, "          TableName:\n"], [845, "            Ref: ConfigurationTable\n"], [846, "      - Statement:\n"], [847, "        - Effect: Allow\n"], [848, "          Action: cloudwatch:PutMetricData\n"], [849, "          Resource: '*'\n"], [850, "        - Effect: Allow\n"], [851, "          Action:\n"], [852, "          - kms:Encrypt\n"], [853, "          - kms:Decrypt\n"], [854, "          - kms:ReEncrypt*\n"], [855, "          - kms:GenerateDataKey*\n"], [856, "          - kms:DescribeKey\n"], [857, "          Resource:\n"], [858, "            Ref: CustomerManagedEncryptionKeyArn\n"], [859, "        - Effect: Allow\n"], [860, "          Action:\n"], [861, "          - appsync:GraphQL\n"], [862, "          Resource:\n"], [863, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [864, "        - Effect: Allow\n"], [865, "          Action: bedrock:InvokeModel\n"], [866, "          Resource:\n"], [867, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [868, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [869, "        - Fn::If:\n"], [870, "          - HasGuardrailConfig\n"], [871, "          - Effect: Allow\n"], [872, "            Action: bedrock:ApplyGuardrail\n"], [873, "            Resource:\n"], [874, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [875, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [787, 875], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[787, "  SummarizationFunction:\n"], [788, "    Type: AWS::Serverless::Function\n"], [789, "    Metadata:\n"], [790, "      SamResourceId: SummarizationFunction\n"], [791, "      cfn_nag:\n"], [792, "        rules_to_suppress:\n"], [793, "        - id: W11\n"], [794, "          reason: Cloudwatch does not support resource-level permissions\n"], [795, "        - id: W89\n"], [796, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [797, "            with AWS services via AWS APIs\n"], [798, "        - id: W92\n"], [799, "          reason: Function does not require concurrent execution limits as it is designed\n"], [800, "            to scale based on demand\n"], [801, "    Properties:\n"], [802, "      PermissionsBoundary:\n"], [803, "        Fn::If:\n"], [804, "        - HasPermissionsBoundary\n"], [805, "        - Ref: PermissionsBoundaryArn\n"], [806, "        - Ref: AWS::NoValue\n"], [807, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/50c53f41fb63c075fb08bc37796bb3f7\n"], [808, "      Handler: index.handler\n"], [809, "      Runtime: python3.12\n"], [810, "      Timeout: 900\n"], [811, "      MemorySize: 4096\n"], [812, "      Environment:\n"], [813, "        Variables:\n"], [814, "          METRIC_NAMESPACE:\n"], [815, "            Ref: StackName\n"], [816, "          CONFIGURATION_TABLE_NAME:\n"], [817, "            Ref: ConfigurationTable\n"], [818, "          GUARDRAIL_ID_AND_VERSION:\n"], [819, "            Fn::If:\n"], [820, "            - HasGuardrailConfig\n"], [821, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [822, "            - ''\n"], [823, "          LOG_LEVEL:\n"], [824, "            Ref: LogLevel\n"], [825, "          APPSYNC_API_URL:\n"], [826, "            Ref: AppSyncApiUrl\n"], [827, "          WORKING_BUCKET:\n"], [828, "            Ref: WorkingBucket\n"], [829, "      LoggingConfig:\n"], [830, "        LogGroup:\n"], [831, "          Ref: SummarizationFunctionLogGroup\n"], [832, "      Policies:\n"], [833, "      - AWSLambdaBasicExecutionRole\n"], [834, "      - S3ReadPolicy:\n"], [835, "          BucketName:\n"], [836, "            Ref: InputBucket\n"], [837, "      - S3CrudPolicy:\n"], [838, "          BucketName:\n"], [839, "            Ref: OutputBucket\n"], [840, "      - S3CrudPolicy:\n"], [841, "          BucketName:\n"], [842, "            Ref: WorkingBucket\n"], [843, "      - DynamoDBCrudPolicy:\n"], [844, "          TableName:\n"], [845, "            Ref: ConfigurationTable\n"], [846, "      - Statement:\n"], [847, "        - Effect: Allow\n"], [848, "          Action: cloudwatch:PutMetricData\n"], [849, "          Resource: '*'\n"], [850, "        - Effect: Allow\n"], [851, "          Action:\n"], [852, "          - kms:Encrypt\n"], [853, "          - kms:Decrypt\n"], [854, "          - kms:ReEncrypt*\n"], [855, "          - kms:GenerateDataKey*\n"], [856, "          - kms:DescribeKey\n"], [857, "          Resource:\n"], [858, "            Ref: CustomerManagedEncryptionKeyArn\n"], [859, "        - Effect: Allow\n"], [860, "          Action:\n"], [861, "          - appsync:GraphQL\n"], [862, "          Resource:\n"], [863, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [864, "        - Effect: Allow\n"], [865, "          Action: bedrock:InvokeModel\n"], [866, "          Resource:\n"], [867, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [868, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [869, "        - Fn::If:\n"], [870, "          - HasGuardrailConfig\n"], [871, "          - Effect: Allow\n"], [872, "            Action: bedrock:ApplyGuardrail\n"], [873, "            Resource:\n"], [874, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [875, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [787, 875], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[787, "  SummarizationFunction:\n"], [788, "    Type: AWS::Serverless::Function\n"], [789, "    Metadata:\n"], [790, "      SamResourceId: SummarizationFunction\n"], [791, "      cfn_nag:\n"], [792, "        rules_to_suppress:\n"], [793, "        - id: W11\n"], [794, "          reason: Cloudwatch does not support resource-level permissions\n"], [795, "        - id: W89\n"], [796, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [797, "            with AWS services via AWS APIs\n"], [798, "        - id: W92\n"], [799, "          reason: Function does not require concurrent execution limits as it is designed\n"], [800, "            to scale based on demand\n"], [801, "    Properties:\n"], [802, "      PermissionsBoundary:\n"], [803, "        Fn::If:\n"], [804, "        - HasPermissionsBoundary\n"], [805, "        - Ref: PermissionsBoundaryArn\n"], [806, "        - Ref: AWS::NoValue\n"], [807, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/50c53f41fb63c075fb08bc37796bb3f7\n"], [808, "      Handler: index.handler\n"], [809, "      Runtime: python3.12\n"], [810, "      Timeout: 900\n"], [811, "      MemorySize: 4096\n"], [812, "      Environment:\n"], [813, "        Variables:\n"], [814, "          METRIC_NAMESPACE:\n"], [815, "            Ref: StackName\n"], [816, "          CONFIGURATION_TABLE_NAME:\n"], [817, "            Ref: ConfigurationTable\n"], [818, "          GUARDRAIL_ID_AND_VERSION:\n"], [819, "            Fn::If:\n"], [820, "            - HasGuardrailConfig\n"], [821, "            - Fn::Sub: ${BedrockGuardrailId}:${BedrockGuardrailVersion}\n"], [822, "            - ''\n"], [823, "          LOG_LEVEL:\n"], [824, "            Ref: LogLevel\n"], [825, "          APPSYNC_API_URL:\n"], [826, "            Ref: AppSyncApiUrl\n"], [827, "          WORKING_BUCKET:\n"], [828, "            Ref: WorkingBucket\n"], [829, "      LoggingConfig:\n"], [830, "        LogGroup:\n"], [831, "          Ref: SummarizationFunctionLogGroup\n"], [832, "      Policies:\n"], [833, "      - AWSLambdaBasicExecutionRole\n"], [834, "      - S3ReadPolicy:\n"], [835, "          BucketName:\n"], [836, "            Ref: InputBucket\n"], [837, "      - S3CrudPolicy:\n"], [838, "          BucketName:\n"], [839, "            Ref: OutputBucket\n"], [840, "      - S3CrudPolicy:\n"], [841, "          BucketName:\n"], [842, "            Ref: WorkingBucket\n"], [843, "      - DynamoDBCrudPolicy:\n"], [844, "          TableName:\n"], [845, "            Ref: ConfigurationTable\n"], [846, "      - Statement:\n"], [847, "        - Effect: Allow\n"], [848, "          Action: cloudwatch:PutMetricData\n"], [849, "          Resource: '*'\n"], [850, "        - Effect: Allow\n"], [851, "          Action:\n"], [852, "          - kms:Encrypt\n"], [853, "          - kms:Decrypt\n"], [854, "          - kms:ReEncrypt*\n"], [855, "          - kms:GenerateDataKey*\n"], [856, "          - kms:DescribeKey\n"], [857, "          Resource:\n"], [858, "            Ref: CustomerManagedEncryptionKeyArn\n"], [859, "        - Effect: Allow\n"], [860, "          Action:\n"], [861, "          - appsync:GraphQL\n"], [862, "          Resource:\n"], [863, "          - Fn::Sub: ${AppSyncApiArn}/types/Mutation/*\n"], [864, "        - Effect: Allow\n"], [865, "          Action: bedrock:InvokeModel\n"], [866, "          Resource:\n"], [867, "          - Fn::Sub: arn:aws:bedrock:*::foundation-model/*\n"], [868, "          - Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:inference-profile/*\n"], [869, "        - Fn::If:\n"], [870, "          - HasGuardrailConfig\n"], [871, "          - Effect: Allow\n"], [872, "            Action: bedrock:ApplyGuardrail\n"], [873, "            Resource:\n"], [874, "              Fn::Sub: arn:aws:bedrock:${AWS::Region}:${AWS::AccountId}:guardrail/${BedrockGuardrailId}\n"], [875, "          - Ref: AWS::NoValue\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [787, 875], "resource": "AWS::Serverless::Function.SummarizationFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[896, "  BDACompletionFunction:\n"], [897, "    Type: AWS::Serverless::Function\n"], [898, "    Metadata:\n"], [899, "      SamResourceId: BDACompletionFunction\n"], [900, "      cfn_nag:\n"], [901, "        rules_to_suppress:\n"], [902, "        - id: W11\n"], [903, "          reason: Cloudwatch does not support resource-level permissions\n"], [904, "        - id: W89\n"], [905, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [906, "            with AWS services via AWS APIs\n"], [907, "        - id: W92\n"], [908, "          reason: Function does not require concurrent execution limits as it is designed\n"], [909, "            to scale based on demand\n"], [910, "    Properties:\n"], [911, "      PermissionsBoundary:\n"], [912, "        Fn::If:\n"], [913, "        - HasPermissionsBoundary\n"], [914, "        - Ref: PermissionsBoundaryArn\n"], [915, "        - Ref: AWS::NoValue\n"], [916, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/67a284325ee07451c19ed8f4574ebcdd\n"], [917, "      Handler: index.handler\n"], [918, "      Runtime: python3.12\n"], [919, "      Timeout: 900\n"], [920, "      MemorySize: 4096\n"], [921, "      Environment:\n"], [922, "        Variables:\n"], [923, "          TRACKING_TABLE:\n"], [924, "            Ref: TrackingTable\n"], [925, "          METRIC_NAMESPACE:\n"], [926, "            Ref: StackName\n"], [927, "          LOG_LEVEL:\n"], [928, "            Ref: LogLevel\n"], [929, "      DeadLetterQueue:\n"], [930, "        Type: SQS\n"], [931, "        TargetArn:\n"], [932, "          Fn::GetAtt:\n"], [933, "          - BDACompletionFunctionDLQ\n"], [934, "          - Arn\n"], [935, "      LoggingConfig:\n"], [936, "        LogGroup:\n"], [937, "          Ref: BDACompletionFunctionLogGroup\n"], [938, "      Policies:\n"], [939, "      - AWSLambdaBasicExecutionRole\n"], [940, "      - DynamoDBReadPolicy:\n"], [941, "          TableName:\n"], [942, "            Ref: TrackingTable\n"], [943, "      - Statement:\n"], [944, "        - Effect: Allow\n"], [945, "          Action: cloudwatch:PutMetricData\n"], [946, "          Resource: '*'\n"], [947, "        - Effect: Allow\n"], [948, "          Action:\n"], [949, "          - states:SendTaskSuccess\n"], [950, "          - states:SendTaskFailure\n"], [951, "          Resource:\n"], [952, "            Fn::GetAtt:\n"], [953, "            - DocumentProcessingStateMachine\n"], [954, "            - Arn\n"], [955, "        - Effect: Allow\n"], [956, "          Action:\n"], [957, "          - kms:Encrypt\n"], [958, "          - kms:Decrypt\n"], [959, "          - kms:ReEncrypt*\n"], [960, "          - kms:GenerateDataKey*\n"], [961, "          - kms:DescribeKey\n"], [962, "          Resource:\n"], [963, "            Ref: CustomerManagedEncryptionKeyArn\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [896, 963], "resource": "AWS::Serverless::Function.BDACompletionFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[896, "  BDACompletionFunction:\n"], [897, "    Type: AWS::Serverless::Function\n"], [898, "    Metadata:\n"], [899, "      SamResourceId: BDACompletionFunction\n"], [900, "      cfn_nag:\n"], [901, "        rules_to_suppress:\n"], [902, "        - id: W11\n"], [903, "          reason: Cloudwatch does not support resource-level permissions\n"], [904, "        - id: W89\n"], [905, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [906, "            with AWS services via AWS APIs\n"], [907, "        - id: W92\n"], [908, "          reason: Function does not require concurrent execution limits as it is designed\n"], [909, "            to scale based on demand\n"], [910, "    Properties:\n"], [911, "      PermissionsBoundary:\n"], [912, "        Fn::If:\n"], [913, "        - HasPermissionsBoundary\n"], [914, "        - Ref: PermissionsBoundaryArn\n"], [915, "        - Ref: AWS::NoValue\n"], [916, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/67a284325ee07451c19ed8f4574ebcdd\n"], [917, "      Handler: index.handler\n"], [918, "      Runtime: python3.12\n"], [919, "      Timeout: 900\n"], [920, "      MemorySize: 4096\n"], [921, "      Environment:\n"], [922, "        Variables:\n"], [923, "          TRACKING_TABLE:\n"], [924, "            Ref: TrackingTable\n"], [925, "          METRIC_NAMESPACE:\n"], [926, "            Ref: StackName\n"], [927, "          LOG_LEVEL:\n"], [928, "            Ref: LogLevel\n"], [929, "      DeadLetterQueue:\n"], [930, "        Type: SQS\n"], [931, "        TargetArn:\n"], [932, "          Fn::GetAtt:\n"], [933, "          - BDACompletionFunctionDLQ\n"], [934, "          - Arn\n"], [935, "      LoggingConfig:\n"], [936, "        LogGroup:\n"], [937, "          Ref: BDACompletionFunctionLogGroup\n"], [938, "      Policies:\n"], [939, "      - AWSLambdaBasicExecutionRole\n"], [940, "      - DynamoDBReadPolicy:\n"], [941, "          TableName:\n"], [942, "            Ref: TrackingTable\n"], [943, "      - Statement:\n"], [944, "        - Effect: Allow\n"], [945, "          Action: cloudwatch:PutMetricData\n"], [946, "          Resource: '*'\n"], [947, "        - Effect: Allow\n"], [948, "          Action:\n"], [949, "          - states:SendTaskSuccess\n"], [950, "          - states:SendTaskFailure\n"], [951, "          Resource:\n"], [952, "            Fn::GetAtt:\n"], [953, "            - DocumentProcessingStateMachine\n"], [954, "            - Arn\n"], [955, "        - Effect: Allow\n"], [956, "          Action:\n"], [957, "          - kms:Encrypt\n"], [958, "          - kms:Decrypt\n"], [959, "          - kms:ReEncrypt*\n"], [960, "          - kms:GenerateDataKey*\n"], [961, "          - kms:DescribeKey\n"], [962, "          Resource:\n"], [963, "            Ref: CustomerManagedEncryptionKeyArn\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [896, 963], "resource": "AWS::Serverless::Function.BDACompletionFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[896, "  BDACompletionFunction:\n"], [897, "    Type: AWS::Serverless::Function\n"], [898, "    Metadata:\n"], [899, "      SamResourceId: BDACompletionFunction\n"], [900, "      cfn_nag:\n"], [901, "        rules_to_suppress:\n"], [902, "        - id: W11\n"], [903, "          reason: Cloudwatch does not support resource-level permissions\n"], [904, "        - id: W89\n"], [905, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [906, "            with AWS services via AWS APIs\n"], [907, "        - id: W92\n"], [908, "          reason: Function does not require concurrent execution limits as it is designed\n"], [909, "            to scale based on demand\n"], [910, "    Properties:\n"], [911, "      PermissionsBoundary:\n"], [912, "        Fn::If:\n"], [913, "        - HasPermissionsBoundary\n"], [914, "        - Ref: PermissionsBoundaryArn\n"], [915, "        - Ref: AWS::NoValue\n"], [916, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/67a284325ee07451c19ed8f4574ebcdd\n"], [917, "      Handler: index.handler\n"], [918, "      Runtime: python3.12\n"], [919, "      Timeout: 900\n"], [920, "      MemorySize: 4096\n"], [921, "      Environment:\n"], [922, "        Variables:\n"], [923, "          TRACKING_TABLE:\n"], [924, "            Ref: TrackingTable\n"], [925, "          METRIC_NAMESPACE:\n"], [926, "            Ref: StackName\n"], [927, "          LOG_LEVEL:\n"], [928, "            Ref: LogLevel\n"], [929, "      DeadLetterQueue:\n"], [930, "        Type: SQS\n"], [931, "        TargetArn:\n"], [932, "          Fn::GetAtt:\n"], [933, "          - BDACompletionFunctionDLQ\n"], [934, "          - Arn\n"], [935, "      LoggingConfig:\n"], [936, "        LogGroup:\n"], [937, "          Ref: BDACompletionFunctionLogGroup\n"], [938, "      Policies:\n"], [939, "      - AWSLambdaBasicExecutionRole\n"], [940, "      - DynamoDBReadPolicy:\n"], [941, "          TableName:\n"], [942, "            Ref: TrackingTable\n"], [943, "      - Statement:\n"], [944, "        - Effect: Allow\n"], [945, "          Action: cloudwatch:PutMetricData\n"], [946, "          Resource: '*'\n"], [947, "        - Effect: Allow\n"], [948, "          Action:\n"], [949, "          - states:SendTaskSuccess\n"], [950, "          - states:SendTaskFailure\n"], [951, "          Resource:\n"], [952, "            Fn::GetAtt:\n"], [953, "            - DocumentProcessingStateMachine\n"], [954, "            - Arn\n"], [955, "        - Effect: Allow\n"], [956, "          Action:\n"], [957, "          - kms:Encrypt\n"], [958, "          - kms:Decrypt\n"], [959, "          - kms:ReEncrypt*\n"], [960, "          - kms:GenerateDataKey*\n"], [961, "          - kms:DescribeKey\n"], [962, "          Resource:\n"], [963, "            Ref: CustomerManagedEncryptionKeyArn\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [896, 963], "resource": "AWS::Serverless::Function.BDACompletionFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[1067, "  HITLProcessLambdaFunction:\n"], [1068, "    Type: AWS::Serverless::Function\n"], [1069, "    Metadata:\n"], [1070, "      SamResourceId: HITLProcessLambdaFunction\n"], [1071, "      cfn_nag:\n"], [1072, "        rules_to_suppress:\n"], [1073, "        - id: W89\n"], [1074, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [1075, "            services via APIs\n"], [1076, "        - id: W92\n"], [1077, "          reason: Function does not require reserved concurrency as it scales based\n"], [1078, "            on demand\n"], [1079, "    Properties:\n"], [1080, "      PermissionsBoundary:\n"], [1081, "        Fn::If:\n"], [1082, "        - HasPermissionsBoundary\n"], [1083, "        - Ref: PermissionsBoundaryArn\n"], [1084, "        - Ref: AWS::NoValue\n"], [1085, "      Handler: index.lambda_handler\n"], [1086, "      LoggingConfig:\n"], [1087, "        LogGroup:\n"], [1088, "          Ref: HITLProcessLambdaLogGroup\n"], [1089, "      Runtime: python3.12\n"], [1090, "      Timeout: 300\n"], [1091, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/a2fbf6d1b46c0834140d611a9bbcffd4\n"], [1092, "      Role:\n"], [1093, "        Fn::GetAtt:\n"], [1094, "        - HITLProcessLambdaRole\n"], [1095, "        - Arn\n"], [1096, "      Environment:\n"], [1097, "        Variables:\n"], [1098, "          DYNAMODB_TABLE:\n"], [1099, "            Ref: BDAMetadataTable\n"], [1100, "          TRACKING_TABLE:\n"], [1101, "            Ref: TrackingTable\n"], [1102, "          LOG_LEVEL:\n"], [1103, "            Ref: LogLevel\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1067, 1103], "resource": "AWS::Serverless::Function.HITLProcessLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[1067, "  HITLProcessLambdaFunction:\n"], [1068, "    Type: AWS::Serverless::Function\n"], [1069, "    Metadata:\n"], [1070, "      SamResourceId: HITLProcessLambdaFunction\n"], [1071, "      cfn_nag:\n"], [1072, "        rules_to_suppress:\n"], [1073, "        - id: W89\n"], [1074, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [1075, "            services via APIs\n"], [1076, "        - id: W92\n"], [1077, "          reason: Function does not require reserved concurrency as it scales based\n"], [1078, "            on demand\n"], [1079, "    Properties:\n"], [1080, "      PermissionsBoundary:\n"], [1081, "        Fn::If:\n"], [1082, "        - HasPermissionsBoundary\n"], [1083, "        - Ref: PermissionsBoundaryArn\n"], [1084, "        - Ref: AWS::NoValue\n"], [1085, "      Handler: index.lambda_handler\n"], [1086, "      LoggingConfig:\n"], [1087, "        LogGroup:\n"], [1088, "          Ref: HITLProcessLambdaLogGroup\n"], [1089, "      Runtime: python3.12\n"], [1090, "      Timeout: 300\n"], [1091, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/a2fbf6d1b46c0834140d611a9bbcffd4\n"], [1092, "      Role:\n"], [1093, "        Fn::GetAtt:\n"], [1094, "        - HITLProcessLambdaRole\n"], [1095, "        - Arn\n"], [1096, "      Environment:\n"], [1097, "        Variables:\n"], [1098, "          DYNAMODB_TABLE:\n"], [1099, "            Ref: BDAMetadataTable\n"], [1100, "          TRACKING_TABLE:\n"], [1101, "            Ref: TrackingTable\n"], [1102, "          LOG_LEVEL:\n"], [1103, "            Ref: LogLevel\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1067, 1103], "resource": "AWS::Serverless::Function.HITLProcessLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[1067, "  HITLProcessLambdaFunction:\n"], [1068, "    Type: AWS::Serverless::Function\n"], [1069, "    Metadata:\n"], [1070, "      SamResourceId: HITLProcessLambdaFunction\n"], [1071, "      cfn_nag:\n"], [1072, "        rules_to_suppress:\n"], [1073, "        - id: W89\n"], [1074, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [1075, "            services via APIs\n"], [1076, "        - id: W92\n"], [1077, "          reason: Function does not require reserved concurrency as it scales based\n"], [1078, "            on demand\n"], [1079, "    Properties:\n"], [1080, "      PermissionsBoundary:\n"], [1081, "        Fn::If:\n"], [1082, "        - HasPermissionsBoundary\n"], [1083, "        - Ref: PermissionsBoundaryArn\n"], [1084, "        - Ref: AWS::NoValue\n"], [1085, "      Handler: index.lambda_handler\n"], [1086, "      LoggingConfig:\n"], [1087, "        LogGroup:\n"], [1088, "          Ref: HITLProcessLambdaLogGroup\n"], [1089, "      Runtime: python3.12\n"], [1090, "      Timeout: 300\n"], [1091, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/a2fbf6d1b46c0834140d611a9bbcffd4\n"], [1092, "      Role:\n"], [1093, "        Fn::GetAtt:\n"], [1094, "        - HITLProcessLambdaRole\n"], [1095, "        - Arn\n"], [1096, "      Environment:\n"], [1097, "        Variables:\n"], [1098, "          DYNAMODB_TABLE:\n"], [1099, "            Ref: BDAMetadataTable\n"], [1100, "          TRACKING_TABLE:\n"], [1101, "            Ref: TrackingTable\n"], [1102, "          LOG_LEVEL:\n"], [1103, "            Ref: LogLevel\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1067, 1103], "resource": "AWS::Serverless::Function.HITLProcessLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[1067, "  HITLProcessLambdaFunction:\n"], [1068, "    Type: AWS::Serverless::Function\n"], [1069, "    Metadata:\n"], [1070, "      SamResourceId: HITLProcessLambdaFunction\n"], [1071, "      cfn_nag:\n"], [1072, "        rules_to_suppress:\n"], [1073, "        - id: W89\n"], [1074, "          reason: Function does not require VPC access as it only interacts with AWS\n"], [1075, "            services via APIs\n"], [1076, "        - id: W92\n"], [1077, "          reason: Function does not require reserved concurrency as it scales based\n"], [1078, "            on demand\n"], [1079, "    Properties:\n"], [1080, "      PermissionsBoundary:\n"], [1081, "        Fn::If:\n"], [1082, "        - HasPermissionsBoundary\n"], [1083, "        - Ref: PermissionsBoundaryArn\n"], [1084, "        - Ref: AWS::NoValue\n"], [1085, "      Handler: index.lambda_handler\n"], [1086, "      LoggingConfig:\n"], [1087, "        LogGroup:\n"], [1088, "          Ref: HITLProcessLambdaLogGroup\n"], [1089, "      Runtime: python3.12\n"], [1090, "      Timeout: 300\n"], [1091, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/a2fbf6d1b46c0834140d611a9bbcffd4\n"], [1092, "      Role:\n"], [1093, "        Fn::GetAtt:\n"], [1094, "        - HITLProcessLambdaRole\n"], [1095, "        - Arn\n"], [1096, "      Environment:\n"], [1097, "        Variables:\n"], [1098, "          DYNAMODB_TABLE:\n"], [1099, "            Ref: BDAMetadataTable\n"], [1100, "          TRACKING_TABLE:\n"], [1101, "            Ref: TrackingTable\n"], [1102, "          LOG_LEVEL:\n"], [1103, "            Ref: LogLevel\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1067, 1103], "resource": "AWS::Serverless::Function.HITLProcessLambdaFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[1185, "  HITLWaitFunction:\n"], [1186, "    Type: AWS::Serverless::Function\n"], [1187, "    Metadata:\n"], [1188, "      SamResourceId: HITLWaitFunction\n"], [1189, "      cfn_nag:\n"], [1190, "        rules_to_suppress:\n"], [1191, "        - id: W11\n"], [1192, "          reason: Cloudwatch does not support resource-level permissions\n"], [1193, "        - id: W89\n"], [1194, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1195, "            with AWS services via AWS APIs\n"], [1196, "        - id: W92\n"], [1197, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1198, "            to scale based on demand\n"], [1199, "    Properties:\n"], [1200, "      PermissionsBoundary:\n"], [1201, "        Fn::If:\n"], [1202, "        - HasPermissionsBoundary\n"], [1203, "        - Ref: PermissionsBoundaryArn\n"], [1204, "        - Ref: AWS::NoValue\n"], [1205, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/daa76bb6a17d2c2a31b7000fa114fe42\n"], [1206, "      Handler: index.lambda_handler\n"], [1207, "      Runtime: python3.12\n"], [1208, "      Timeout: 60\n"], [1209, "      MemorySize: 256\n"], [1210, "      Environment:\n"], [1211, "        Variables:\n"], [1212, "          TRACKING_TABLE:\n"], [1213, "            Ref: TrackingTable\n"], [1214, "          DYNAMODB_TABLE:\n"], [1215, "            Ref: BDAMetadataTable\n"], [1216, "          LOG_LEVEL:\n"], [1217, "            Ref: LogLevel\n"], [1218, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [1219, "            Ref: SageMakerA2IReviewPortalURL\n"], [1220, "          WORKING_BUCKET:\n"], [1221, "            Ref: WorkingBucket\n"], [1222, "      LoggingConfig:\n"], [1223, "        LogGroup:\n"], [1224, "          Ref: HITLWaitFunctionLogGroup\n"], [1225, "      Policies:\n"], [1226, "      - AWSLambdaBasicExecutionRole\n"], [1227, "      - DynamoDBCrudPolicy:\n"], [1228, "          TableName:\n"], [1229, "            Ref: TrackingTable\n"], [1230, "      - DynamoDBCrudPolicy:\n"], [1231, "          TableName:\n"], [1232, "            Ref: BDAMetadataTable\n"], [1233, "      - S3ReadPolicy:\n"], [1234, "          BucketName:\n"], [1235, "            Ref: WorkingBucket\n"], [1236, "      - Statement:\n"], [1237, "        - Effect: Allow\n"], [1238, "          Action:\n"], [1239, "          - kms:Decrypt\n"], [1240, "          Resource:\n"], [1241, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1242, "        - Effect: Allow\n"], [1243, "          Action: cloudwatch:PutMetricData\n"], [1244, "          Resource: '*'\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1185, 1244], "resource": "AWS::Serverless::Function.HITLWaitFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[1185, "  HITLWaitFunction:\n"], [1186, "    Type: AWS::Serverless::Function\n"], [1187, "    Metadata:\n"], [1188, "      SamResourceId: HITLWaitFunction\n"], [1189, "      cfn_nag:\n"], [1190, "        rules_to_suppress:\n"], [1191, "        - id: W11\n"], [1192, "          reason: Cloudwatch does not support resource-level permissions\n"], [1193, "        - id: W89\n"], [1194, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1195, "            with AWS services via AWS APIs\n"], [1196, "        - id: W92\n"], [1197, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1198, "            to scale based on demand\n"], [1199, "    Properties:\n"], [1200, "      PermissionsBoundary:\n"], [1201, "        Fn::If:\n"], [1202, "        - HasPermissionsBoundary\n"], [1203, "        - Ref: PermissionsBoundaryArn\n"], [1204, "        - Ref: AWS::NoValue\n"], [1205, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/daa76bb6a17d2c2a31b7000fa114fe42\n"], [1206, "      Handler: index.lambda_handler\n"], [1207, "      Runtime: python3.12\n"], [1208, "      Timeout: 60\n"], [1209, "      MemorySize: 256\n"], [1210, "      Environment:\n"], [1211, "        Variables:\n"], [1212, "          TRACKING_TABLE:\n"], [1213, "            Ref: TrackingTable\n"], [1214, "          DYNAMODB_TABLE:\n"], [1215, "            Ref: BDAMetadataTable\n"], [1216, "          LOG_LEVEL:\n"], [1217, "            Ref: LogLevel\n"], [1218, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [1219, "            Ref: SageMakerA2IReviewPortalURL\n"], [1220, "          WORKING_BUCKET:\n"], [1221, "            Ref: WorkingBucket\n"], [1222, "      LoggingConfig:\n"], [1223, "        LogGroup:\n"], [1224, "          Ref: HITLWaitFunctionLogGroup\n"], [1225, "      Policies:\n"], [1226, "      - AWSLambdaBasicExecutionRole\n"], [1227, "      - DynamoDBCrudPolicy:\n"], [1228, "          TableName:\n"], [1229, "            Ref: TrackingTable\n"], [1230, "      - DynamoDBCrudPolicy:\n"], [1231, "          TableName:\n"], [1232, "            Ref: BDAMetadataTable\n"], [1233, "      - S3ReadPolicy:\n"], [1234, "          BucketName:\n"], [1235, "            Ref: WorkingBucket\n"], [1236, "      - Statement:\n"], [1237, "        - Effect: Allow\n"], [1238, "          Action:\n"], [1239, "          - kms:Decrypt\n"], [1240, "          Resource:\n"], [1241, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1242, "        - Effect: Allow\n"], [1243, "          Action: cloudwatch:PutMetricData\n"], [1244, "          Resource: '*'\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1185, 1244], "resource": "AWS::Serverless::Function.HITLWaitFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[1185, "  HITLWaitFunction:\n"], [1186, "    Type: AWS::Serverless::Function\n"], [1187, "    Metadata:\n"], [1188, "      SamResourceId: HITLWaitFunction\n"], [1189, "      cfn_nag:\n"], [1190, "        rules_to_suppress:\n"], [1191, "        - id: W11\n"], [1192, "          reason: Cloudwatch does not support resource-level permissions\n"], [1193, "        - id: W89\n"], [1194, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1195, "            with AWS services via AWS APIs\n"], [1196, "        - id: W92\n"], [1197, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1198, "            to scale based on demand\n"], [1199, "    Properties:\n"], [1200, "      PermissionsBoundary:\n"], [1201, "        Fn::If:\n"], [1202, "        - HasPermissionsBoundary\n"], [1203, "        - Ref: PermissionsBoundaryArn\n"], [1204, "        - Ref: AWS::NoValue\n"], [1205, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/daa76bb6a17d2c2a31b7000fa114fe42\n"], [1206, "      Handler: index.lambda_handler\n"], [1207, "      Runtime: python3.12\n"], [1208, "      Timeout: 60\n"], [1209, "      MemorySize: 256\n"], [1210, "      Environment:\n"], [1211, "        Variables:\n"], [1212, "          TRACKING_TABLE:\n"], [1213, "            Ref: TrackingTable\n"], [1214, "          DYNAMODB_TABLE:\n"], [1215, "            Ref: BDAMetadataTable\n"], [1216, "          LOG_LEVEL:\n"], [1217, "            Ref: LogLevel\n"], [1218, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [1219, "            Ref: SageMakerA2IReviewPortalURL\n"], [1220, "          WORKING_BUCKET:\n"], [1221, "            Ref: WorkingBucket\n"], [1222, "      LoggingConfig:\n"], [1223, "        LogGroup:\n"], [1224, "          Ref: HITLWaitFunctionLogGroup\n"], [1225, "      Policies:\n"], [1226, "      - AWSLambdaBasicExecutionRole\n"], [1227, "      - DynamoDBCrudPolicy:\n"], [1228, "          TableName:\n"], [1229, "            Ref: TrackingTable\n"], [1230, "      - DynamoDBCrudPolicy:\n"], [1231, "          TableName:\n"], [1232, "            Ref: BDAMetadataTable\n"], [1233, "      - S3ReadPolicy:\n"], [1234, "          BucketName:\n"], [1235, "            Ref: WorkingBucket\n"], [1236, "      - Statement:\n"], [1237, "        - Effect: Allow\n"], [1238, "          Action:\n"], [1239, "          - kms:Decrypt\n"], [1240, "          Resource:\n"], [1241, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1242, "        - Effect: Allow\n"], [1243, "          Action: cloudwatch:PutMetricData\n"], [1244, "          Resource: '*'\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1185, 1244], "resource": "AWS::Serverless::Function.HITLWaitFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[1185, "  HITLWaitFunction:\n"], [1186, "    Type: AWS::Serverless::Function\n"], [1187, "    Metadata:\n"], [1188, "      SamResourceId: HITLWaitFunction\n"], [1189, "      cfn_nag:\n"], [1190, "        rules_to_suppress:\n"], [1191, "        - id: W11\n"], [1192, "          reason: Cloudwatch does not support resource-level permissions\n"], [1193, "        - id: W89\n"], [1194, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1195, "            with AWS services via AWS APIs\n"], [1196, "        - id: W92\n"], [1197, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1198, "            to scale based on demand\n"], [1199, "    Properties:\n"], [1200, "      PermissionsBoundary:\n"], [1201, "        Fn::If:\n"], [1202, "        - HasPermissionsBoundary\n"], [1203, "        - Ref: PermissionsBoundaryArn\n"], [1204, "        - Ref: AWS::NoValue\n"], [1205, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/daa76bb6a17d2c2a31b7000fa114fe42\n"], [1206, "      Handler: index.lambda_handler\n"], [1207, "      Runtime: python3.12\n"], [1208, "      Timeout: 60\n"], [1209, "      MemorySize: 256\n"], [1210, "      Environment:\n"], [1211, "        Variables:\n"], [1212, "          TRACKING_TABLE:\n"], [1213, "            Ref: TrackingTable\n"], [1214, "          DYNAMODB_TABLE:\n"], [1215, "            Ref: BDAMetadataTable\n"], [1216, "          LOG_LEVEL:\n"], [1217, "            Ref: LogLevel\n"], [1218, "          SAGEMAKER_A2I_REVIEW_PORTAL_URL:\n"], [1219, "            Ref: SageMakerA2IReviewPortalURL\n"], [1220, "          WORKING_BUCKET:\n"], [1221, "            Ref: WorkingBucket\n"], [1222, "      LoggingConfig:\n"], [1223, "        LogGroup:\n"], [1224, "          Ref: HITLWaitFunctionLogGroup\n"], [1225, "      Policies:\n"], [1226, "      - AWSLambdaBasicExecutionRole\n"], [1227, "      - DynamoDBCrudPolicy:\n"], [1228, "          TableName:\n"], [1229, "            Ref: TrackingTable\n"], [1230, "      - DynamoDBCrudPolicy:\n"], [1231, "          TableName:\n"], [1232, "            Ref: BDAMetadataTable\n"], [1233, "      - S3ReadPolicy:\n"], [1234, "          BucketName:\n"], [1235, "            Ref: WorkingBucket\n"], [1236, "      - Statement:\n"], [1237, "        - Effect: Allow\n"], [1238, "          Action:\n"], [1239, "          - kms:Decrypt\n"], [1240, "          Resource:\n"], [1241, "            Ref: CustomerManagedEncryptionKeyArn\n"], [1242, "        - Effect: Allow\n"], [1243, "          Action: cloudwatch:PutMetricData\n"], [1244, "          Resource: '*'\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1185, 1244], "resource": "AWS::Serverless::Function.HITLWaitFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/DeadLetterQueue/TargetArn"]}, "code_block": [[1256, "  HITLStatusUpdateFunction:\n"], [1257, "    Type: AWS::Serverless::Function\n"], [1258, "    Metadata:\n"], [1259, "      SamResourceId: HITLStatusUpdateFunction\n"], [1260, "      cfn_nag:\n"], [1261, "        rules_to_suppress:\n"], [1262, "        - id: W11\n"], [1263, "          reason: Cloudwatch does not support resource-level permissions\n"], [1264, "        - id: W89\n"], [1265, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1266, "            with AWS services via AWS APIs\n"], [1267, "        - id: W92\n"], [1268, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1269, "            to scale based on demand\n"], [1270, "        - id: W58\n"], [1271, "          reason: DLQ not required for EventBridge triggered function as it handles\n"], [1272, "            A2I status updates\n"], [1273, "    Properties:\n"], [1274, "      PermissionsBoundary:\n"], [1275, "        Fn::If:\n"], [1276, "        - HasPermissionsBoundary\n"], [1277, "        - Ref: PermissionsBoundaryArn\n"], [1278, "        - Ref: AWS::NoValue\n"], [1279, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/2a1a88839f42882f1642d6ef99f5e1b5\n"], [1280, "      Handler: index.handler\n"], [1281, "      Runtime: python3.12\n"], [1282, "      Timeout: 300\n"], [1283, "      MemorySize: 512\n"], [1284, "      Environment:\n"], [1285, "        Variables:\n"], [1286, "          LOG_LEVEL:\n"], [1287, "            Ref: LogLevel\n"], [1288, "          WORKING_BUCKET:\n"], [1289, "            Ref: WorkingBucket\n"], [1290, "      LoggingConfig:\n"], [1291, "        LogGroup:\n"], [1292, "          Ref: HITLStatusUpdateFunctionLogGroup\n"], [1293, "      Policies:\n"], [1294, "      - AWSLambdaBasicExecutionRole\n"], [1295, "      - S3CrudPolicy:\n"], [1296, "          BucketName:\n"], [1297, "            Ref: WorkingBucket\n"], [1298, "      - Statement:\n"], [1299, "        - Effect: Allow\n"], [1300, "          Action:\n"], [1301, "          - kms:Encrypt\n"], [1302, "          - kms:Decrypt\n"], [1303, "          - kms:ReEncrypt*\n"], [1304, "          - kms:GenerateDataKey*\n"], [1305, "          - kms:DescribeKey\n"], [1306, "          Resource:\n"], [1307, "            Ref: CustomerManagedEncryptionKeyArn\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1256, 1307], "resource": "AWS::Serverless::Function.HITLStatusUpdateFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environment variable", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[1256, "  HITLStatusUpdateFunction:\n"], [1257, "    Type: AWS::Serverless::Function\n"], [1258, "    Metadata:\n"], [1259, "      SamResourceId: HITLStatusUpdateFunction\n"], [1260, "      cfn_nag:\n"], [1261, "        rules_to_suppress:\n"], [1262, "        - id: W11\n"], [1263, "          reason: Cloudwatch does not support resource-level permissions\n"], [1264, "        - id: W89\n"], [1265, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1266, "            with AWS services via AWS APIs\n"], [1267, "        - id: W92\n"], [1268, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1269, "            to scale based on demand\n"], [1270, "        - id: W58\n"], [1271, "          reason: DLQ not required for EventBridge triggered function as it handles\n"], [1272, "            A2I status updates\n"], [1273, "    Properties:\n"], [1274, "      PermissionsBoundary:\n"], [1275, "        Fn::If:\n"], [1276, "        - HasPermissionsBoundary\n"], [1277, "        - Ref: PermissionsBoundaryArn\n"], [1278, "        - Ref: AWS::NoValue\n"], [1279, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/2a1a88839f42882f1642d6ef99f5e1b5\n"], [1280, "      Handler: index.handler\n"], [1281, "      Runtime: python3.12\n"], [1282, "      Timeout: 300\n"], [1283, "      MemorySize: 512\n"], [1284, "      Environment:\n"], [1285, "        Variables:\n"], [1286, "          LOG_LEVEL:\n"], [1287, "            Ref: LogLevel\n"], [1288, "          WORKING_BUCKET:\n"], [1289, "            Ref: WorkingBucket\n"], [1290, "      LoggingConfig:\n"], [1291, "        LogGroup:\n"], [1292, "          Ref: HITLStatusUpdateFunctionLogGroup\n"], [1293, "      Policies:\n"], [1294, "      - AWSLambdaBasicExecutionRole\n"], [1295, "      - S3CrudPolicy:\n"], [1296, "          BucketName:\n"], [1297, "            Ref: WorkingBucket\n"], [1298, "      - Statement:\n"], [1299, "        - Effect: Allow\n"], [1300, "          Action:\n"], [1301, "          - kms:Encrypt\n"], [1302, "          - kms:Decrypt\n"], [1303, "          - kms:ReEncrypt*\n"], [1304, "          - kms:GenerateDataKey*\n"], [1305, "          - kms:DescribeKey\n"], [1306, "          Resource:\n"], [1307, "            Ref: CustomerManagedEncryptionKeyArn\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1256, 1307], "resource": "AWS::Serverless::Function.HITLStatusUpdateFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[1256, "  HITLStatusUpdateFunction:\n"], [1257, "    Type: AWS::Serverless::Function\n"], [1258, "    Metadata:\n"], [1259, "      SamResourceId: HITLStatusUpdateFunction\n"], [1260, "      cfn_nag:\n"], [1261, "        rules_to_suppress:\n"], [1262, "        - id: W11\n"], [1263, "          reason: Cloudwatch does not support resource-level permissions\n"], [1264, "        - id: W89\n"], [1265, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1266, "            with AWS services via AWS APIs\n"], [1267, "        - id: W92\n"], [1268, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1269, "            to scale based on demand\n"], [1270, "        - id: W58\n"], [1271, "          reason: DLQ not required for EventBridge triggered function as it handles\n"], [1272, "            A2I status updates\n"], [1273, "    Properties:\n"], [1274, "      PermissionsBoundary:\n"], [1275, "        Fn::If:\n"], [1276, "        - HasPermissionsBoundary\n"], [1277, "        - Ref: PermissionsBoundaryArn\n"], [1278, "        - Ref: AWS::NoValue\n"], [1279, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/2a1a88839f42882f1642d6ef99f5e1b5\n"], [1280, "      Handler: index.handler\n"], [1281, "      Runtime: python3.12\n"], [1282, "      Timeout: 300\n"], [1283, "      MemorySize: 512\n"], [1284, "      Environment:\n"], [1285, "        Variables:\n"], [1286, "          LOG_LEVEL:\n"], [1287, "            Ref: LogLevel\n"], [1288, "          WORKING_BUCKET:\n"], [1289, "            Ref: WorkingBucket\n"], [1290, "      LoggingConfig:\n"], [1291, "        LogGroup:\n"], [1292, "          Ref: HITLStatusUpdateFunctionLogGroup\n"], [1293, "      Policies:\n"], [1294, "      - AWSLambdaBasicExecutionRole\n"], [1295, "      - S3CrudPolicy:\n"], [1296, "          BucketName:\n"], [1297, "            Ref: WorkingBucket\n"], [1298, "      - Statement:\n"], [1299, "        - Effect: Allow\n"], [1300, "          Action:\n"], [1301, "          - kms:Encrypt\n"], [1302, "          - kms:Decrypt\n"], [1303, "          - kms:ReEncrypt*\n"], [1304, "          - kms:GenerateDataKey*\n"], [1305, "          - kms:DescribeKey\n"], [1306, "          Resource:\n"], [1307, "            Ref: CustomerManagedEncryptionKeyArn\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1256, 1307], "resource": "AWS::Serverless::Function.HITLStatusUpdateFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "FAILED", "evaluated_keys": ["Properties/VpcConfig"]}, "code_block": [[1256, "  HITLStatusUpdateFunction:\n"], [1257, "    Type: AWS::Serverless::Function\n"], [1258, "    Metadata:\n"], [1259, "      SamResourceId: HITLStatusUpdateFunction\n"], [1260, "      cfn_nag:\n"], [1261, "        rules_to_suppress:\n"], [1262, "        - id: W11\n"], [1263, "          reason: Cloudwatch does not support resource-level permissions\n"], [1264, "        - id: W89\n"], [1265, "          reason: This Lambda function does not require VPC access as it only interacts\n"], [1266, "            with AWS services via AWS APIs\n"], [1267, "        - id: W92\n"], [1268, "          reason: Function does not require concurrent execution limits as it is designed\n"], [1269, "            to scale based on demand\n"], [1270, "        - id: W58\n"], [1271, "          reason: DLQ not required for EventBridge triggered function as it handles\n"], [1272, "            A2I status updates\n"], [1273, "    Properties:\n"], [1274, "      PermissionsBoundary:\n"], [1275, "        Fn::If:\n"], [1276, "        - HasPermissionsBoundary\n"], [1277, "        - Ref: PermissionsBoundaryArn\n"], [1278, "        - Ref: AWS::NoValue\n"], [1279, "      CodeUri: s3://bobs-artifacts-us-west-2/idp-dev-private/0.3.12-wip/2a1a88839f42882f1642d6ef99f5e1b5\n"], [1280, "      Handler: index.handler\n"], [1281, "      Runtime: python3.12\n"], [1282, "      Timeout: 300\n"], [1283, "      MemorySize: 512\n"], [1284, "      Environment:\n"], [1285, "        Variables:\n"], [1286, "          LOG_LEVEL:\n"], [1287, "            Ref: LogLevel\n"], [1288, "          WORKING_BUCKET:\n"], [1289, "            Ref: WorkingBucket\n"], [1290, "      LoggingConfig:\n"], [1291, "        LogGroup:\n"], [1292, "          Ref: HITLStatusUpdateFunctionLogGroup\n"], [1293, "      Policies:\n"], [1294, "      - AWSLambdaBasicExecutionRole\n"], [1295, "      - S3CrudPolicy:\n"], [1296, "          BucketName:\n"], [1297, "            Ref: WorkingBucket\n"], [1298, "      - Statement:\n"], [1299, "        - Effect: Allow\n"], [1300, "          Action:\n"], [1301, "          - kms:Encrypt\n"], [1302, "          - kms:Decrypt\n"], [1303, "          - kms:ReEncrypt*\n"], [1304, "          - kms:GenerateDataKey*\n"], [1305, "          - kms:DescribeKey\n"], [1306, "          Resource:\n"], [1307, "            Ref: CustomerManagedEncryptionKeyArn\n"]], "file_path": "/packaged.yaml", "file_abs_path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "repo_file_path": "/packaged.yaml", "file_line_range": [1256, 1307], "resource": "AWS::Serverless::Function.HITLStatusUpdateFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null, "breadcrumbs": {"Environment.Variables.LOG_LEVEL": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}], "Environment.Variables": [{"type": "parameters", "name": "LogLevel", "path": "/home/ec2-user/projects/genaiic-idp-accelerator-2/patterns/pattern-1/.aws-sam/packaged.yaml", "attribute_key": "Default"}]}}]}, "summary": {"passed": 45, "failed": 27, "skipped": 0, "parsing_errors": 0, "resource_count": 26, "checkov_version": "3.2.461"}}